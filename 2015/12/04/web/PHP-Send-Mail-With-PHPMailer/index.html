<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>ThinkPHP下使用PHPMailer发送邮件 | 麦子的博客</title><meta name="description" content="ThinkPHP下使用PHPMailer发送邮件"><meta name="keywords" content="mail"><meta name="author" content="pengweifu"><meta name="copyright" content="pengweifu"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="ThinkPHP下使用PHPMailer发送邮件"><meta name="twitter:description" content="ThinkPHP下使用PHPMailer发送邮件"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><meta property="og:type" content="article"><meta property="og:title" content="ThinkPHP下使用PHPMailer发送邮件"><meta property="og:url" content="https://www.pengwf.com/2015/12/04/web/PHP-Send-Mail-With-PHPMailer/"><meta property="og:site_name" content="麦子的博客"><meta property="og:description" content="ThinkPHP下使用PHPMailer发送邮件"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.15/dist/snackbar.min.css"><link rel="canonical" href="https://www.pengwf.com/2015/12/04/web/PHP-Send-Mail-With-PHPMailer/"><link rel="prev" title="ASP使用Jmail组件发送邮件" href="/https:/www.pengwf.com/2015/12/04/web/ASP-Send-Mail-With-Jmail/"><link rel="next" title="Windows下PHPunit安装及入门演示" href="/https:/www.pengwf.com/2015/10/14/web/PHP-PHPUNIT-Demo/"><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?c52098f04c07f714298c1f4c0fabd5bc";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://www.pengwf.com/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  highlight_lang: 'true',
  highlight_shrink: 'false',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  copyright: undefined,
  copy_copyright_js: false,
  ClickShowText: undefined,
  medium_zoom: 'false',
  Snackbar: {"bookmark":{"title":"Snackbar.bookmark.title","message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"}
  
}</script></head><body><div id="header"> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">麦子的博客</a></span><i class="fa fa-bars fa-fw toggle-menu pull_right close" aria-hidden="true"></i><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li><li><a class="site-page" href="/Demos/bs/"><i class="fa-fw fa fa-chevron-right"></i><span> BootStrap</span></a></li><li><a class="site-page" href="/Demos/artdialog/"><i class="fa-fw fa fa-chevron-right"></i><span> Artdialog</span></a></li><li><a class="site-page" href="/Demos/haoanju/"><i class="fa-fw fa fa-chevron-right"></i><span> haoanju</span></a></li><li><a class="site-page" href="/Demos/threejs/"><i class="fa-fw fa fa-chevron-right"></i><span> threejs</span></a></li><li><a class="site-page" href="/Demos/canvas/"><i class="fa-fw fa fa-chevron-right"></i><span> canvas</span></a></li><li><a class="site-page" href="/Demos/cube/"><i class="fa-fw fa fa-chevron-right"></i><span> cube</span></a></li><li><a class="site-page" href="/Demos/vuejs/"><i class="fa-fw fa fa-chevron-right"></i><span> vuejs</span></a></li><li><a class="site-page" href="/Demos/rose.html"><i class="fa-fw fa fa-chevron-right"></i><span> rose</span></a></li><li><a class="site-page" href="/Demos/map/Amap.html"><i class="fa-fw fa fa-chevron-right"></i><span> Amap</span></a></li><li><a class="site-page" href="/Demos/map/BaidumapcustomresultpanelV1.4.html"><i class="fa-fw fa fa-chevron-right"></i><span> Baidumap V1.4</span></a></li><li><a class="site-page" href="/Demos/map/BaidumapcustomresultpanelV2.html"><i class="fa-fw fa fa-chevron-right"></i><span> Baidumap V2</span></a></li></ul></div></div></span><span class="pull_right" id="search_button"></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lazyload avatar_img" src="/images/face.jpg" onerror="onerror=null;src='/images/douban-loading.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">45</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">23</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">7</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li><li><a class="site-page" href="/Demos/bs/"><i class="fa-fw fa fa-chevron-right"></i><span> BootStrap</span></a></li><li><a class="site-page" href="/Demos/artdialog/"><i class="fa-fw fa fa-chevron-right"></i><span> Artdialog</span></a></li><li><a class="site-page" href="/Demos/haoanju/"><i class="fa-fw fa fa-chevron-right"></i><span> haoanju</span></a></li><li><a class="site-page" href="/Demos/threejs/"><i class="fa-fw fa fa-chevron-right"></i><span> threejs</span></a></li><li><a class="site-page" href="/Demos/canvas/"><i class="fa-fw fa fa-chevron-right"></i><span> canvas</span></a></li><li><a class="site-page" href="/Demos/cube/"><i class="fa-fw fa fa-chevron-right"></i><span> cube</span></a></li><li><a class="site-page" href="/Demos/vuejs/"><i class="fa-fw fa fa-chevron-right"></i><span> vuejs</span></a></li><li><a class="site-page" href="/Demos/rose.html"><i class="fa-fw fa fa-chevron-right"></i><span> rose</span></a></li><li><a class="site-page" href="/Demos/map/Amap.html"><i class="fa-fw fa fa-chevron-right"></i><span> Amap</span></a></li><li><a class="site-page" href="/Demos/map/BaidumapcustomresultpanelV1.4.html"><i class="fa-fw fa fa-chevron-right"></i><span> Baidumap V1.4</span></a></li><li><a class="site-page" href="/Demos/map/BaidumapcustomresultpanelV2.html"><i class="fa-fw fa fa-chevron-right"></i><span> Baidumap V2</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#测试文件内容"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">测试文件内容</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#PHPMailer文件PHPMailer-class-php"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">PHPMailer文件PHPMailer.class.php</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#SMTP文件Smtp-class-php"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">SMTP文件Smtp.class.php</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#异常类Exception-class-php"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">异常类Exception.class.php</span></a></li></ol></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#测试文件内容"><span class="toc-number">1.</span> <span class="toc-text">测试文件内容</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PHPMailer文件PHPMailer-class-php"><span class="toc-number">2.</span> <span class="toc-text">PHPMailer文件PHPMailer.class.php</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SMTP文件Smtp-class-php"><span class="toc-number">3.</span> <span class="toc-text">SMTP文件Smtp.class.php</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#异常类Exception-class-php"><span class="toc-number">4.</span> <span class="toc-text">异常类Exception.class.php</span></a></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png)"><div id="post-info"><div id="post-title"><div class="posttitle">ThinkPHP下使用PHPMailer发送邮件</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2015-12-04<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2019-11-29</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/PHP/">PHP</a></span><div class="post-meta-wordcount"><i class="fa fa-eye post-meta__icon" aria-hidden="true">       </i><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="测试文件内容"><a href="#测试文件内容" class="headerlink" title="测试文件内容"></a>测试文件内容</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">error_reporting(E_ALL);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">ini_set(&#39;display_errors&#39;,&#39;On&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">function sendMail($to, $title, $content) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">    include(&#39;ThinkPHP&#x2F;Library&#x2F;Think&#x2F;Exception.class.php&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">    include(&#39;ThinkPHP&#x2F;Library&#x2F;Org&#x2F;Util&#x2F;PHPMailer.class.php&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">    $mail &#x3D; new \Org\Util\PHPMailer(); &#x2F;&#x2F;实例化</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">    $mail-&gt;IsSMTP(); &#x2F;&#x2F; 启用SMTP</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">    $mail-&gt;Host&#x3D;&#39;smtp.qq.com&#39;; &#x2F;&#x2F;smtp服务器的名称（这里以QQ邮箱为例）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">    $mail-&gt;SMTPAuth &#x3D; true; &#x2F;&#x2F;启用smtp认证</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">    $mail-&gt;Username &#x3D; &#39;710627107@qq.com&#39;; &#x2F;&#x2F;你的邮箱名</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">    $mail-&gt;Password &#x3D; &#39;12345&#39;; &#x2F;&#x2F;邮箱密码</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">    $mail-&gt;From &#x3D; &#39;710627107@qq.com&#39;; &#x2F;&#x2F;发件人地址（也就是你的邮箱地址）</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">    $mail-&gt;FromName &#x3D; &#39;哒哒哒&#39;; &#x2F;&#x2F;发件人姓名</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">    $mail-&gt;AddAddress($to,&quot;尊敬的客户&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">    $mail-&gt;WordWrap &#x3D; 50; &#x2F;&#x2F;设置每行字符长度</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">    $mail-&gt;IsHTML(true); &#x2F;&#x2F; 是否HTML格式邮件</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">    $mail-&gt;CharSet&#x3D;&#39;utf-8&#39;; &#x2F;&#x2F;设置邮件编码</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">    $mail-&gt;Subject &#x3D;$title; &#x2F;&#x2F;邮件主题</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">    $mail-&gt;Body &#x3D; $content; &#x2F;&#x2F;邮件内容</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">    $mail-&gt;AltBody &#x3D; &quot;这是一个纯文本的身体在非营利的HTML电子邮件客户端&quot;; &#x2F;&#x2F;邮件正文不支持HTML的备用显示</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">    if ($mail-&gt;Send()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">        return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">    &#125;else&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">        return &#39;error:&#39;.$mail-&gt;ErrorInfo;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">$r&#x3D;sendMail(&#39;weifupeng75@163.com&#39;,&#39;主题&#39;,&#39;内容&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line">if($r!&#x3D;&#x3D;true) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line">    echo $r;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line">    echo phpinfo();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line">&#125;else&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">    echo true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h1 id="PHPMailer文件PHPMailer-class-php"><a href="#PHPMailer文件PHPMailer-class-php" class="headerlink" title="PHPMailer文件PHPMailer.class.php"></a>PHPMailer文件PHPMailer.class.php</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&#x2F;*~ class.phpmailer.php</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">.---------------------------------------------------------------------------.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">|  Software: PHPMailer - PHP email class                                    |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">|   Version: 5.2.1                                                          |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">|      Site: https:&#x2F;&#x2F;code.google.com&#x2F;a&#x2F;apache-extras.org&#x2F;p&#x2F;phpmailer&#x2F;       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">| ------------------------------------------------------------------------- |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">|     Admin: Jim Jagielski (project admininistrator)                        |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">|   Authors: Andy Prevost (codeworxtech) codeworxtech@users.sourceforge.net |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">|          : Marcus Bointon (coolbru) coolbru@users.sourceforge.net         |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">|          : Jim Jagielski (jimjag) jimjag@gmail.com                        |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">|   Founder: Brent R. Matzelle (original founder)                           |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">| Copyright (c) 2010-2012, Jim Jagielski. All Rights Reserved.              |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">| Copyright (c) 2004-2009, Andy Prevost. All Rights Reserved.               |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">| Copyright (c) 2001-2003, Brent R. Matzelle                                |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">| ------------------------------------------------------------------------- |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">|   License: Distributed under the Lesser General Public License (LGPL)     |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">|            http:&#x2F;&#x2F;www.gnu.org&#x2F;copyleft&#x2F;lesser.html                        |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">| This program is distributed in the hope that it will be useful - WITHOUT  |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">| ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or     |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">| FITNESS FOR A PARTICULAR PURPOSE.                                         |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">&#39;---------------------------------------------------------------------------&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">*&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">namespace Org\Util;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">use Think\Exception;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">&#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"> * PHPMailer - PHP email transport class</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line"> * NOTE: Requires PHP version 5 or later</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line"> * @package PHPMailer</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line"> * @author Andy Prevost</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line"> * @author Marcus Bointon</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line"> * @author Jim Jagielski</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line"> * @copyright 2010 - 2012 Jim Jagielski</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line"> * @copyright 2004 - 2009 Andy Prevost</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line"> * @version $Id: class.phpmailer.php 450 2010-06-23 16:46:33Z coolbru $</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line"> * @license http:&#x2F;&#x2F;www.gnu.org&#x2F;copyleft&#x2F;lesser.html GNU Lesser General Public License</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line"> *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line">if (version_compare(PHP_VERSION, &#39;5.0.0&#39;, &#39;&lt;&#39;) ) exit(&quot;Sorry, this version of PHPMailer will only run on PHP version 5 or greater!\n&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line">class PHPMailer &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F; PROPERTIES, PUBLIC</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line">   * Email priority (1 &#x3D; High, 3 &#x3D; Normal, 5 &#x3D; low).</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line">   * @var int</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line">  public $Priority          &#x3D; 3;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line">   * Sets the CharSet of the message.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line">  public $CharSet           &#x3D; &#39;iso-8859-1&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line">   * Sets the Content-type of the message.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line">  public $ContentType       &#x3D; &#39;text&#x2F;plain&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line">   * Sets the Encoding of the message. Options for this are</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line">   *  &quot;8bit&quot;, &quot;7bit&quot;, &quot;binary&quot;, &quot;base64&quot;, and &quot;quoted-printable&quot;.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line">  public $Encoding          &#x3D; &#39;8bit&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line">   * Holds the most recent mailer error message.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">74</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">75</span></pre></td><td class="code"><pre><span class="line">  public $ErrorInfo         &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">76</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">77</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">78</span></pre></td><td class="code"><pre><span class="line">   * Sets the From email address for the message.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">79</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">80</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">81</span></pre></td><td class="code"><pre><span class="line">  public $From              &#x3D; &#39;root@localhost&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">82</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">83</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">84</span></pre></td><td class="code"><pre><span class="line">   * Sets the From name of the message.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">85</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">86</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">87</span></pre></td><td class="code"><pre><span class="line">  public $FromName          &#x3D; &#39;Root User&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">88</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">89</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">90</span></pre></td><td class="code"><pre><span class="line">   * Sets the Sender email (Return-Path) of the message.  If not empty,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">91</span></pre></td><td class="code"><pre><span class="line">   * will be sent via -f to sendmail or as &#39;MAIL FROM&#39; in smtp mode.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">92</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">93</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">94</span></pre></td><td class="code"><pre><span class="line">  public $Sender            &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">95</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">96</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">97</span></pre></td><td class="code"><pre><span class="line">   * Sets the Subject of the message.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">98</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">99</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">100</span></pre></td><td class="code"><pre><span class="line">  public $Subject           &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">101</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">102</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">103</span></pre></td><td class="code"><pre><span class="line">   * Sets the Body of the message.  This can be either an HTML or text body.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">104</span></pre></td><td class="code"><pre><span class="line">   * If HTML then run IsHTML(true).</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">105</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">106</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">107</span></pre></td><td class="code"><pre><span class="line">  public $Body              &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">108</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">109</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">110</span></pre></td><td class="code"><pre><span class="line">   * Sets the text-only body of the message.  This automatically sets the</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">111</span></pre></td><td class="code"><pre><span class="line">   * email to multipart&#x2F;alternative.  This body can be read by mail</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">112</span></pre></td><td class="code"><pre><span class="line">   * clients that do not have HTML email capability such as mutt. Clients</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">113</span></pre></td><td class="code"><pre><span class="line">   * that can read HTML will view the normal Body.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">114</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">115</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">116</span></pre></td><td class="code"><pre><span class="line">  public $AltBody           &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">117</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">118</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">119</span></pre></td><td class="code"><pre><span class="line">   * Stores the complete compiled MIME message body.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">120</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">121</span></pre></td><td class="code"><pre><span class="line">   * @access protected</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">122</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">123</span></pre></td><td class="code"><pre><span class="line">  protected $MIMEBody       &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">124</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">125</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">126</span></pre></td><td class="code"><pre><span class="line">   * Stores the complete compiled MIME message headers.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">127</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">128</span></pre></td><td class="code"><pre><span class="line">   * @access protected</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">129</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">130</span></pre></td><td class="code"><pre><span class="line">  protected $MIMEHeader     &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">131</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">132</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">133</span></pre></td><td class="code"><pre><span class="line">   * Stores the complete sent MIME message (Body and Headers)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">134</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">135</span></pre></td><td class="code"><pre><span class="line">   * @access protected</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">136</span></pre></td><td class="code"><pre><span class="line">  *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">137</span></pre></td><td class="code"><pre><span class="line">  protected $SentMIMEMessage     &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">138</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">139</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">140</span></pre></td><td class="code"><pre><span class="line">   * Sets word wrapping on the body of the message to a given number of</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">141</span></pre></td><td class="code"><pre><span class="line">   * characters.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">142</span></pre></td><td class="code"><pre><span class="line">   * @var int</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">143</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">144</span></pre></td><td class="code"><pre><span class="line">  public $WordWrap          &#x3D; 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">145</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">146</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">147</span></pre></td><td class="code"><pre><span class="line">   * Method to send mail: (&quot;mail&quot;, &quot;sendmail&quot;, or &quot;smtp&quot;).</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">148</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">149</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">150</span></pre></td><td class="code"><pre><span class="line">  public $Mailer            &#x3D; &#39;mail&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">151</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">152</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">153</span></pre></td><td class="code"><pre><span class="line">   * Sets the path of the sendmail program.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">154</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">155</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">156</span></pre></td><td class="code"><pre><span class="line">  public $Sendmail          &#x3D; &#39;&#x2F;usr&#x2F;sbin&#x2F;sendmail&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">157</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">158</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">159</span></pre></td><td class="code"><pre><span class="line">   * Path to PHPMailer plugins.  Useful if the SMTP class</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">160</span></pre></td><td class="code"><pre><span class="line">   * is in a different directory than the PHP include path.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">161</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">162</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">163</span></pre></td><td class="code"><pre><span class="line">  public $PluginDir         &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">164</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">165</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">166</span></pre></td><td class="code"><pre><span class="line">   * Sets the email address that a reading confirmation will be sent.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">167</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">168</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">169</span></pre></td><td class="code"><pre><span class="line">  public $ConfirmReadingTo  &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">170</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">171</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">172</span></pre></td><td class="code"><pre><span class="line">   * Sets the hostname to use in Message-Id and Received headers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">173</span></pre></td><td class="code"><pre><span class="line">   * and as default HELO string. If empty, the value returned</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">174</span></pre></td><td class="code"><pre><span class="line">   * by SERVER_NAME is used or &#39;localhost.localdomain&#39;.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">175</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">176</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">177</span></pre></td><td class="code"><pre><span class="line">  public $Hostname          &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">178</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">179</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">180</span></pre></td><td class="code"><pre><span class="line">   * Sets the message ID to be used in the Message-Id header.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">181</span></pre></td><td class="code"><pre><span class="line">   * If empty, a unique id will be generated.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">182</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">183</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">184</span></pre></td><td class="code"><pre><span class="line">  public $MessageID         &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">185</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">186</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">187</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F; PROPERTIES FOR SMTP</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">188</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">189</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">190</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">191</span></pre></td><td class="code"><pre><span class="line">   * Sets the SMTP hosts.  All hosts must be separated by a</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">192</span></pre></td><td class="code"><pre><span class="line">   * semicolon.  You can also specify a different port</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">193</span></pre></td><td class="code"><pre><span class="line">   * for each host by using this format: [hostname:port]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">194</span></pre></td><td class="code"><pre><span class="line">   * (e.g. &quot;smtp1.example.com:25;smtp2.example.com&quot;).</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">195</span></pre></td><td class="code"><pre><span class="line">   * Hosts will be tried in order.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">196</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">197</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">198</span></pre></td><td class="code"><pre><span class="line">  public $Host          &#x3D; &#39;localhost&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">199</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">200</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">201</span></pre></td><td class="code"><pre><span class="line">   * Sets the default SMTP server port.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">202</span></pre></td><td class="code"><pre><span class="line">   * @var int</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">203</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">204</span></pre></td><td class="code"><pre><span class="line">  public $Port          &#x3D; 25;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">205</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">206</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">207</span></pre></td><td class="code"><pre><span class="line">   * Sets the SMTP HELO of the message (Default is $Hostname).</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">208</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">209</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">210</span></pre></td><td class="code"><pre><span class="line">  public $Helo          &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">211</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">212</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">213</span></pre></td><td class="code"><pre><span class="line">   * Sets connection prefix.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">214</span></pre></td><td class="code"><pre><span class="line">   * Options are &quot;&quot;, &quot;ssl&quot; or &quot;tls&quot;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">215</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">216</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">217</span></pre></td><td class="code"><pre><span class="line">  public $SMTPSecure    &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">218</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">219</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">220</span></pre></td><td class="code"><pre><span class="line">   * Sets SMTP authentication. Utilizes the Username and Password variables.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">221</span></pre></td><td class="code"><pre><span class="line">   * @var bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">222</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">223</span></pre></td><td class="code"><pre><span class="line">  public $SMTPAuth      &#x3D; false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">224</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">225</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">226</span></pre></td><td class="code"><pre><span class="line">   * Sets SMTP username.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">227</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">228</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">229</span></pre></td><td class="code"><pre><span class="line">  public $Username      &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">230</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">231</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">232</span></pre></td><td class="code"><pre><span class="line">   * Sets SMTP password.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">233</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">234</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">235</span></pre></td><td class="code"><pre><span class="line">  public $Password      &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">236</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">237</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">238</span></pre></td><td class="code"><pre><span class="line">   * Sets the SMTP server timeout in seconds.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">239</span></pre></td><td class="code"><pre><span class="line">   * This function will not work with the win32 version.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">240</span></pre></td><td class="code"><pre><span class="line">   * @var int</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">241</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">242</span></pre></td><td class="code"><pre><span class="line">  public $Timeout       &#x3D; 10;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">243</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">244</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">245</span></pre></td><td class="code"><pre><span class="line">   * Sets SMTP class debugging on or off.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">246</span></pre></td><td class="code"><pre><span class="line">   * @var bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">247</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">248</span></pre></td><td class="code"><pre><span class="line">  public $SMTPDebug     &#x3D; false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">249</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">250</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">251</span></pre></td><td class="code"><pre><span class="line">   * Prevents the SMTP connection from being closed after each mail</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">252</span></pre></td><td class="code"><pre><span class="line">   * sending.  If this is set to true then to close the connection</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">253</span></pre></td><td class="code"><pre><span class="line">   * requires an explicit call to SmtpClose().</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">254</span></pre></td><td class="code"><pre><span class="line">   * @var bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">255</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">256</span></pre></td><td class="code"><pre><span class="line">  public $SMTPKeepAlive &#x3D; false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">257</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">258</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">259</span></pre></td><td class="code"><pre><span class="line">   * Provides the ability to have the TO field process individual</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">260</span></pre></td><td class="code"><pre><span class="line">   * emails, instead of sending to entire TO addresses</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">261</span></pre></td><td class="code"><pre><span class="line">   * @var bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">262</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">263</span></pre></td><td class="code"><pre><span class="line">  public $SingleTo      &#x3D; false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">264</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">265</span></pre></td><td class="code"><pre><span class="line">   &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">266</span></pre></td><td class="code"><pre><span class="line">   * If SingleTo is true, this provides the array to hold the email addresses</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">267</span></pre></td><td class="code"><pre><span class="line">   * @var bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">268</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">269</span></pre></td><td class="code"><pre><span class="line">  public $SingleToArray &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">270</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">271</span></pre></td><td class="code"><pre><span class="line"> &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">272</span></pre></td><td class="code"><pre><span class="line">   * Provides the ability to change the line ending</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">273</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">274</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">275</span></pre></td><td class="code"><pre><span class="line">  public $LE              &#x3D; &quot;\n&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">276</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">277</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">278</span></pre></td><td class="code"><pre><span class="line">   * Used with DKIM DNS Resource Record</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">279</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">280</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">281</span></pre></td><td class="code"><pre><span class="line">  public $DKIM_selector   &#x3D; &#39;phpmailer&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">282</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">283</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">284</span></pre></td><td class="code"><pre><span class="line">   * Used with DKIM DNS Resource Record</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">285</span></pre></td><td class="code"><pre><span class="line">   * optional, in format of email address &#39;you@yourdomain.com&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">286</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">287</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">288</span></pre></td><td class="code"><pre><span class="line">  public $DKIM_identity   &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">289</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">290</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">291</span></pre></td><td class="code"><pre><span class="line">   * Used with DKIM DNS Resource Record</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">292</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">293</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">294</span></pre></td><td class="code"><pre><span class="line">  public $DKIM_passphrase   &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">295</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">296</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">297</span></pre></td><td class="code"><pre><span class="line">   * Used with DKIM DNS Resource Record</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">298</span></pre></td><td class="code"><pre><span class="line">   * optional, in format of email address &#39;you@yourdomain.com&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">299</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">300</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">301</span></pre></td><td class="code"><pre><span class="line">  public $DKIM_domain     &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">302</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">303</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">304</span></pre></td><td class="code"><pre><span class="line">   * Used with DKIM DNS Resource Record</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">305</span></pre></td><td class="code"><pre><span class="line">   * optional, in format of email address &#39;you@yourdomain.com&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">306</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">307</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">308</span></pre></td><td class="code"><pre><span class="line">  public $DKIM_private    &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">309</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">310</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">311</span></pre></td><td class="code"><pre><span class="line">   * Callback Action function name</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">312</span></pre></td><td class="code"><pre><span class="line">   * the function that handles the result of the send email action. Parameters:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">313</span></pre></td><td class="code"><pre><span class="line">   *   bool    $result        result of the send action</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">314</span></pre></td><td class="code"><pre><span class="line">   *   string  $to            email address of the recipient</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">315</span></pre></td><td class="code"><pre><span class="line">   *   string  $cc            cc email addresses</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">316</span></pre></td><td class="code"><pre><span class="line">   *   string  $bcc           bcc email addresses</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">317</span></pre></td><td class="code"><pre><span class="line">   *   string  $subject       the subject</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">318</span></pre></td><td class="code"><pre><span class="line">   *   string  $body          the email body</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">319</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">320</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">321</span></pre></td><td class="code"><pre><span class="line">  public $action_function &#x3D; &#39;&#39;; &#x2F;&#x2F;&#39;callbackAction&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">322</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">323</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">324</span></pre></td><td class="code"><pre><span class="line">   * Sets the PHPMailer Version number</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">325</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">326</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">327</span></pre></td><td class="code"><pre><span class="line">  public $Version         &#x3D; &#39;5.2.1&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">328</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">329</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">330</span></pre></td><td class="code"><pre><span class="line">   * What to use in the X-Mailer header</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">331</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">332</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">333</span></pre></td><td class="code"><pre><span class="line">  public $XMailer         &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">334</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">335</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">336</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F; PROPERTIES, PRIVATE AND PROTECTED</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">337</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">338</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">339</span></pre></td><td class="code"><pre><span class="line">  protected   $smtp           &#x3D; NULL;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">340</span></pre></td><td class="code"><pre><span class="line">  protected   $to             &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">341</span></pre></td><td class="code"><pre><span class="line">  protected   $cc             &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">342</span></pre></td><td class="code"><pre><span class="line">  protected   $bcc            &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">343</span></pre></td><td class="code"><pre><span class="line">  protected   $ReplyTo        &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">344</span></pre></td><td class="code"><pre><span class="line">  protected   $all_recipients &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">345</span></pre></td><td class="code"><pre><span class="line">  protected   $attachment     &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">346</span></pre></td><td class="code"><pre><span class="line">  protected   $CustomHeader   &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">347</span></pre></td><td class="code"><pre><span class="line">  protected   $message_type   &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">348</span></pre></td><td class="code"><pre><span class="line">  protected   $boundary       &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">349</span></pre></td><td class="code"><pre><span class="line">  protected   $language       &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">350</span></pre></td><td class="code"><pre><span class="line">  protected   $error_count    &#x3D; 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">351</span></pre></td><td class="code"><pre><span class="line">  protected   $sign_cert_file &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">352</span></pre></td><td class="code"><pre><span class="line">  protected   $sign_key_file  &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">353</span></pre></td><td class="code"><pre><span class="line">  protected   $sign_key_pass  &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">354</span></pre></td><td class="code"><pre><span class="line">  protected   $exceptions     &#x3D; false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">355</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">356</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">357</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F; CONSTANTS</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">358</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">359</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">360</span></pre></td><td class="code"><pre><span class="line">  const STOP_MESSAGE  &#x3D; 0; &#x2F;&#x2F; message only, continue processing</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">361</span></pre></td><td class="code"><pre><span class="line">  const STOP_CONTINUE &#x3D; 1; &#x2F;&#x2F; message?, likely ok to continue processing</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">362</span></pre></td><td class="code"><pre><span class="line">  const STOP_CRITICAL &#x3D; 2; &#x2F;&#x2F; message, plus full stop, critical error reached</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">363</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">364</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">365</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F; METHODS, VARIABLES</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">366</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">367</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">368</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">369</span></pre></td><td class="code"><pre><span class="line">   * Constructor</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">370</span></pre></td><td class="code"><pre><span class="line">   * @param boolean $exceptions Should we throw external exceptions?</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">371</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">372</span></pre></td><td class="code"><pre><span class="line">  public function __construct($exceptions &#x3D; false) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">373</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;exceptions &#x3D; ($exceptions &#x3D;&#x3D; true);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">374</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">375</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">376</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">377</span></pre></td><td class="code"><pre><span class="line">   * Sets message type to HTML.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">378</span></pre></td><td class="code"><pre><span class="line">   * @param bool $ishtml</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">379</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">380</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">381</span></pre></td><td class="code"><pre><span class="line">  public function IsHTML($ishtml &#x3D; true) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">382</span></pre></td><td class="code"><pre><span class="line">    if ($ishtml) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">383</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;ContentType &#x3D; &#39;text&#x2F;html&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">384</span></pre></td><td class="code"><pre><span class="line">    &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">385</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;ContentType &#x3D; &#39;text&#x2F;plain&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">386</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">387</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">388</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">389</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">390</span></pre></td><td class="code"><pre><span class="line">   * Sets Mailer to send message using SMTP.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">391</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">392</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">393</span></pre></td><td class="code"><pre><span class="line">  public function IsSMTP() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">394</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;Mailer &#x3D; &#39;smtp&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">395</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">396</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">397</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">398</span></pre></td><td class="code"><pre><span class="line">   * Sets Mailer to send message using PHP mail() function.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">399</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">400</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">401</span></pre></td><td class="code"><pre><span class="line">  public function IsMail() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">402</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;Mailer &#x3D; &#39;mail&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">403</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">404</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">405</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">406</span></pre></td><td class="code"><pre><span class="line">   * Sets Mailer to send message using the $Sendmail program.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">407</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">408</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">409</span></pre></td><td class="code"><pre><span class="line">  public function IsSendmail() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">410</span></pre></td><td class="code"><pre><span class="line">    if (!stristr(ini_get(&#39;sendmail_path&#39;), &#39;sendmail&#39;)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">411</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;Sendmail &#x3D; &#39;&#x2F;var&#x2F;qmail&#x2F;bin&#x2F;sendmail&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">412</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">413</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;Mailer &#x3D; &#39;sendmail&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">414</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">415</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">416</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">417</span></pre></td><td class="code"><pre><span class="line">   * Sets Mailer to send message using the qmail MTA.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">418</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">419</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">420</span></pre></td><td class="code"><pre><span class="line">  public function IsQmail() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">421</span></pre></td><td class="code"><pre><span class="line">    if (stristr(ini_get(&#39;sendmail_path&#39;), &#39;qmail&#39;)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">422</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;Sendmail &#x3D; &#39;&#x2F;var&#x2F;qmail&#x2F;bin&#x2F;sendmail&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">423</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">424</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;Mailer &#x3D; &#39;sendmail&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">425</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">426</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">427</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">428</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F; METHODS, RECIPIENTS</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">429</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">430</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">431</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">432</span></pre></td><td class="code"><pre><span class="line">   * Adds a &quot;To&quot; address.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">433</span></pre></td><td class="code"><pre><span class="line">   * @param string $address</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">434</span></pre></td><td class="code"><pre><span class="line">   * @param string $name</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">435</span></pre></td><td class="code"><pre><span class="line">   * @return boolean true on success, false if address already used</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">436</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">437</span></pre></td><td class="code"><pre><span class="line">  public function AddAddress($address, $name &#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">438</span></pre></td><td class="code"><pre><span class="line">    return $this-&gt;AddAnAddress(&#39;to&#39;, $address, $name);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">439</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">440</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">441</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">442</span></pre></td><td class="code"><pre><span class="line">   * Adds a &quot;Cc&quot; address.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">443</span></pre></td><td class="code"><pre><span class="line">   * Note: this function works with the SMTP mailer on win32, not with the &quot;mail&quot; mailer.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">444</span></pre></td><td class="code"><pre><span class="line">   * @param string $address</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">445</span></pre></td><td class="code"><pre><span class="line">   * @param string $name</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">446</span></pre></td><td class="code"><pre><span class="line">   * @return boolean true on success, false if address already used</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">447</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">448</span></pre></td><td class="code"><pre><span class="line">  public function AddCC($address, $name &#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">449</span></pre></td><td class="code"><pre><span class="line">    return $this-&gt;AddAnAddress(&#39;cc&#39;, $address, $name);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">450</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">451</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">452</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">453</span></pre></td><td class="code"><pre><span class="line">   * Adds a &quot;Bcc&quot; address.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">454</span></pre></td><td class="code"><pre><span class="line">   * Note: this function works with the SMTP mailer on win32, not with the &quot;mail&quot; mailer.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">455</span></pre></td><td class="code"><pre><span class="line">   * @param string $address</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">456</span></pre></td><td class="code"><pre><span class="line">   * @param string $name</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">457</span></pre></td><td class="code"><pre><span class="line">   * @return boolean true on success, false if address already used</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">458</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">459</span></pre></td><td class="code"><pre><span class="line">  public function AddBCC($address, $name &#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">460</span></pre></td><td class="code"><pre><span class="line">    return $this-&gt;AddAnAddress(&#39;bcc&#39;, $address, $name);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">461</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">462</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">463</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">464</span></pre></td><td class="code"><pre><span class="line">   * Adds a &quot;Reply-to&quot; address.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">465</span></pre></td><td class="code"><pre><span class="line">   * @param string $address</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">466</span></pre></td><td class="code"><pre><span class="line">   * @param string $name</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">467</span></pre></td><td class="code"><pre><span class="line">   * @return boolean</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">468</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">469</span></pre></td><td class="code"><pre><span class="line">  public function AddReplyTo($address, $name &#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">470</span></pre></td><td class="code"><pre><span class="line">    return $this-&gt;AddAnAddress(&#39;Reply-To&#39;, $address, $name);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">471</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">472</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">473</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">474</span></pre></td><td class="code"><pre><span class="line">   * Adds an address to one of the recipient arrays</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">475</span></pre></td><td class="code"><pre><span class="line">   * Addresses that have been added already return false, but do not throw exceptions</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">476</span></pre></td><td class="code"><pre><span class="line">   * @param string $kind One of &#39;to&#39;, &#39;cc&#39;, &#39;bcc&#39;, &#39;ReplyTo&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">477</span></pre></td><td class="code"><pre><span class="line">   * @param string $address The email address to send to</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">478</span></pre></td><td class="code"><pre><span class="line">   * @param string $name</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">479</span></pre></td><td class="code"><pre><span class="line">   * @return boolean true on success, false if address already used or invalid in some way</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">480</span></pre></td><td class="code"><pre><span class="line">   * @access protected</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">481</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">482</span></pre></td><td class="code"><pre><span class="line">  protected function AddAnAddress($kind, $address, $name &#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">483</span></pre></td><td class="code"><pre><span class="line">    if (!preg_match(&#39;&#x2F;^(to|cc|bcc|Reply-To)$&#x2F;&#39;, $kind)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">484</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;SetError($this-&gt;Lang(&#39;Invalid recipient array&#39;).&#39;: &#39;.$kind);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">485</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;exceptions) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">486</span></pre></td><td class="code"><pre><span class="line">        throw new phpmailerException(&#39;Invalid recipient array: &#39; . $kind);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">487</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">488</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;SMTPDebug) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">489</span></pre></td><td class="code"><pre><span class="line">        echo $this-&gt;Lang(&#39;Invalid recipient array&#39;).&#39;: &#39;.$kind;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">490</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">491</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">492</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">493</span></pre></td><td class="code"><pre><span class="line">    $address &#x3D; trim($address);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">494</span></pre></td><td class="code"><pre><span class="line">    $name &#x3D; trim(preg_replace(&#39;&#x2F;[\r\n]+&#x2F;&#39;, &#39;&#39;, $name)); &#x2F;&#x2F;Strip breaks and trim</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">495</span></pre></td><td class="code"><pre><span class="line">    if (!self::ValidateAddress($address)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">496</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;SetError($this-&gt;Lang(&#39;invalid_address&#39;).&#39;: &#39;. $address);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">497</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;exceptions) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">498</span></pre></td><td class="code"><pre><span class="line">        throw new phpmailerException($this-&gt;Lang(&#39;invalid_address&#39;).&#39;: &#39;.$address);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">499</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">500</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;SMTPDebug) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">501</span></pre></td><td class="code"><pre><span class="line">        echo $this-&gt;Lang(&#39;invalid_address&#39;).&#39;: &#39;.$address;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">502</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">503</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">504</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">505</span></pre></td><td class="code"><pre><span class="line">    if ($kind !&#x3D; &#39;Reply-To&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">506</span></pre></td><td class="code"><pre><span class="line">      if (!isset($this-&gt;all_recipients[strtolower($address)])) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">507</span></pre></td><td class="code"><pre><span class="line">        array_push($this-&gt;$kind, array($address, $name));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">508</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;all_recipients[strtolower($address)] &#x3D; true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">509</span></pre></td><td class="code"><pre><span class="line">        return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">510</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">511</span></pre></td><td class="code"><pre><span class="line">    &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">512</span></pre></td><td class="code"><pre><span class="line">      if (!array_key_exists(strtolower($address), $this-&gt;ReplyTo)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">513</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;ReplyTo[strtolower($address)] &#x3D; array($address, $name);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">514</span></pre></td><td class="code"><pre><span class="line">      return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">515</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">516</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">517</span></pre></td><td class="code"><pre><span class="line">  return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">518</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">519</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">520</span></pre></td><td class="code"><pre><span class="line">&#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">521</span></pre></td><td class="code"><pre><span class="line"> * Set the From and FromName properties</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">522</span></pre></td><td class="code"><pre><span class="line"> * @param string $address</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">523</span></pre></td><td class="code"><pre><span class="line"> * @param string $name</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">524</span></pre></td><td class="code"><pre><span class="line"> * @return boolean</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">525</span></pre></td><td class="code"><pre><span class="line"> *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">526</span></pre></td><td class="code"><pre><span class="line">  public function SetFrom($address, $name &#x3D; &#39;&#39;, $auto &#x3D; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">527</span></pre></td><td class="code"><pre><span class="line">    $address &#x3D; trim($address);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">528</span></pre></td><td class="code"><pre><span class="line">    $name &#x3D; trim(preg_replace(&#39;&#x2F;[\r\n]+&#x2F;&#39;, &#39;&#39;, $name)); &#x2F;&#x2F;Strip breaks and trim</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">529</span></pre></td><td class="code"><pre><span class="line">    if (!self::ValidateAddress($address)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">530</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;SetError($this-&gt;Lang(&#39;invalid_address&#39;).&#39;: &#39;. $address);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">531</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;exceptions) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">532</span></pre></td><td class="code"><pre><span class="line">        throw new phpmailerException($this-&gt;Lang(&#39;invalid_address&#39;).&#39;: &#39;.$address);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">533</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">534</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;SMTPDebug) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">535</span></pre></td><td class="code"><pre><span class="line">        echo $this-&gt;Lang(&#39;invalid_address&#39;).&#39;: &#39;.$address;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">536</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">537</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">538</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">539</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;From &#x3D; $address;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">540</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;FromName &#x3D; $name;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">541</span></pre></td><td class="code"><pre><span class="line">    if ($auto) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">542</span></pre></td><td class="code"><pre><span class="line">      if (empty($this-&gt;ReplyTo)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">543</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;AddAnAddress(&#39;Reply-To&#39;, $address, $name);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">544</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">545</span></pre></td><td class="code"><pre><span class="line">      if (empty($this-&gt;Sender)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">546</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;Sender &#x3D; $address;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">547</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">548</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">549</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">550</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">551</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">552</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">553</span></pre></td><td class="code"><pre><span class="line">   * Check that a string looks roughly like an email address should</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">554</span></pre></td><td class="code"><pre><span class="line">   * Static so it can be used without instantiation</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">555</span></pre></td><td class="code"><pre><span class="line">   * Tries to use PHP built-in validator in the filter extension (from PHP 5.2), falls back to a reasonably competent regex validator</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">556</span></pre></td><td class="code"><pre><span class="line">   * Conforms approximately to RFC2822</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">557</span></pre></td><td class="code"><pre><span class="line">   * @link http:&#x2F;&#x2F;www.hexillion.com&#x2F;samples&#x2F;#Regex Original pattern found here</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">558</span></pre></td><td class="code"><pre><span class="line">   * @param string $address The email address to check</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">559</span></pre></td><td class="code"><pre><span class="line">   * @return boolean</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">560</span></pre></td><td class="code"><pre><span class="line">   * @static</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">561</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">562</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">563</span></pre></td><td class="code"><pre><span class="line">  public static function ValidateAddress($address) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">564</span></pre></td><td class="code"><pre><span class="line">    if (function_exists(&#39;filter_var&#39;)) &#123; &#x2F;&#x2F;Introduced in PHP 5.2</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">565</span></pre></td><td class="code"><pre><span class="line">      if(filter_var($address, FILTER_VALIDATE_EMAIL) &#x3D;&#x3D;&#x3D; FALSE) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">566</span></pre></td><td class="code"><pre><span class="line">        return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">567</span></pre></td><td class="code"><pre><span class="line">      &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">568</span></pre></td><td class="code"><pre><span class="line">        return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">569</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">570</span></pre></td><td class="code"><pre><span class="line">    &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">571</span></pre></td><td class="code"><pre><span class="line">      return preg_match(&#39;&#x2F;^(?:[\w\!\#\$\%\&amp;\&#39;\*\+\-\&#x2F;\&#x3D;\?\^\&#96;\&#123;\|\&#125;\~]+\.)*[\w\!\#\$\%\&amp;\&#39;\*\+\-\&#x2F;\&#x3D;\?\^\&#96;\&#123;\|\&#125;\~]+@(?:(?:(?:[a-zA-Z0-9_](?:[a-zA-Z0-9_\-](?!\.))&#123;0,61&#125;[a-zA-Z0-9_-]?\.)+[a-zA-Z0-9_](?:[a-zA-Z0-9_\-](?!$))&#123;0,61&#125;[a-zA-Z0-9_]?)|(?:\[(?:(?:[01]?\d&#123;1,2&#125;|2[0-4]\d|25[0-5])\.)&#123;3&#125;(?:[01]?\d&#123;1,2&#125;|2[0-4]\d|25[0-5])\]))$&#x2F;&#39;, $address);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">572</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">573</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">574</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">575</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">576</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F; METHODS, MAIL SENDING</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">577</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">578</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">579</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">580</span></pre></td><td class="code"><pre><span class="line">   * Creates message and assigns Mailer. If the message is</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">581</span></pre></td><td class="code"><pre><span class="line">   * not sent successfully then it returns false.  Use the ErrorInfo</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">582</span></pre></td><td class="code"><pre><span class="line">   * variable to view description of the error.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">583</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">584</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">585</span></pre></td><td class="code"><pre><span class="line">  public function Send() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">586</span></pre></td><td class="code"><pre><span class="line">    try &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">587</span></pre></td><td class="code"><pre><span class="line">      if(!$this-&gt;PreSend()) return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">588</span></pre></td><td class="code"><pre><span class="line">      return $this-&gt;PostSend();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">589</span></pre></td><td class="code"><pre><span class="line">    &#125; catch (phpmailerException $e) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">590</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;SentMIMEMessage &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">591</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;SetError($e-&gt;getMessage());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">592</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;exceptions) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">593</span></pre></td><td class="code"><pre><span class="line">        throw $e;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">594</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">595</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">596</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">597</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">598</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">599</span></pre></td><td class="code"><pre><span class="line">  protected function PreSend() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">600</span></pre></td><td class="code"><pre><span class="line">    try &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">601</span></pre></td><td class="code"><pre><span class="line">      $mailHeader &#x3D; &quot;&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">602</span></pre></td><td class="code"><pre><span class="line">      if ((count($this-&gt;to) + count($this-&gt;cc) + count($this-&gt;bcc)) &lt; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">603</span></pre></td><td class="code"><pre><span class="line">        throw new phpmailerException($this-&gt;Lang(&#39;provide_address&#39;), self::STOP_CRITICAL);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">604</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">605</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">606</span></pre></td><td class="code"><pre><span class="line">      &#x2F;&#x2F; Set whether the message is multipart&#x2F;alternative</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">607</span></pre></td><td class="code"><pre><span class="line">      if(!empty($this-&gt;AltBody)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">608</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;ContentType &#x3D; &#39;multipart&#x2F;alternative&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">609</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">610</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">611</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error_count &#x3D; 0; &#x2F;&#x2F; reset errors</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">612</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;SetMessageType();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">613</span></pre></td><td class="code"><pre><span class="line">      &#x2F;&#x2F;Refuse to send an empty message</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">614</span></pre></td><td class="code"><pre><span class="line">      if (empty($this-&gt;Body)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">615</span></pre></td><td class="code"><pre><span class="line">        throw new phpmailerException($this-&gt;Lang(&#39;empty_message&#39;), self::STOP_CRITICAL);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">616</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">617</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">618</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;MIMEHeader &#x3D; $this-&gt;CreateHeader();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">619</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;MIMEBody &#x3D; $this-&gt;CreateBody();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">620</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">621</span></pre></td><td class="code"><pre><span class="line">      &#x2F;&#x2F; To capture the complete message when using mail(), create</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">622</span></pre></td><td class="code"><pre><span class="line">      &#x2F;&#x2F; an extra header list which CreateHeader() doesn&#39;t fold in</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">623</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;Mailer &#x3D;&#x3D; &#39;mail&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">624</span></pre></td><td class="code"><pre><span class="line">        if (count($this-&gt;to) &gt; 0) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">625</span></pre></td><td class="code"><pre><span class="line">          $mailHeader .&#x3D; $this-&gt;AddrAppend(&quot;To&quot;, $this-&gt;to);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">626</span></pre></td><td class="code"><pre><span class="line">        &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">627</span></pre></td><td class="code"><pre><span class="line">          $mailHeader .&#x3D; $this-&gt;HeaderLine(&quot;To&quot;, &quot;undisclosed-recipients:;&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">628</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">629</span></pre></td><td class="code"><pre><span class="line">        $mailHeader .&#x3D; $this-&gt;HeaderLine(&#39;Subject&#39;, $this-&gt;EncodeHeader($this-&gt;SecureHeader(trim($this-&gt;Subject))));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">630</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; if(count($this-&gt;cc) &gt; 0) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">631</span></pre></td><td class="code"><pre><span class="line">            &#x2F;&#x2F; $mailHeader .&#x3D; $this-&gt;AddrAppend(&quot;Cc&quot;, $this-&gt;cc);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">632</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">633</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">634</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">635</span></pre></td><td class="code"><pre><span class="line">      &#x2F;&#x2F; digitally sign with DKIM if enabled</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">636</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;DKIM_domain &amp;&amp; $this-&gt;DKIM_private) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">637</span></pre></td><td class="code"><pre><span class="line">        $header_dkim &#x3D; $this-&gt;DKIM_Add($this-&gt;MIMEHeader, $this-&gt;EncodeHeader($this-&gt;SecureHeader($this-&gt;Subject)), $this-&gt;MIMEBody);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">638</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;MIMEHeader &#x3D; str_replace(&quot;\r\n&quot;, &quot;\n&quot;, $header_dkim) . $this-&gt;MIMEHeader;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">639</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">640</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">641</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;SentMIMEMessage &#x3D; sprintf(&quot;%s%s\r\n\r\n%s&quot;,$this-&gt;MIMEHeader,$mailHeader,$this-&gt;MIMEBody);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">642</span></pre></td><td class="code"><pre><span class="line">      return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">643</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">644</span></pre></td><td class="code"><pre><span class="line">    &#125; catch (phpmailerException $e) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">645</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;SetError($e-&gt;getMessage());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">646</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;exceptions) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">647</span></pre></td><td class="code"><pre><span class="line">        throw $e;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">648</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">649</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">650</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">651</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">652</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">653</span></pre></td><td class="code"><pre><span class="line">  protected function PostSend() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">654</span></pre></td><td class="code"><pre><span class="line">    try &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">655</span></pre></td><td class="code"><pre><span class="line">      &#x2F;&#x2F; Choose the mailer and send through it</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">656</span></pre></td><td class="code"><pre><span class="line">      switch($this-&gt;Mailer) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">657</span></pre></td><td class="code"><pre><span class="line">        case &#39;sendmail&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">658</span></pre></td><td class="code"><pre><span class="line">          return $this-&gt;SendmailSend($this-&gt;MIMEHeader, $this-&gt;MIMEBody);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">659</span></pre></td><td class="code"><pre><span class="line">        case &#39;smtp&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">660</span></pre></td><td class="code"><pre><span class="line">          return $this-&gt;SmtpSend($this-&gt;MIMEHeader, $this-&gt;MIMEBody);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">661</span></pre></td><td class="code"><pre><span class="line">        case &#39;mail&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">662</span></pre></td><td class="code"><pre><span class="line">          return $this-&gt;MailSend($this-&gt;MIMEHeader, $this-&gt;MIMEBody);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">663</span></pre></td><td class="code"><pre><span class="line">        default:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">664</span></pre></td><td class="code"><pre><span class="line">          return $this-&gt;MailSend($this-&gt;MIMEHeader, $this-&gt;MIMEBody);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">665</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">666</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">667</span></pre></td><td class="code"><pre><span class="line">    &#125; catch (phpmailerException $e) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">668</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;SetError($e-&gt;getMessage());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">669</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;exceptions) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">670</span></pre></td><td class="code"><pre><span class="line">        throw $e;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">671</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">672</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;SMTPDebug) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">673</span></pre></td><td class="code"><pre><span class="line">        echo $e-&gt;getMessage().&quot;\n&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">674</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">675</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">676</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">677</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">678</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">679</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">680</span></pre></td><td class="code"><pre><span class="line">   * Sends mail using the $Sendmail program.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">681</span></pre></td><td class="code"><pre><span class="line">   * @param string $header The message headers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">682</span></pre></td><td class="code"><pre><span class="line">   * @param string $body The message body</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">683</span></pre></td><td class="code"><pre><span class="line">   * @access protected</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">684</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">685</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">686</span></pre></td><td class="code"><pre><span class="line">  protected function SendmailSend($header, $body) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">687</span></pre></td><td class="code"><pre><span class="line">    if ($this-&gt;Sender !&#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">688</span></pre></td><td class="code"><pre><span class="line">      $sendmail &#x3D; sprintf(&quot;%s -oi -f %s -t&quot;, escapeshellcmd($this-&gt;Sendmail), escapeshellarg($this-&gt;Sender));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">689</span></pre></td><td class="code"><pre><span class="line">    &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">690</span></pre></td><td class="code"><pre><span class="line">      $sendmail &#x3D; sprintf(&quot;%s -oi -t&quot;, escapeshellcmd($this-&gt;Sendmail));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">691</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">692</span></pre></td><td class="code"><pre><span class="line">    if ($this-&gt;SingleTo &#x3D;&#x3D;&#x3D; true) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">693</span></pre></td><td class="code"><pre><span class="line">      foreach ($this-&gt;SingleToArray as $key &#x3D;&gt; $val) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">694</span></pre></td><td class="code"><pre><span class="line">        if(!@$mail &#x3D; popen($sendmail, &#39;w&#39;)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">695</span></pre></td><td class="code"><pre><span class="line">          throw new phpmailerException($this-&gt;Lang(&#39;execute&#39;) . $this-&gt;Sendmail, self::STOP_CRITICAL);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">696</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">697</span></pre></td><td class="code"><pre><span class="line">        fputs($mail, &quot;To: &quot; . $val . &quot;\n&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">698</span></pre></td><td class="code"><pre><span class="line">        fputs($mail, $header);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">699</span></pre></td><td class="code"><pre><span class="line">        fputs($mail, $body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">700</span></pre></td><td class="code"><pre><span class="line">        $result &#x3D; pclose($mail);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">701</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; implement call back function if it exists</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">702</span></pre></td><td class="code"><pre><span class="line">        $isSent &#x3D; ($result &#x3D;&#x3D; 0) ? 1 : 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">703</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;doCallback($isSent, $val, $this-&gt;cc, $this-&gt;bcc, $this-&gt;Subject, $body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">704</span></pre></td><td class="code"><pre><span class="line">        if($result !&#x3D; 0) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">705</span></pre></td><td class="code"><pre><span class="line">          throw new phpmailerException($this-&gt;Lang(&#39;execute&#39;) . $this-&gt;Sendmail, self::STOP_CRITICAL);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">706</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">707</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">708</span></pre></td><td class="code"><pre><span class="line">    &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">709</span></pre></td><td class="code"><pre><span class="line">      if(!@$mail &#x3D; popen($sendmail, &#39;w&#39;)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">710</span></pre></td><td class="code"><pre><span class="line">        throw new phpmailerException($this-&gt;Lang(&#39;execute&#39;) . $this-&gt;Sendmail, self::STOP_CRITICAL);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">711</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">712</span></pre></td><td class="code"><pre><span class="line">      fputs($mail, $header);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">713</span></pre></td><td class="code"><pre><span class="line">      fputs($mail, $body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">714</span></pre></td><td class="code"><pre><span class="line">      $result &#x3D; pclose($mail);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">715</span></pre></td><td class="code"><pre><span class="line">      &#x2F;&#x2F; implement call back function if it exists</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">716</span></pre></td><td class="code"><pre><span class="line">      $isSent &#x3D; ($result &#x3D;&#x3D; 0) ? 1 : 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">717</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;doCallback($isSent, $this-&gt;to, $this-&gt;cc, $this-&gt;bcc, $this-&gt;Subject, $body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">718</span></pre></td><td class="code"><pre><span class="line">      if($result !&#x3D; 0) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">719</span></pre></td><td class="code"><pre><span class="line">        throw new phpmailerException($this-&gt;Lang(&#39;execute&#39;) . $this-&gt;Sendmail, self::STOP_CRITICAL);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">720</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">721</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">722</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">723</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">724</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">725</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">726</span></pre></td><td class="code"><pre><span class="line">   * Sends mail using the PHP mail() function.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">727</span></pre></td><td class="code"><pre><span class="line">   * @param string $header The message headers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">728</span></pre></td><td class="code"><pre><span class="line">   * @param string $body The message body</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">729</span></pre></td><td class="code"><pre><span class="line">   * @access protected</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">730</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">731</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">732</span></pre></td><td class="code"><pre><span class="line">  protected function MailSend($header, $body) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">733</span></pre></td><td class="code"><pre><span class="line">    $toArr &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">734</span></pre></td><td class="code"><pre><span class="line">    foreach($this-&gt;to as $t) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">735</span></pre></td><td class="code"><pre><span class="line">      $toArr[] &#x3D; $this-&gt;AddrFormat($t);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">736</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">737</span></pre></td><td class="code"><pre><span class="line">    $to &#x3D; implode(&#39;, &#39;, $toArr);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">738</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">739</span></pre></td><td class="code"><pre><span class="line">    if (empty($this-&gt;Sender)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">740</span></pre></td><td class="code"><pre><span class="line">      $params &#x3D; &quot;-oi &quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">741</span></pre></td><td class="code"><pre><span class="line">    &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">742</span></pre></td><td class="code"><pre><span class="line">      $params &#x3D; sprintf(&quot;-oi -f %s&quot;, $this-&gt;Sender);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">743</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">744</span></pre></td><td class="code"><pre><span class="line">    if ($this-&gt;Sender !&#x3D; &#39;&#39; and !ini_get(&#39;safe_mode&#39;)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">745</span></pre></td><td class="code"><pre><span class="line">      $old_from &#x3D; ini_get(&#39;sendmail_from&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">746</span></pre></td><td class="code"><pre><span class="line">      ini_set(&#39;sendmail_from&#39;, $this-&gt;Sender);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">747</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;SingleTo &#x3D;&#x3D;&#x3D; true &amp;&amp; count($toArr) &gt; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">748</span></pre></td><td class="code"><pre><span class="line">        foreach ($toArr as $key &#x3D;&gt; $val) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">749</span></pre></td><td class="code"><pre><span class="line">          $rt &#x3D; @mail($val, $this-&gt;EncodeHeader($this-&gt;SecureHeader($this-&gt;Subject)), $body, $header, $params);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">750</span></pre></td><td class="code"><pre><span class="line">          &#x2F;&#x2F; implement call back function if it exists</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">751</span></pre></td><td class="code"><pre><span class="line">          $isSent &#x3D; ($rt &#x3D;&#x3D; 1) ? 1 : 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">752</span></pre></td><td class="code"><pre><span class="line">          $this-&gt;doCallback($isSent, $val, $this-&gt;cc, $this-&gt;bcc, $this-&gt;Subject, $body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">753</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">754</span></pre></td><td class="code"><pre><span class="line">      &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">755</span></pre></td><td class="code"><pre><span class="line">        $rt &#x3D; @mail($to, $this-&gt;EncodeHeader($this-&gt;SecureHeader($this-&gt;Subject)), $body, $header, $params);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">756</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; implement call back function if it exists</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">757</span></pre></td><td class="code"><pre><span class="line">        $isSent &#x3D; ($rt &#x3D;&#x3D; 1) ? 1 : 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">758</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;doCallback($isSent, $to, $this-&gt;cc, $this-&gt;bcc, $this-&gt;Subject, $body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">759</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">760</span></pre></td><td class="code"><pre><span class="line">    &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">761</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;SingleTo &#x3D;&#x3D;&#x3D; true &amp;&amp; count($toArr) &gt; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">762</span></pre></td><td class="code"><pre><span class="line">        foreach ($toArr as $key &#x3D;&gt; $val) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">763</span></pre></td><td class="code"><pre><span class="line">          $rt &#x3D; @mail($val, $this-&gt;EncodeHeader($this-&gt;SecureHeader($this-&gt;Subject)), $body, $header, $params);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">764</span></pre></td><td class="code"><pre><span class="line">          &#x2F;&#x2F; implement call back function if it exists</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">765</span></pre></td><td class="code"><pre><span class="line">          $isSent &#x3D; ($rt &#x3D;&#x3D; 1) ? 1 : 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">766</span></pre></td><td class="code"><pre><span class="line">          $this-&gt;doCallback($isSent, $val, $this-&gt;cc, $this-&gt;bcc, $this-&gt;Subject, $body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">767</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">768</span></pre></td><td class="code"><pre><span class="line">      &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">769</span></pre></td><td class="code"><pre><span class="line">        $rt &#x3D; @mail($to, $this-&gt;EncodeHeader($this-&gt;SecureHeader($this-&gt;Subject)), $body, $header, $params);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">770</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; implement call back function if it exists</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">771</span></pre></td><td class="code"><pre><span class="line">        $isSent &#x3D; ($rt &#x3D;&#x3D; 1) ? 1 : 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">772</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;doCallback($isSent, $to, $this-&gt;cc, $this-&gt;bcc, $this-&gt;Subject, $body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">773</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">774</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">775</span></pre></td><td class="code"><pre><span class="line">    if (isset($old_from)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">776</span></pre></td><td class="code"><pre><span class="line">      ini_set(&#39;sendmail_from&#39;, $old_from);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">777</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">778</span></pre></td><td class="code"><pre><span class="line">    if(!$rt) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">779</span></pre></td><td class="code"><pre><span class="line">      throw new phpmailerException($this-&gt;Lang(&#39;instantiate&#39;), self::STOP_CRITICAL);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">780</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">781</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">782</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">783</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">784</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">785</span></pre></td><td class="code"><pre><span class="line">   * Sends mail via SMTP using PhpSMTP</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">786</span></pre></td><td class="code"><pre><span class="line">   * Returns false if there is a bad MAIL FROM, RCPT, or DATA input.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">787</span></pre></td><td class="code"><pre><span class="line">   * @param string $header The message headers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">788</span></pre></td><td class="code"><pre><span class="line">   * @param string $body The message body</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">789</span></pre></td><td class="code"><pre><span class="line">   * @uses SMTP</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">790</span></pre></td><td class="code"><pre><span class="line">   * @access protected</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">791</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">792</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">793</span></pre></td><td class="code"><pre><span class="line">  protected function SmtpSend($header, $body) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">794</span></pre></td><td class="code"><pre><span class="line">    require_once $this-&gt;PluginDir . &#39;Smtp.class.php&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">795</span></pre></td><td class="code"><pre><span class="line">    $bad_rcpt &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">796</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">797</span></pre></td><td class="code"><pre><span class="line">    if(!$this-&gt;SmtpConnect()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">798</span></pre></td><td class="code"><pre><span class="line">      throw new phpmailerException($this-&gt;Lang(&#39;smtp_connect_failed&#39;), self::STOP_CRITICAL);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">799</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">800</span></pre></td><td class="code"><pre><span class="line">    $smtp_from &#x3D; ($this-&gt;Sender &#x3D;&#x3D; &#39;&#39;) ? $this-&gt;From : $this-&gt;Sender;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">801</span></pre></td><td class="code"><pre><span class="line">    if(!$this-&gt;smtp-&gt;Mail($smtp_from)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">802</span></pre></td><td class="code"><pre><span class="line">      throw new phpmailerException($this-&gt;Lang(&#39;from_failed&#39;) . $smtp_from, self::STOP_CRITICAL);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">803</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">804</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">805</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Attempt to send attach all recipients</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">806</span></pre></td><td class="code"><pre><span class="line">    foreach($this-&gt;to as $to) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">807</span></pre></td><td class="code"><pre><span class="line">      if (!$this-&gt;smtp-&gt;Recipient($to[0])) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">808</span></pre></td><td class="code"><pre><span class="line">        $bad_rcpt[] &#x3D; $to[0];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">809</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; implement call back function if it exists</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">810</span></pre></td><td class="code"><pre><span class="line">        $isSent &#x3D; 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">811</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;doCallback($isSent, $to[0], &#39;&#39;, &#39;&#39;, $this-&gt;Subject, $body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">812</span></pre></td><td class="code"><pre><span class="line">      &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">813</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; implement call back function if it exists</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">814</span></pre></td><td class="code"><pre><span class="line">        $isSent &#x3D; 1;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">815</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;doCallback($isSent, $to[0], &#39;&#39;, &#39;&#39;, $this-&gt;Subject, $body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">816</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">817</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">818</span></pre></td><td class="code"><pre><span class="line">    foreach($this-&gt;cc as $cc) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">819</span></pre></td><td class="code"><pre><span class="line">      if (!$this-&gt;smtp-&gt;Recipient($cc[0])) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">820</span></pre></td><td class="code"><pre><span class="line">        $bad_rcpt[] &#x3D; $cc[0];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">821</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; implement call back function if it exists</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">822</span></pre></td><td class="code"><pre><span class="line">        $isSent &#x3D; 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">823</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;doCallback($isSent, &#39;&#39;, $cc[0], &#39;&#39;, $this-&gt;Subject, $body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">824</span></pre></td><td class="code"><pre><span class="line">      &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">825</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; implement call back function if it exists</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">826</span></pre></td><td class="code"><pre><span class="line">        $isSent &#x3D; 1;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">827</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;doCallback($isSent, &#39;&#39;, $cc[0], &#39;&#39;, $this-&gt;Subject, $body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">828</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">829</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">830</span></pre></td><td class="code"><pre><span class="line">    foreach($this-&gt;bcc as $bcc) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">831</span></pre></td><td class="code"><pre><span class="line">      if (!$this-&gt;smtp-&gt;Recipient($bcc[0])) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">832</span></pre></td><td class="code"><pre><span class="line">        $bad_rcpt[] &#x3D; $bcc[0];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">833</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; implement call back function if it exists</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">834</span></pre></td><td class="code"><pre><span class="line">        $isSent &#x3D; 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">835</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;doCallback($isSent, &#39;&#39;, &#39;&#39;, $bcc[0], $this-&gt;Subject, $body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">836</span></pre></td><td class="code"><pre><span class="line">      &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">837</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; implement call back function if it exists</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">838</span></pre></td><td class="code"><pre><span class="line">        $isSent &#x3D; 1;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">839</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;doCallback($isSent, &#39;&#39;, &#39;&#39;, $bcc[0], $this-&gt;Subject, $body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">840</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">841</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">842</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">843</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">844</span></pre></td><td class="code"><pre><span class="line">    if (count($bad_rcpt) &gt; 0 ) &#123; &#x2F;&#x2F;Create error message for any bad addresses</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">845</span></pre></td><td class="code"><pre><span class="line">      $badaddresses &#x3D; implode(&#39;, &#39;, $bad_rcpt);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">846</span></pre></td><td class="code"><pre><span class="line">      throw new phpmailerException($this-&gt;Lang(&#39;recipients_failed&#39;) . $badaddresses);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">847</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">848</span></pre></td><td class="code"><pre><span class="line">    if(!$this-&gt;smtp-&gt;Data($header . $body)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">849</span></pre></td><td class="code"><pre><span class="line">      throw new phpmailerException($this-&gt;Lang(&#39;data_not_accepted&#39;), self::STOP_CRITICAL);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">850</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">851</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;SMTPKeepAlive &#x3D;&#x3D; true) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">852</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;smtp-&gt;Reset();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">853</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">854</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">855</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">856</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">857</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">858</span></pre></td><td class="code"><pre><span class="line">   * Initiates a connection to an SMTP server.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">859</span></pre></td><td class="code"><pre><span class="line">   * Returns false if the operation failed.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">860</span></pre></td><td class="code"><pre><span class="line">   * @uses SMTP</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">861</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">862</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">863</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">864</span></pre></td><td class="code"><pre><span class="line">  public function SmtpConnect() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">865</span></pre></td><td class="code"><pre><span class="line">    if(is_null($this-&gt;smtp)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">866</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;smtp &#x3D; new SMTP();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">867</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">868</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">869</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;smtp-&gt;do_debug &#x3D; $this-&gt;SMTPDebug;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">870</span></pre></td><td class="code"><pre><span class="line">    $hosts &#x3D; explode(&#39;;&#39;, $this-&gt;Host);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">871</span></pre></td><td class="code"><pre><span class="line">    $index &#x3D; 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">872</span></pre></td><td class="code"><pre><span class="line">    $connection &#x3D; $this-&gt;smtp-&gt;Connected();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">873</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">874</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Retry while there is no connection</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">875</span></pre></td><td class="code"><pre><span class="line">    try &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">876</span></pre></td><td class="code"><pre><span class="line">      while($index &lt; count($hosts) &amp;&amp; !$connection) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">877</span></pre></td><td class="code"><pre><span class="line">        $hostinfo &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">878</span></pre></td><td class="code"><pre><span class="line">        if (preg_match(&#39;&#x2F;^(.+):([0-9]+)$&#x2F;&#39;, $hosts[$index], $hostinfo)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">879</span></pre></td><td class="code"><pre><span class="line">          $host &#x3D; $hostinfo[1];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">880</span></pre></td><td class="code"><pre><span class="line">          $port &#x3D; $hostinfo[2];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">881</span></pre></td><td class="code"><pre><span class="line">        &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">882</span></pre></td><td class="code"><pre><span class="line">          $host &#x3D; $hosts[$index];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">883</span></pre></td><td class="code"><pre><span class="line">          $port &#x3D; $this-&gt;Port;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">884</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">885</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">886</span></pre></td><td class="code"><pre><span class="line">        $tls &#x3D; ($this-&gt;SMTPSecure &#x3D;&#x3D; &#39;tls&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">887</span></pre></td><td class="code"><pre><span class="line">        $ssl &#x3D; ($this-&gt;SMTPSecure &#x3D;&#x3D; &#39;ssl&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">888</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">889</span></pre></td><td class="code"><pre><span class="line">        if ($this-&gt;smtp-&gt;Connect(($ssl ? &#39;ssl:&#x2F;&#x2F;&#39;:&#39;&#39;).$host, $port, $this-&gt;Timeout)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">890</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">891</span></pre></td><td class="code"><pre><span class="line">          $hello &#x3D; ($this-&gt;Helo !&#x3D; &#39;&#39; ? $this-&gt;Helo : $this-&gt;ServerHostname());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">892</span></pre></td><td class="code"><pre><span class="line">          $this-&gt;smtp-&gt;Hello($hello);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">893</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">894</span></pre></td><td class="code"><pre><span class="line">          if ($tls) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">895</span></pre></td><td class="code"><pre><span class="line">            if (!$this-&gt;smtp-&gt;StartTLS()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">896</span></pre></td><td class="code"><pre><span class="line">              throw new phpmailerException($this-&gt;Lang(&#39;tls&#39;));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">897</span></pre></td><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">898</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">899</span></pre></td><td class="code"><pre><span class="line">            &#x2F;&#x2F;We must resend HELO after tls negotiation</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">900</span></pre></td><td class="code"><pre><span class="line">            $this-&gt;smtp-&gt;Hello($hello);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">901</span></pre></td><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">902</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">903</span></pre></td><td class="code"><pre><span class="line">          $connection &#x3D; true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">904</span></pre></td><td class="code"><pre><span class="line">          if ($this-&gt;SMTPAuth) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">905</span></pre></td><td class="code"><pre><span class="line">            if (!$this-&gt;smtp-&gt;Authenticate($this-&gt;Username, $this-&gt;Password)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">906</span></pre></td><td class="code"><pre><span class="line">              throw new phpmailerException($this-&gt;Lang(&#39;authenticate&#39;));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">907</span></pre></td><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">908</span></pre></td><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">909</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">910</span></pre></td><td class="code"><pre><span class="line">        $index++;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">911</span></pre></td><td class="code"><pre><span class="line">        if (!$connection) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">912</span></pre></td><td class="code"><pre><span class="line">          throw new phpmailerException($this-&gt;Lang(&#39;connect_host&#39;));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">913</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">914</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">915</span></pre></td><td class="code"><pre><span class="line">    &#125; catch (phpmailerException $e) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">916</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;smtp-&gt;Reset();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">917</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;exceptions) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">918</span></pre></td><td class="code"><pre><span class="line">        throw $e;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">919</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">920</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">921</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">922</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">923</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">924</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">925</span></pre></td><td class="code"><pre><span class="line">   * Closes the active SMTP session if one exists.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">926</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">927</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">928</span></pre></td><td class="code"><pre><span class="line">  public function SmtpClose() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">929</span></pre></td><td class="code"><pre><span class="line">    if(!is_null($this-&gt;smtp)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">930</span></pre></td><td class="code"><pre><span class="line">      if($this-&gt;smtp-&gt;Connected()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">931</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;smtp-&gt;Quit();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">932</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;smtp-&gt;Close();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">933</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">934</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">935</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">936</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">937</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">938</span></pre></td><td class="code"><pre><span class="line">  * Sets the language for all class error messages.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">939</span></pre></td><td class="code"><pre><span class="line">  * Returns false if it cannot load the language file.  The default language is English.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">940</span></pre></td><td class="code"><pre><span class="line">  * @param string $langcode ISO 639-1 2-character language code (e.g. Portuguese: &quot;br&quot;)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">941</span></pre></td><td class="code"><pre><span class="line">  * @param string $lang_path Path to the language file directory</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">942</span></pre></td><td class="code"><pre><span class="line">  * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">943</span></pre></td><td class="code"><pre><span class="line">  *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">944</span></pre></td><td class="code"><pre><span class="line">  function SetLanguage($langcode &#x3D; &#39;en&#39;, $lang_path &#x3D; &#39;language&#x2F;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">945</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F;Define full set of translatable strings</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">946</span></pre></td><td class="code"><pre><span class="line">    $PHPMAILER_LANG &#x3D; array(</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">947</span></pre></td><td class="code"><pre><span class="line">      &#39;provide_address&#39; &#x3D;&gt; &#39;You must provide at least one recipient email address.&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">948</span></pre></td><td class="code"><pre><span class="line">      &#39;mailer_not_supported&#39; &#x3D;&gt; &#39; mailer is not supported.&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">949</span></pre></td><td class="code"><pre><span class="line">      &#39;execute&#39; &#x3D;&gt; &#39;Could not execute: &#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">950</span></pre></td><td class="code"><pre><span class="line">      &#39;instantiate&#39; &#x3D;&gt; &#39;Could not instantiate mail function.&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">951</span></pre></td><td class="code"><pre><span class="line">      &#39;authenticate&#39; &#x3D;&gt; &#39;SMTP Error: Could not authenticate.&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">952</span></pre></td><td class="code"><pre><span class="line">      &#39;from_failed&#39; &#x3D;&gt; &#39;The following From address failed: &#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">953</span></pre></td><td class="code"><pre><span class="line">      &#39;recipients_failed&#39; &#x3D;&gt; &#39;SMTP Error: The following recipients failed: &#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">954</span></pre></td><td class="code"><pre><span class="line">      &#39;data_not_accepted&#39; &#x3D;&gt; &#39;SMTP Error: Data not accepted.&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">955</span></pre></td><td class="code"><pre><span class="line">      &#39;connect_host&#39; &#x3D;&gt; &#39;SMTP Error: Could not connect to SMTP host.&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">956</span></pre></td><td class="code"><pre><span class="line">      &#39;file_access&#39; &#x3D;&gt; &#39;Could not access file: &#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">957</span></pre></td><td class="code"><pre><span class="line">      &#39;file_open&#39; &#x3D;&gt; &#39;File Error: Could not open file: &#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">958</span></pre></td><td class="code"><pre><span class="line">      &#39;encoding&#39; &#x3D;&gt; &#39;Unknown encoding: &#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">959</span></pre></td><td class="code"><pre><span class="line">      &#39;signing&#39; &#x3D;&gt; &#39;Signing Error: &#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">960</span></pre></td><td class="code"><pre><span class="line">      &#39;smtp_error&#39; &#x3D;&gt; &#39;SMTP server error: &#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">961</span></pre></td><td class="code"><pre><span class="line">      &#39;empty_message&#39; &#x3D;&gt; &#39;Message body empty&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">962</span></pre></td><td class="code"><pre><span class="line">      &#39;invalid_address&#39; &#x3D;&gt; &#39;Invalid address&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">963</span></pre></td><td class="code"><pre><span class="line">      &#39;variable_set&#39; &#x3D;&gt; &#39;Cannot set or reset variable: &#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">964</span></pre></td><td class="code"><pre><span class="line">    );</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">965</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F;Overwrite language-specific strings. This way we&#39;ll never have missing translations - no more &quot;language string failed to load&quot;!</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">966</span></pre></td><td class="code"><pre><span class="line">    $l &#x3D; true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">967</span></pre></td><td class="code"><pre><span class="line">    if ($langcode !&#x3D; &#39;en&#39;) &#123; &#x2F;&#x2F;There is no English translation file</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">968</span></pre></td><td class="code"><pre><span class="line">      $l &#x3D; @include $lang_path.&#39;phpmailer.lang-&#39;.$langcode.&#39;.php&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">969</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">970</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;language &#x3D; $PHPMAILER_LANG;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">971</span></pre></td><td class="code"><pre><span class="line">    return ($l &#x3D;&#x3D; true); &#x2F;&#x2F;Returns false if language not found</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">972</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">973</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">974</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">975</span></pre></td><td class="code"><pre><span class="line">  * Return the current array of language strings</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">976</span></pre></td><td class="code"><pre><span class="line">  * @return array</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">977</span></pre></td><td class="code"><pre><span class="line">  *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">978</span></pre></td><td class="code"><pre><span class="line">  public function GetTranslations() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">979</span></pre></td><td class="code"><pre><span class="line">    return $this-&gt;language;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">980</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">981</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">982</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">983</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F; METHODS, MESSAGE CREATION</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">984</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">985</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">986</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">987</span></pre></td><td class="code"><pre><span class="line">   * Creates recipient headers.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">988</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">989</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">990</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">991</span></pre></td><td class="code"><pre><span class="line">  public function AddrAppend($type, $addr) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">992</span></pre></td><td class="code"><pre><span class="line">    $addr_str &#x3D; $type . &#39;: &#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">993</span></pre></td><td class="code"><pre><span class="line">    $addresses &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">994</span></pre></td><td class="code"><pre><span class="line">    foreach ($addr as $a) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">995</span></pre></td><td class="code"><pre><span class="line">      $addresses[] &#x3D; $this-&gt;AddrFormat($a);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">996</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">997</span></pre></td><td class="code"><pre><span class="line">    $addr_str .&#x3D; implode(&#39;, &#39;, $addresses);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">998</span></pre></td><td class="code"><pre><span class="line">    $addr_str .&#x3D; $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">999</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1000</span></pre></td><td class="code"><pre><span class="line">    return $addr_str;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1001</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1002</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1003</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1004</span></pre></td><td class="code"><pre><span class="line">   * Formats an address correctly.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1005</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1006</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1007</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1008</span></pre></td><td class="code"><pre><span class="line">  public function AddrFormat($addr) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1009</span></pre></td><td class="code"><pre><span class="line">    if (empty($addr[1])) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1010</span></pre></td><td class="code"><pre><span class="line">      return $this-&gt;SecureHeader($addr[0]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1011</span></pre></td><td class="code"><pre><span class="line">    &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1012</span></pre></td><td class="code"><pre><span class="line">      return $this-&gt;EncodeHeader($this-&gt;SecureHeader($addr[1]), &#39;phrase&#39;) . &quot; &lt;&quot; . $this-&gt;SecureHeader($addr[0]) . &quot;&gt;&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1013</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1014</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1015</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1016</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1017</span></pre></td><td class="code"><pre><span class="line">   * Wraps message for use with mailers that do not</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1018</span></pre></td><td class="code"><pre><span class="line">   * automatically perform wrapping and for quoted-printable.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1019</span></pre></td><td class="code"><pre><span class="line">   * Original written by philippe.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1020</span></pre></td><td class="code"><pre><span class="line">   * @param string $message The message to wrap</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1021</span></pre></td><td class="code"><pre><span class="line">   * @param integer $length The line length to wrap to</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1022</span></pre></td><td class="code"><pre><span class="line">   * @param boolean $qp_mode Whether to run in Quoted-Printable mode</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1023</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1024</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1025</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1026</span></pre></td><td class="code"><pre><span class="line">  public function WrapText($message, $length, $qp_mode &#x3D; false) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1027</span></pre></td><td class="code"><pre><span class="line">    $soft_break &#x3D; ($qp_mode) ? sprintf(&quot; &#x3D;%s&quot;, $this-&gt;LE) : $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1028</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; If utf-8 encoding is used, we will need to make sure we don&#39;t</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1029</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; split multibyte characters when we wrap</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1030</span></pre></td><td class="code"><pre><span class="line">    $is_utf8 &#x3D; (strtolower($this-&gt;CharSet) &#x3D;&#x3D; &quot;utf-8&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1031</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1032</span></pre></td><td class="code"><pre><span class="line">    $message &#x3D; $this-&gt;FixEOL($message);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1033</span></pre></td><td class="code"><pre><span class="line">    if (substr($message, -1) &#x3D;&#x3D; $this-&gt;LE) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1034</span></pre></td><td class="code"><pre><span class="line">      $message &#x3D; substr($message, 0, -1);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1035</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1036</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1037</span></pre></td><td class="code"><pre><span class="line">    $line &#x3D; explode($this-&gt;LE, $message);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1038</span></pre></td><td class="code"><pre><span class="line">    $message &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1039</span></pre></td><td class="code"><pre><span class="line">    for ($i &#x3D; 0 ;$i &lt; count($line); $i++) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1040</span></pre></td><td class="code"><pre><span class="line">      $line_part &#x3D; explode(&#39; &#39;, $line[$i]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1041</span></pre></td><td class="code"><pre><span class="line">      $buf &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1042</span></pre></td><td class="code"><pre><span class="line">      for ($e &#x3D; 0; $e&lt;count($line_part); $e++) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1043</span></pre></td><td class="code"><pre><span class="line">        $word &#x3D; $line_part[$e];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1044</span></pre></td><td class="code"><pre><span class="line">        if ($qp_mode and (strlen($word) &gt; $length)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1045</span></pre></td><td class="code"><pre><span class="line">          $space_left &#x3D; $length - strlen($buf) - 1;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1046</span></pre></td><td class="code"><pre><span class="line">          if ($e !&#x3D; 0) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1047</span></pre></td><td class="code"><pre><span class="line">            if ($space_left &gt; 20) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1048</span></pre></td><td class="code"><pre><span class="line">              $len &#x3D; $space_left;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1049</span></pre></td><td class="code"><pre><span class="line">              if ($is_utf8) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1050</span></pre></td><td class="code"><pre><span class="line">                $len &#x3D; $this-&gt;UTF8CharBoundary($word, $len);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1051</span></pre></td><td class="code"><pre><span class="line">              &#125; elseif (substr($word, $len - 1, 1) &#x3D;&#x3D; &quot;&#x3D;&quot;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1052</span></pre></td><td class="code"><pre><span class="line">                $len--;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1053</span></pre></td><td class="code"><pre><span class="line">              &#125; elseif (substr($word, $len - 2, 1) &#x3D;&#x3D; &quot;&#x3D;&quot;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1054</span></pre></td><td class="code"><pre><span class="line">                $len -&#x3D; 2;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1055</span></pre></td><td class="code"><pre><span class="line">              &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1056</span></pre></td><td class="code"><pre><span class="line">              $part &#x3D; substr($word, 0, $len);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1057</span></pre></td><td class="code"><pre><span class="line">              $word &#x3D; substr($word, $len);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1058</span></pre></td><td class="code"><pre><span class="line">              $buf .&#x3D; &#39; &#39; . $part;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1059</span></pre></td><td class="code"><pre><span class="line">              $message .&#x3D; $buf . sprintf(&quot;&#x3D;%s&quot;, $this-&gt;LE);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1060</span></pre></td><td class="code"><pre><span class="line">            &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1061</span></pre></td><td class="code"><pre><span class="line">              $message .&#x3D; $buf . $soft_break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1062</span></pre></td><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1063</span></pre></td><td class="code"><pre><span class="line">            $buf &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1064</span></pre></td><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1065</span></pre></td><td class="code"><pre><span class="line">          while (strlen($word) &gt; 0) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1066</span></pre></td><td class="code"><pre><span class="line">            $len &#x3D; $length;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1067</span></pre></td><td class="code"><pre><span class="line">            if ($is_utf8) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1068</span></pre></td><td class="code"><pre><span class="line">              $len &#x3D; $this-&gt;UTF8CharBoundary($word, $len);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1069</span></pre></td><td class="code"><pre><span class="line">            &#125; elseif (substr($word, $len - 1, 1) &#x3D;&#x3D; &quot;&#x3D;&quot;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1070</span></pre></td><td class="code"><pre><span class="line">              $len--;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1071</span></pre></td><td class="code"><pre><span class="line">            &#125; elseif (substr($word, $len - 2, 1) &#x3D;&#x3D; &quot;&#x3D;&quot;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1072</span></pre></td><td class="code"><pre><span class="line">              $len -&#x3D; 2;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1073</span></pre></td><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1074</span></pre></td><td class="code"><pre><span class="line">            $part &#x3D; substr($word, 0, $len);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1075</span></pre></td><td class="code"><pre><span class="line">            $word &#x3D; substr($word, $len);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1076</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1077</span></pre></td><td class="code"><pre><span class="line">            if (strlen($word) &gt; 0) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1078</span></pre></td><td class="code"><pre><span class="line">              $message .&#x3D; $part . sprintf(&quot;&#x3D;%s&quot;, $this-&gt;LE);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1079</span></pre></td><td class="code"><pre><span class="line">            &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1080</span></pre></td><td class="code"><pre><span class="line">              $buf &#x3D; $part;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1081</span></pre></td><td class="code"><pre><span class="line">            &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1082</span></pre></td><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1083</span></pre></td><td class="code"><pre><span class="line">        &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1084</span></pre></td><td class="code"><pre><span class="line">          $buf_o &#x3D; $buf;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1085</span></pre></td><td class="code"><pre><span class="line">          $buf .&#x3D; ($e &#x3D;&#x3D; 0) ? $word : (&#39; &#39; . $word);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1086</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1087</span></pre></td><td class="code"><pre><span class="line">          if (strlen($buf) &gt; $length and $buf_o !&#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1088</span></pre></td><td class="code"><pre><span class="line">            $message .&#x3D; $buf_o . $soft_break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1089</span></pre></td><td class="code"><pre><span class="line">            $buf &#x3D; $word;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1090</span></pre></td><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1091</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1092</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1093</span></pre></td><td class="code"><pre><span class="line">      $message .&#x3D; $buf . $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1094</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1095</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1096</span></pre></td><td class="code"><pre><span class="line">    return $message;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1097</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1098</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1099</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1100</span></pre></td><td class="code"><pre><span class="line">   * Finds last character boundary prior to maxLength in a utf-8</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1101</span></pre></td><td class="code"><pre><span class="line">   * quoted (printable) encoded string.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1102</span></pre></td><td class="code"><pre><span class="line">   * Original written by Colin Brown.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1103</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1104</span></pre></td><td class="code"><pre><span class="line">   * @param string $encodedText utf-8 QP text</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1105</span></pre></td><td class="code"><pre><span class="line">   * @param int    $maxLength   find last character boundary prior to this length</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1106</span></pre></td><td class="code"><pre><span class="line">   * @return int</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1107</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1108</span></pre></td><td class="code"><pre><span class="line">  public function UTF8CharBoundary($encodedText, $maxLength) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1109</span></pre></td><td class="code"><pre><span class="line">    $foundSplitPos &#x3D; false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1110</span></pre></td><td class="code"><pre><span class="line">    $lookBack &#x3D; 3;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1111</span></pre></td><td class="code"><pre><span class="line">    while (!$foundSplitPos) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1112</span></pre></td><td class="code"><pre><span class="line">      $lastChunk &#x3D; substr($encodedText, $maxLength - $lookBack, $lookBack);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1113</span></pre></td><td class="code"><pre><span class="line">      $encodedCharPos &#x3D; strpos($lastChunk, &quot;&#x3D;&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1114</span></pre></td><td class="code"><pre><span class="line">      if ($encodedCharPos !&#x3D;&#x3D; false) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1115</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; Found start of encoded character byte within $lookBack block.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1116</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; Check the encoded byte value (the 2 chars after the &#39;&#x3D;&#39;)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1117</span></pre></td><td class="code"><pre><span class="line">        $hex &#x3D; substr($encodedText, $maxLength - $lookBack + $encodedCharPos + 1, 2);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1118</span></pre></td><td class="code"><pre><span class="line">        $dec &#x3D; hexdec($hex);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1119</span></pre></td><td class="code"><pre><span class="line">        if ($dec &lt; 128) &#123; &#x2F;&#x2F; Single byte character.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1120</span></pre></td><td class="code"><pre><span class="line">          &#x2F;&#x2F; If the encoded char was found at pos 0, it will fit</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1121</span></pre></td><td class="code"><pre><span class="line">          &#x2F;&#x2F; otherwise reduce maxLength to start of the encoded char</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1122</span></pre></td><td class="code"><pre><span class="line">          $maxLength &#x3D; ($encodedCharPos &#x3D;&#x3D; 0) ? $maxLength :</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1123</span></pre></td><td class="code"><pre><span class="line">          $maxLength - ($lookBack - $encodedCharPos);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1124</span></pre></td><td class="code"><pre><span class="line">          $foundSplitPos &#x3D; true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1125</span></pre></td><td class="code"><pre><span class="line">        &#125; elseif ($dec &gt;&#x3D; 192) &#123; &#x2F;&#x2F; First byte of a multi byte character</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1126</span></pre></td><td class="code"><pre><span class="line">          &#x2F;&#x2F; Reduce maxLength to split at start of character</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1127</span></pre></td><td class="code"><pre><span class="line">          $maxLength &#x3D; $maxLength - ($lookBack - $encodedCharPos);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1128</span></pre></td><td class="code"><pre><span class="line">          $foundSplitPos &#x3D; true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1129</span></pre></td><td class="code"><pre><span class="line">        &#125; elseif ($dec &lt; 192) &#123; &#x2F;&#x2F; Middle byte of a multi byte character, look further back</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1130</span></pre></td><td class="code"><pre><span class="line">          $lookBack +&#x3D; 3;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1131</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1132</span></pre></td><td class="code"><pre><span class="line">      &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1133</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; No encoded character found</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1134</span></pre></td><td class="code"><pre><span class="line">        $foundSplitPos &#x3D; true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1135</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1136</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1137</span></pre></td><td class="code"><pre><span class="line">    return $maxLength;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1138</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1139</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1140</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1141</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1142</span></pre></td><td class="code"><pre><span class="line">   * Set the body wrapping.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1143</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1144</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1145</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1146</span></pre></td><td class="code"><pre><span class="line">  public function SetWordWrap() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1147</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;WordWrap &lt; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1148</span></pre></td><td class="code"><pre><span class="line">      return;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1149</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1150</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1151</span></pre></td><td class="code"><pre><span class="line">    switch($this-&gt;message_type) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1152</span></pre></td><td class="code"><pre><span class="line">      case &#39;alt&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1153</span></pre></td><td class="code"><pre><span class="line">      case &#39;alt_inline&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1154</span></pre></td><td class="code"><pre><span class="line">      case &#39;alt_attach&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1155</span></pre></td><td class="code"><pre><span class="line">      case &#39;alt_inline_attach&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1156</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;AltBody &#x3D; $this-&gt;WrapText($this-&gt;AltBody, $this-&gt;WordWrap);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1157</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1158</span></pre></td><td class="code"><pre><span class="line">      default:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1159</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;Body &#x3D; $this-&gt;WrapText($this-&gt;Body, $this-&gt;WordWrap);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1160</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1161</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1162</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1163</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1164</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1165</span></pre></td><td class="code"><pre><span class="line">   * Assembles message header.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1166</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1167</span></pre></td><td class="code"><pre><span class="line">   * @return string The assembled header</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1168</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1169</span></pre></td><td class="code"><pre><span class="line">  public function CreateHeader() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1170</span></pre></td><td class="code"><pre><span class="line">    $result &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1171</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1172</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Set the boundaries</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1173</span></pre></td><td class="code"><pre><span class="line">    $uniq_id &#x3D; md5(uniqid(time()));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1174</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;boundary[1] &#x3D; &#39;b1_&#39; . $uniq_id;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1175</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;boundary[2] &#x3D; &#39;b2_&#39; . $uniq_id;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1176</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;boundary[3] &#x3D; &#39;b3_&#39; . $uniq_id;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1177</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1178</span></pre></td><td class="code"><pre><span class="line">    $result .&#x3D; $this-&gt;HeaderLine(&#39;Date&#39;, self::RFCDate());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1179</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;Sender &#x3D;&#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1180</span></pre></td><td class="code"><pre><span class="line">      $result .&#x3D; $this-&gt;HeaderLine(&#39;Return-Path&#39;, trim($this-&gt;From));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1181</span></pre></td><td class="code"><pre><span class="line">    &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1182</span></pre></td><td class="code"><pre><span class="line">      $result .&#x3D; $this-&gt;HeaderLine(&#39;Return-Path&#39;, trim($this-&gt;Sender));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1183</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1184</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1185</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; To be created automatically by mail()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1186</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;Mailer !&#x3D; &#39;mail&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1187</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;SingleTo &#x3D;&#x3D;&#x3D; true) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1188</span></pre></td><td class="code"><pre><span class="line">        foreach($this-&gt;to as $t) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1189</span></pre></td><td class="code"><pre><span class="line">          $this-&gt;SingleToArray[] &#x3D; $this-&gt;AddrFormat($t);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1190</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1191</span></pre></td><td class="code"><pre><span class="line">      &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1192</span></pre></td><td class="code"><pre><span class="line">        if(count($this-&gt;to) &gt; 0) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1193</span></pre></td><td class="code"><pre><span class="line">          $result .&#x3D; $this-&gt;AddrAppend(&#39;To&#39;, $this-&gt;to);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1194</span></pre></td><td class="code"><pre><span class="line">        &#125; elseif (count($this-&gt;cc) &#x3D;&#x3D; 0) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1195</span></pre></td><td class="code"><pre><span class="line">          $result .&#x3D; $this-&gt;HeaderLine(&#39;To&#39;, &#39;undisclosed-recipients:;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1196</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1197</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1198</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1199</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1200</span></pre></td><td class="code"><pre><span class="line">    $from &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1201</span></pre></td><td class="code"><pre><span class="line">    $from[0][0] &#x3D; trim($this-&gt;From);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1202</span></pre></td><td class="code"><pre><span class="line">    $from[0][1] &#x3D; $this-&gt;FromName;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1203</span></pre></td><td class="code"><pre><span class="line">    $result .&#x3D; $this-&gt;AddrAppend(&#39;From&#39;, $from);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1204</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1205</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; sendmail and mail() extract Cc from the header before sending</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1206</span></pre></td><td class="code"><pre><span class="line">    if(count($this-&gt;cc) &gt; 0) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1207</span></pre></td><td class="code"><pre><span class="line">      $result .&#x3D; $this-&gt;AddrAppend(&#39;Cc&#39;, $this-&gt;cc);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1208</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1209</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1210</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; sendmail and mail() extract Bcc from the header before sending</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1211</span></pre></td><td class="code"><pre><span class="line">    if((($this-&gt;Mailer &#x3D;&#x3D; &#39;sendmail&#39;) || ($this-&gt;Mailer &#x3D;&#x3D; &#39;mail&#39;)) &amp;&amp; (count($this-&gt;bcc) &gt; 0)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1212</span></pre></td><td class="code"><pre><span class="line">      $result .&#x3D; $this-&gt;AddrAppend(&#39;Bcc&#39;, $this-&gt;bcc);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1213</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1214</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1215</span></pre></td><td class="code"><pre><span class="line">    if(count($this-&gt;ReplyTo) &gt; 0) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1216</span></pre></td><td class="code"><pre><span class="line">      $result .&#x3D; $this-&gt;AddrAppend(&#39;Reply-To&#39;, $this-&gt;ReplyTo);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1217</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1218</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1219</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; mail() sets the subject itself</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1220</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;Mailer !&#x3D; &#39;mail&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1221</span></pre></td><td class="code"><pre><span class="line">      $result .&#x3D; $this-&gt;HeaderLine(&#39;Subject&#39;, $this-&gt;EncodeHeader($this-&gt;SecureHeader($this-&gt;Subject)));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1222</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1223</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1224</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;MessageID !&#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1225</span></pre></td><td class="code"><pre><span class="line">      $result .&#x3D; $this-&gt;HeaderLine(&#39;Message-ID&#39;, $this-&gt;MessageID);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1226</span></pre></td><td class="code"><pre><span class="line">    &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1227</span></pre></td><td class="code"><pre><span class="line">      $result .&#x3D; sprintf(&quot;Message-ID: &lt;%s@%s&gt;%s&quot;, $uniq_id, $this-&gt;ServerHostname(), $this-&gt;LE);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1228</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1229</span></pre></td><td class="code"><pre><span class="line">    $result .&#x3D; $this-&gt;HeaderLine(&#39;X-Priority&#39;, $this-&gt;Priority);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1230</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;XMailer) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1231</span></pre></td><td class="code"><pre><span class="line">      $result .&#x3D; $this-&gt;HeaderLine(&#39;X-Mailer&#39;, $this-&gt;XMailer);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1232</span></pre></td><td class="code"><pre><span class="line">    &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1233</span></pre></td><td class="code"><pre><span class="line">      $result .&#x3D; $this-&gt;HeaderLine(&#39;X-Mailer&#39;, &#39;PHPMailer &#39;.$this-&gt;Version.&#39; (http:&#x2F;&#x2F;code.google.com&#x2F;a&#x2F;apache-extras.org&#x2F;p&#x2F;phpmailer&#x2F;)&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1234</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1235</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1236</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;ConfirmReadingTo !&#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1237</span></pre></td><td class="code"><pre><span class="line">      $result .&#x3D; $this-&gt;HeaderLine(&#39;Disposition-Notification-To&#39;, &#39;&lt;&#39; . trim($this-&gt;ConfirmReadingTo) . &#39;&gt;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1238</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1239</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1240</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Add custom headers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1241</span></pre></td><td class="code"><pre><span class="line">    for($index &#x3D; 0; $index &lt; count($this-&gt;CustomHeader); $index++) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1242</span></pre></td><td class="code"><pre><span class="line">      $result .&#x3D; $this-&gt;HeaderLine(trim($this-&gt;CustomHeader[$index][0]), $this-&gt;EncodeHeader(trim($this-&gt;CustomHeader[$index][1])));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1243</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1244</span></pre></td><td class="code"><pre><span class="line">    if (!$this-&gt;sign_key_file) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1245</span></pre></td><td class="code"><pre><span class="line">      $result .&#x3D; $this-&gt;HeaderLine(&#39;MIME-Version&#39;, &#39;1.0&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1246</span></pre></td><td class="code"><pre><span class="line">      $result .&#x3D; $this-&gt;GetMailMIME();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1247</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1248</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1249</span></pre></td><td class="code"><pre><span class="line">    return $result;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1250</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1251</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1252</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1253</span></pre></td><td class="code"><pre><span class="line">   * Returns the message MIME.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1254</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1255</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1256</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1257</span></pre></td><td class="code"><pre><span class="line">  public function GetMailMIME() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1258</span></pre></td><td class="code"><pre><span class="line">    $result &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1259</span></pre></td><td class="code"><pre><span class="line">    switch($this-&gt;message_type) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1260</span></pre></td><td class="code"><pre><span class="line">      case &#39;plain&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1261</span></pre></td><td class="code"><pre><span class="line">        $result .&#x3D; $this-&gt;HeaderLine(&#39;Content-Transfer-Encoding&#39;, $this-&gt;Encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1262</span></pre></td><td class="code"><pre><span class="line">        $result .&#x3D; $this-&gt;TextLine(&#39;Content-Type: &#39;.$this-&gt;ContentType.&#39;; charset&#x3D;&quot;&#39;.$this-&gt;CharSet.&#39;&quot;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1263</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1264</span></pre></td><td class="code"><pre><span class="line">      case &#39;inline&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1265</span></pre></td><td class="code"><pre><span class="line">        $result .&#x3D; $this-&gt;HeaderLine(&#39;Content-Type&#39;, &#39;multipart&#x2F;related;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1266</span></pre></td><td class="code"><pre><span class="line">        $result .&#x3D; $this-&gt;TextLine(&quot;\tboundary&#x3D;\&quot;&quot; . $this-&gt;boundary[1] . &#39;&quot;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1267</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1268</span></pre></td><td class="code"><pre><span class="line">      case &#39;attach&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1269</span></pre></td><td class="code"><pre><span class="line">      case &#39;inline_attach&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1270</span></pre></td><td class="code"><pre><span class="line">      case &#39;alt_attach&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1271</span></pre></td><td class="code"><pre><span class="line">      case &#39;alt_inline_attach&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1272</span></pre></td><td class="code"><pre><span class="line">        $result .&#x3D; $this-&gt;HeaderLine(&#39;Content-Type&#39;, &#39;multipart&#x2F;mixed;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1273</span></pre></td><td class="code"><pre><span class="line">        $result .&#x3D; $this-&gt;TextLine(&quot;\tboundary&#x3D;\&quot;&quot; . $this-&gt;boundary[1] . &#39;&quot;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1274</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1275</span></pre></td><td class="code"><pre><span class="line">      case &#39;alt&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1276</span></pre></td><td class="code"><pre><span class="line">      case &#39;alt_inline&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1277</span></pre></td><td class="code"><pre><span class="line">        $result .&#x3D; $this-&gt;HeaderLine(&#39;Content-Type&#39;, &#39;multipart&#x2F;alternative;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1278</span></pre></td><td class="code"><pre><span class="line">        $result .&#x3D; $this-&gt;TextLine(&quot;\tboundary&#x3D;\&quot;&quot; . $this-&gt;boundary[1] . &#39;&quot;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1279</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1280</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1281</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1282</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;Mailer !&#x3D; &#39;mail&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1283</span></pre></td><td class="code"><pre><span class="line">      $result .&#x3D; $this-&gt;LE.$this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1284</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1285</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1286</span></pre></td><td class="code"><pre><span class="line">    return $result;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1287</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1288</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1289</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1290</span></pre></td><td class="code"><pre><span class="line">   * Returns the MIME message (headers and body). Only really valid post PreSend().</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1291</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1292</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1293</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1294</span></pre></td><td class="code"><pre><span class="line">  public function GetSentMIMEMessage() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1295</span></pre></td><td class="code"><pre><span class="line">    return $this-&gt;SentMIMEMessage;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1296</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1297</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1298</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1299</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1300</span></pre></td><td class="code"><pre><span class="line">   * Assembles the message body.  Returns an empty string on failure.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1301</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1302</span></pre></td><td class="code"><pre><span class="line">   * @return string The assembled message body</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1303</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1304</span></pre></td><td class="code"><pre><span class="line">  public function CreateBody() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1305</span></pre></td><td class="code"><pre><span class="line">    $body &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1306</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1307</span></pre></td><td class="code"><pre><span class="line">    if ($this-&gt;sign_key_file) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1308</span></pre></td><td class="code"><pre><span class="line">      $body .&#x3D; $this-&gt;GetMailMIME();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1309</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1310</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1311</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;SetWordWrap();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1312</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1313</span></pre></td><td class="code"><pre><span class="line">    switch($this-&gt;message_type) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1314</span></pre></td><td class="code"><pre><span class="line">      case &#39;plain&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1315</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;EncodeString($this-&gt;Body, $this-&gt;Encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1316</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1317</span></pre></td><td class="code"><pre><span class="line">      case &#39;inline&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1318</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;GetBoundary($this-&gt;boundary[1], &#39;&#39;, &#39;&#39;, &#39;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1319</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;EncodeString($this-&gt;Body, $this-&gt;Encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1320</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE.$this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1321</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;AttachAll(&quot;inline&quot;, $this-&gt;boundary[1]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1322</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1323</span></pre></td><td class="code"><pre><span class="line">      case &#39;attach&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1324</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;GetBoundary($this-&gt;boundary[1], &#39;&#39;, &#39;&#39;, &#39;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1325</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;EncodeString($this-&gt;Body, $this-&gt;Encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1326</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE.$this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1327</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;AttachAll(&quot;attachment&quot;, $this-&gt;boundary[1]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1328</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1329</span></pre></td><td class="code"><pre><span class="line">      case &#39;inline_attach&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1330</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;TextLine(&quot;--&quot; . $this-&gt;boundary[1]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1331</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;HeaderLine(&#39;Content-Type&#39;, &#39;multipart&#x2F;related;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1332</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;TextLine(&quot;\tboundary&#x3D;\&quot;&quot; . $this-&gt;boundary[2] . &#39;&quot;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1333</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1334</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;GetBoundary($this-&gt;boundary[2], &#39;&#39;, &#39;&#39;, &#39;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1335</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;EncodeString($this-&gt;Body, $this-&gt;Encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1336</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE.$this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1337</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;AttachAll(&quot;inline&quot;, $this-&gt;boundary[2]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1338</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1339</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;AttachAll(&quot;attachment&quot;, $this-&gt;boundary[1]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1340</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1341</span></pre></td><td class="code"><pre><span class="line">      case &#39;alt&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1342</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;GetBoundary($this-&gt;boundary[1], &#39;&#39;, &#39;text&#x2F;plain&#39;, &#39;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1343</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;EncodeString($this-&gt;AltBody, $this-&gt;Encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1344</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE.$this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1345</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;GetBoundary($this-&gt;boundary[1], &#39;&#39;, &#39;text&#x2F;html&#39;, &#39;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1346</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;EncodeString($this-&gt;Body, $this-&gt;Encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1347</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE.$this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1348</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;EndBoundary($this-&gt;boundary[1]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1349</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1350</span></pre></td><td class="code"><pre><span class="line">      case &#39;alt_inline&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1351</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;GetBoundary($this-&gt;boundary[1], &#39;&#39;, &#39;text&#x2F;plain&#39;, &#39;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1352</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;EncodeString($this-&gt;AltBody, $this-&gt;Encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1353</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE.$this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1354</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;TextLine(&quot;--&quot; . $this-&gt;boundary[1]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1355</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;HeaderLine(&#39;Content-Type&#39;, &#39;multipart&#x2F;related;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1356</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;TextLine(&quot;\tboundary&#x3D;\&quot;&quot; . $this-&gt;boundary[2] . &#39;&quot;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1357</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1358</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;GetBoundary($this-&gt;boundary[2], &#39;&#39;, &#39;text&#x2F;html&#39;, &#39;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1359</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;EncodeString($this-&gt;Body, $this-&gt;Encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1360</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE.$this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1361</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;AttachAll(&quot;inline&quot;, $this-&gt;boundary[2]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1362</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1363</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;EndBoundary($this-&gt;boundary[1]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1364</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1365</span></pre></td><td class="code"><pre><span class="line">      case &#39;alt_attach&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1366</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;TextLine(&quot;--&quot; . $this-&gt;boundary[1]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1367</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;HeaderLine(&#39;Content-Type&#39;, &#39;multipart&#x2F;alternative;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1368</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;TextLine(&quot;\tboundary&#x3D;\&quot;&quot; . $this-&gt;boundary[2] . &#39;&quot;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1369</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1370</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;GetBoundary($this-&gt;boundary[2], &#39;&#39;, &#39;text&#x2F;plain&#39;, &#39;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1371</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;EncodeString($this-&gt;AltBody, $this-&gt;Encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1372</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE.$this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1373</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;GetBoundary($this-&gt;boundary[2], &#39;&#39;, &#39;text&#x2F;html&#39;, &#39;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1374</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;EncodeString($this-&gt;Body, $this-&gt;Encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1375</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE.$this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1376</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;EndBoundary($this-&gt;boundary[2]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1377</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1378</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;AttachAll(&quot;attachment&quot;, $this-&gt;boundary[1]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1379</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1380</span></pre></td><td class="code"><pre><span class="line">      case &#39;alt_inline_attach&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1381</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;TextLine(&quot;--&quot; . $this-&gt;boundary[1]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1382</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;HeaderLine(&#39;Content-Type&#39;, &#39;multipart&#x2F;alternative;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1383</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;TextLine(&quot;\tboundary&#x3D;\&quot;&quot; . $this-&gt;boundary[2] . &#39;&quot;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1384</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1385</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;GetBoundary($this-&gt;boundary[2], &#39;&#39;, &#39;text&#x2F;plain&#39;, &#39;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1386</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;EncodeString($this-&gt;AltBody, $this-&gt;Encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1387</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE.$this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1388</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;TextLine(&quot;--&quot; . $this-&gt;boundary[2]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1389</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;HeaderLine(&#39;Content-Type&#39;, &#39;multipart&#x2F;related;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1390</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;TextLine(&quot;\tboundary&#x3D;\&quot;&quot; . $this-&gt;boundary[3] . &#39;&quot;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1391</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1392</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;GetBoundary($this-&gt;boundary[3], &#39;&#39;, &#39;text&#x2F;html&#39;, &#39;&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1393</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;EncodeString($this-&gt;Body, $this-&gt;Encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1394</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE.$this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1395</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;AttachAll(&quot;inline&quot;, $this-&gt;boundary[3]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1396</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1397</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;EndBoundary($this-&gt;boundary[2]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1398</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1399</span></pre></td><td class="code"><pre><span class="line">        $body .&#x3D; $this-&gt;AttachAll(&quot;attachment&quot;, $this-&gt;boundary[1]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1400</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1401</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1402</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1403</span></pre></td><td class="code"><pre><span class="line">    if ($this-&gt;IsError()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1404</span></pre></td><td class="code"><pre><span class="line">      $body &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1405</span></pre></td><td class="code"><pre><span class="line">    &#125; elseif ($this-&gt;sign_key_file) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1406</span></pre></td><td class="code"><pre><span class="line">      try &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1407</span></pre></td><td class="code"><pre><span class="line">        $file &#x3D; tempnam(&#39;&#39;, &#39;mail&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1408</span></pre></td><td class="code"><pre><span class="line">        file_put_contents($file, $body); &#x2F;&#x2F;TODO check this worked</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1409</span></pre></td><td class="code"><pre><span class="line">        $signed &#x3D; tempnam(&quot;&quot;, &quot;signed&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1410</span></pre></td><td class="code"><pre><span class="line">        if (@openssl_pkcs7_sign($file, $signed, &quot;file:&#x2F;&#x2F;&quot;.$this-&gt;sign_cert_file, array(&quot;file:&#x2F;&#x2F;&quot;.$this-&gt;sign_key_file, $this-&gt;sign_key_pass), NULL)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1411</span></pre></td><td class="code"><pre><span class="line">          @unlink($file);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1412</span></pre></td><td class="code"><pre><span class="line">          $body &#x3D; file_get_contents($signed);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1413</span></pre></td><td class="code"><pre><span class="line">          @unlink($signed);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1414</span></pre></td><td class="code"><pre><span class="line">        &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1415</span></pre></td><td class="code"><pre><span class="line">          @unlink($file);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1416</span></pre></td><td class="code"><pre><span class="line">          @unlink($signed);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1417</span></pre></td><td class="code"><pre><span class="line">          throw new phpmailerException($this-&gt;Lang(&quot;signing&quot;).openssl_error_string());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1418</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1419</span></pre></td><td class="code"><pre><span class="line">      &#125; catch (phpmailerException $e) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1420</span></pre></td><td class="code"><pre><span class="line">        $body &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1421</span></pre></td><td class="code"><pre><span class="line">        if ($this-&gt;exceptions) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1422</span></pre></td><td class="code"><pre><span class="line">          throw $e;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1423</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1424</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1425</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1426</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1427</span></pre></td><td class="code"><pre><span class="line">    return $body;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1428</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1429</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1430</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1431</span></pre></td><td class="code"><pre><span class="line">   * Returns the start of a message boundary.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1432</span></pre></td><td class="code"><pre><span class="line">   * @access protected</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1433</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1434</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1435</span></pre></td><td class="code"><pre><span class="line">  protected function GetBoundary($boundary, $charSet, $contentType, $encoding) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1436</span></pre></td><td class="code"><pre><span class="line">    $result &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1437</span></pre></td><td class="code"><pre><span class="line">    if($charSet &#x3D;&#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1438</span></pre></td><td class="code"><pre><span class="line">      $charSet &#x3D; $this-&gt;CharSet;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1439</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1440</span></pre></td><td class="code"><pre><span class="line">    if($contentType &#x3D;&#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1441</span></pre></td><td class="code"><pre><span class="line">      $contentType &#x3D; $this-&gt;ContentType;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1442</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1443</span></pre></td><td class="code"><pre><span class="line">    if($encoding &#x3D;&#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1444</span></pre></td><td class="code"><pre><span class="line">      $encoding &#x3D; $this-&gt;Encoding;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1445</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1446</span></pre></td><td class="code"><pre><span class="line">    $result .&#x3D; $this-&gt;TextLine(&#39;--&#39; . $boundary);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1447</span></pre></td><td class="code"><pre><span class="line">    $result .&#x3D; sprintf(&quot;Content-Type: %s; charset&#x3D;\&quot;%s\&quot;&quot;, $contentType, $charSet);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1448</span></pre></td><td class="code"><pre><span class="line">    $result .&#x3D; $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1449</span></pre></td><td class="code"><pre><span class="line">    $result .&#x3D; $this-&gt;HeaderLine(&#39;Content-Transfer-Encoding&#39;, $encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1450</span></pre></td><td class="code"><pre><span class="line">    $result .&#x3D; $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1451</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1452</span></pre></td><td class="code"><pre><span class="line">    return $result;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1453</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1454</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1455</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1456</span></pre></td><td class="code"><pre><span class="line">   * Returns the end of a message boundary.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1457</span></pre></td><td class="code"><pre><span class="line">   * @access protected</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1458</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1459</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1460</span></pre></td><td class="code"><pre><span class="line">  protected function EndBoundary($boundary) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1461</span></pre></td><td class="code"><pre><span class="line">    return $this-&gt;LE . &#39;--&#39; . $boundary . &#39;--&#39; . $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1462</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1463</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1464</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1465</span></pre></td><td class="code"><pre><span class="line">   * Sets the message type.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1466</span></pre></td><td class="code"><pre><span class="line">   * @access protected</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1467</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1468</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1469</span></pre></td><td class="code"><pre><span class="line">  protected function SetMessageType() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1470</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;message_type &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1471</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;AlternativeExists()) $this-&gt;message_type[] &#x3D; &quot;alt&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1472</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;InlineImageExists()) $this-&gt;message_type[] &#x3D; &quot;inline&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1473</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;AttachmentExists()) $this-&gt;message_type[] &#x3D; &quot;attach&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1474</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;message_type &#x3D; implode(&quot;_&quot;, $this-&gt;message_type);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1475</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;message_type &#x3D;&#x3D; &quot;&quot;) $this-&gt;message_type &#x3D; &quot;plain&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1476</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1477</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1478</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1479</span></pre></td><td class="code"><pre><span class="line">   *  Returns a formatted header line.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1480</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1481</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1482</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1483</span></pre></td><td class="code"><pre><span class="line">  public function HeaderLine($name, $value) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1484</span></pre></td><td class="code"><pre><span class="line">    return $name . &#39;: &#39; . $value . $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1485</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1486</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1487</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1488</span></pre></td><td class="code"><pre><span class="line">   * Returns a formatted mail line.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1489</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1490</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1491</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1492</span></pre></td><td class="code"><pre><span class="line">  public function TextLine($value) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1493</span></pre></td><td class="code"><pre><span class="line">    return $value . $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1494</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1495</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1496</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1497</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F; CLASS METHODS, ATTACHMENTS</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1498</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1499</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1500</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1501</span></pre></td><td class="code"><pre><span class="line">   * Adds an attachment from a path on the filesystem.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1502</span></pre></td><td class="code"><pre><span class="line">   * Returns false if the file could not be found</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1503</span></pre></td><td class="code"><pre><span class="line">   * or accessed.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1504</span></pre></td><td class="code"><pre><span class="line">   * @param string $path Path to the attachment.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1505</span></pre></td><td class="code"><pre><span class="line">   * @param string $name Overrides the attachment name.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1506</span></pre></td><td class="code"><pre><span class="line">   * @param string $encoding File encoding (see $Encoding).</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1507</span></pre></td><td class="code"><pre><span class="line">   * @param string $type File extension (MIME) type.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1508</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1509</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1510</span></pre></td><td class="code"><pre><span class="line">  public function AddAttachment($path, $name &#x3D; &#39;&#39;, $encoding &#x3D; &#39;base64&#39;, $type &#x3D; &#39;application&#x2F;octet-stream&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1511</span></pre></td><td class="code"><pre><span class="line">    try &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1512</span></pre></td><td class="code"><pre><span class="line">      if ( !@is_file($path) ) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1513</span></pre></td><td class="code"><pre><span class="line">        throw new phpmailerException($this-&gt;Lang(&#39;file_access&#39;) . $path, self::STOP_CONTINUE);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1514</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1515</span></pre></td><td class="code"><pre><span class="line">      $filename &#x3D; basename($path);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1516</span></pre></td><td class="code"><pre><span class="line">      if ( $name &#x3D;&#x3D; &#39;&#39; ) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1517</span></pre></td><td class="code"><pre><span class="line">        $name &#x3D; $filename;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1518</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1519</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1520</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;attachment[] &#x3D; array(</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1521</span></pre></td><td class="code"><pre><span class="line">        0 &#x3D;&gt; $path,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1522</span></pre></td><td class="code"><pre><span class="line">        1 &#x3D;&gt; $filename,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1523</span></pre></td><td class="code"><pre><span class="line">        2 &#x3D;&gt; $name,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1524</span></pre></td><td class="code"><pre><span class="line">        3 &#x3D;&gt; $encoding,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1525</span></pre></td><td class="code"><pre><span class="line">        4 &#x3D;&gt; $type,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1526</span></pre></td><td class="code"><pre><span class="line">        5 &#x3D;&gt; false,  &#x2F;&#x2F; isStringAttachment</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1527</span></pre></td><td class="code"><pre><span class="line">        6 &#x3D;&gt; &#39;attachment&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1528</span></pre></td><td class="code"><pre><span class="line">        7 &#x3D;&gt; 0</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1529</span></pre></td><td class="code"><pre><span class="line">      );</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1530</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1531</span></pre></td><td class="code"><pre><span class="line">    &#125; catch (phpmailerException $e) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1532</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;SetError($e-&gt;getMessage());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1533</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;exceptions) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1534</span></pre></td><td class="code"><pre><span class="line">        throw $e;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1535</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1536</span></pre></td><td class="code"><pre><span class="line">      if ($this-&gt;SMTPDebug) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1537</span></pre></td><td class="code"><pre><span class="line">        echo $e-&gt;getMessage().&quot;\n&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1538</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1539</span></pre></td><td class="code"><pre><span class="line">      if ( $e-&gt;getCode() &#x3D;&#x3D; self::STOP_CRITICAL ) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1540</span></pre></td><td class="code"><pre><span class="line">        return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1541</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1542</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1543</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1544</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1545</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1546</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1547</span></pre></td><td class="code"><pre><span class="line">  * Return the current array of attachments</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1548</span></pre></td><td class="code"><pre><span class="line">  * @return array</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1549</span></pre></td><td class="code"><pre><span class="line">  *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1550</span></pre></td><td class="code"><pre><span class="line">  public function GetAttachments() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1551</span></pre></td><td class="code"><pre><span class="line">    return $this-&gt;attachment;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1552</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1553</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1554</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1555</span></pre></td><td class="code"><pre><span class="line">   * Attaches all fs, string, and binary attachments to the message.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1556</span></pre></td><td class="code"><pre><span class="line">   * Returns an empty string on failure.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1557</span></pre></td><td class="code"><pre><span class="line">   * @access protected</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1558</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1559</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1560</span></pre></td><td class="code"><pre><span class="line">  protected function AttachAll($disposition_type, $boundary) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1561</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Return text of body</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1562</span></pre></td><td class="code"><pre><span class="line">    $mime &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1563</span></pre></td><td class="code"><pre><span class="line">    $cidUniq &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1564</span></pre></td><td class="code"><pre><span class="line">    $incl &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1565</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1566</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Add all attachments</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1567</span></pre></td><td class="code"><pre><span class="line">    foreach ($this-&gt;attachment as $attachment) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1568</span></pre></td><td class="code"><pre><span class="line">      &#x2F;&#x2F; CHECK IF IT IS A VALID DISPOSITION_FILTER</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1569</span></pre></td><td class="code"><pre><span class="line">      if($attachment[6] &#x3D;&#x3D; $disposition_type) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1570</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; Check for string attachment</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1571</span></pre></td><td class="code"><pre><span class="line">        $bString &#x3D; $attachment[5];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1572</span></pre></td><td class="code"><pre><span class="line">        if ($bString) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1573</span></pre></td><td class="code"><pre><span class="line">          $string &#x3D; $attachment[0];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1574</span></pre></td><td class="code"><pre><span class="line">        &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1575</span></pre></td><td class="code"><pre><span class="line">          $path &#x3D; $attachment[0];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1576</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1577</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1578</span></pre></td><td class="code"><pre><span class="line">        $inclhash &#x3D; md5(serialize($attachment));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1579</span></pre></td><td class="code"><pre><span class="line">        if (in_array($inclhash, $incl)) &#123; continue; &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1580</span></pre></td><td class="code"><pre><span class="line">        $incl[]      &#x3D; $inclhash;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1581</span></pre></td><td class="code"><pre><span class="line">        $filename    &#x3D; $attachment[1];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1582</span></pre></td><td class="code"><pre><span class="line">        $name        &#x3D; $attachment[2];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1583</span></pre></td><td class="code"><pre><span class="line">        $encoding    &#x3D; $attachment[3];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1584</span></pre></td><td class="code"><pre><span class="line">        $type        &#x3D; $attachment[4];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1585</span></pre></td><td class="code"><pre><span class="line">        $disposition &#x3D; $attachment[6];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1586</span></pre></td><td class="code"><pre><span class="line">        $cid         &#x3D; $attachment[7];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1587</span></pre></td><td class="code"><pre><span class="line">        if ( $disposition &#x3D;&#x3D; &#39;inline&#39; &amp;&amp; isset($cidUniq[$cid]) ) &#123; continue; &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1588</span></pre></td><td class="code"><pre><span class="line">        $cidUniq[$cid] &#x3D; true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1589</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1590</span></pre></td><td class="code"><pre><span class="line">        $mime[] &#x3D; sprintf(&quot;--%s%s&quot;, $boundary, $this-&gt;LE);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1591</span></pre></td><td class="code"><pre><span class="line">        $mime[] &#x3D; sprintf(&quot;Content-Type: %s; name&#x3D;\&quot;%s\&quot;%s&quot;, $type, $this-&gt;EncodeHeader($this-&gt;SecureHeader($name)), $this-&gt;LE);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1592</span></pre></td><td class="code"><pre><span class="line">        $mime[] &#x3D; sprintf(&quot;Content-Transfer-Encoding: %s%s&quot;, $encoding, $this-&gt;LE);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1593</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1594</span></pre></td><td class="code"><pre><span class="line">        if($disposition &#x3D;&#x3D; &#39;inline&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1595</span></pre></td><td class="code"><pre><span class="line">          $mime[] &#x3D; sprintf(&quot;Content-ID: &lt;%s&gt;%s&quot;, $cid, $this-&gt;LE);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1596</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1597</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1598</span></pre></td><td class="code"><pre><span class="line">        $mime[] &#x3D; sprintf(&quot;Content-Disposition: %s; filename&#x3D;\&quot;%s\&quot;%s&quot;, $disposition, $this-&gt;EncodeHeader($this-&gt;SecureHeader($name)), $this-&gt;LE.$this-&gt;LE);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1599</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1600</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; Encode as string attachment</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1601</span></pre></td><td class="code"><pre><span class="line">        if($bString) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1602</span></pre></td><td class="code"><pre><span class="line">          $mime[] &#x3D; $this-&gt;EncodeString($string, $encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1603</span></pre></td><td class="code"><pre><span class="line">          if($this-&gt;IsError()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1604</span></pre></td><td class="code"><pre><span class="line">            return &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1605</span></pre></td><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1606</span></pre></td><td class="code"><pre><span class="line">          $mime[] &#x3D; $this-&gt;LE.$this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1607</span></pre></td><td class="code"><pre><span class="line">        &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1608</span></pre></td><td class="code"><pre><span class="line">          $mime[] &#x3D; $this-&gt;EncodeFile($path, $encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1609</span></pre></td><td class="code"><pre><span class="line">          if($this-&gt;IsError()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1610</span></pre></td><td class="code"><pre><span class="line">            return &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1611</span></pre></td><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1612</span></pre></td><td class="code"><pre><span class="line">          $mime[] &#x3D; $this-&gt;LE.$this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1613</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1614</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1615</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1616</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1617</span></pre></td><td class="code"><pre><span class="line">    $mime[] &#x3D; sprintf(&quot;--%s--%s&quot;, $boundary, $this-&gt;LE);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1618</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1619</span></pre></td><td class="code"><pre><span class="line">    return implode(&quot;&quot;, $mime);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1620</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1621</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1622</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1623</span></pre></td><td class="code"><pre><span class="line">   * Encodes attachment in requested format.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1624</span></pre></td><td class="code"><pre><span class="line">   * Returns an empty string on failure.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1625</span></pre></td><td class="code"><pre><span class="line">   * @param string $path The full path to the file</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1626</span></pre></td><td class="code"><pre><span class="line">   * @param string $encoding The encoding to use; one of &#39;base64&#39;, &#39;7bit&#39;, &#39;8bit&#39;, &#39;binary&#39;, &#39;quoted-printable&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1627</span></pre></td><td class="code"><pre><span class="line">   * @see EncodeFile()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1628</span></pre></td><td class="code"><pre><span class="line">   * @access protected</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1629</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1630</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1631</span></pre></td><td class="code"><pre><span class="line">  protected function EncodeFile($path, $encoding &#x3D; &#39;base64&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1632</span></pre></td><td class="code"><pre><span class="line">    try &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1633</span></pre></td><td class="code"><pre><span class="line">      if (!is_readable($path)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1634</span></pre></td><td class="code"><pre><span class="line">        throw new phpmailerException($this-&gt;Lang(&#39;file_open&#39;) . $path, self::STOP_CONTINUE);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1635</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1636</span></pre></td><td class="code"><pre><span class="line">      if (function_exists(&#39;get_magic_quotes&#39;)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1637</span></pre></td><td class="code"><pre><span class="line">        function get_magic_quotes() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1638</span></pre></td><td class="code"><pre><span class="line">          return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1639</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1640</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1641</span></pre></td><td class="code"><pre><span class="line">      $magic_quotes &#x3D; get_magic_quotes_runtime();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1642</span></pre></td><td class="code"><pre><span class="line">      if ($magic_quotes) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1643</span></pre></td><td class="code"><pre><span class="line">        if (version_compare(PHP_VERSION, &#39;5.3.0&#39;, &#39;&lt;&#39;)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1644</span></pre></td><td class="code"><pre><span class="line">          set_magic_quotes_runtime(0);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1645</span></pre></td><td class="code"><pre><span class="line">        &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1646</span></pre></td><td class="code"><pre><span class="line">          ini_set(&#39;magic_quotes_runtime&#39;, 0); </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1647</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1648</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1649</span></pre></td><td class="code"><pre><span class="line">      $file_buffer  &#x3D; file_get_contents($path);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1650</span></pre></td><td class="code"><pre><span class="line">      $file_buffer  &#x3D; $this-&gt;EncodeString($file_buffer, $encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1651</span></pre></td><td class="code"><pre><span class="line">      if ($magic_quotes) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1652</span></pre></td><td class="code"><pre><span class="line">        if (version_compare(PHP_VERSION, &#39;5.3.0&#39;, &#39;&lt;&#39;)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1653</span></pre></td><td class="code"><pre><span class="line">          set_magic_quotes_runtime($magic_quotes);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1654</span></pre></td><td class="code"><pre><span class="line">        &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1655</span></pre></td><td class="code"><pre><span class="line">          ini_set(&#39;magic_quotes_runtime&#39;, $magic_quotes); </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1656</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1657</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1658</span></pre></td><td class="code"><pre><span class="line">      return $file_buffer;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1659</span></pre></td><td class="code"><pre><span class="line">    &#125; catch (Exception $e) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1660</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;SetError($e-&gt;getMessage());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1661</span></pre></td><td class="code"><pre><span class="line">      return &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1662</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1663</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1664</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1665</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1666</span></pre></td><td class="code"><pre><span class="line">   * Encodes string to requested format.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1667</span></pre></td><td class="code"><pre><span class="line">   * Returns an empty string on failure.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1668</span></pre></td><td class="code"><pre><span class="line">   * @param string $str The text to encode</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1669</span></pre></td><td class="code"><pre><span class="line">   * @param string $encoding The encoding to use; one of &#39;base64&#39;, &#39;7bit&#39;, &#39;8bit&#39;, &#39;binary&#39;, &#39;quoted-printable&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1670</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1671</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1672</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1673</span></pre></td><td class="code"><pre><span class="line">  public function EncodeString($str, $encoding &#x3D; &#39;base64&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1674</span></pre></td><td class="code"><pre><span class="line">    $encoded &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1675</span></pre></td><td class="code"><pre><span class="line">    switch(strtolower($encoding)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1676</span></pre></td><td class="code"><pre><span class="line">      case &#39;base64&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1677</span></pre></td><td class="code"><pre><span class="line">        $encoded &#x3D; chunk_split(base64_encode($str), 76, $this-&gt;LE);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1678</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1679</span></pre></td><td class="code"><pre><span class="line">      case &#39;7bit&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1680</span></pre></td><td class="code"><pre><span class="line">      case &#39;8bit&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1681</span></pre></td><td class="code"><pre><span class="line">        $encoded &#x3D; $this-&gt;FixEOL($str);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1682</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F;Make sure it ends with a line break</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1683</span></pre></td><td class="code"><pre><span class="line">        if (substr($encoded, -(strlen($this-&gt;LE))) !&#x3D; $this-&gt;LE)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1684</span></pre></td><td class="code"><pre><span class="line">          $encoded .&#x3D; $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1685</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1686</span></pre></td><td class="code"><pre><span class="line">      case &#39;binary&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1687</span></pre></td><td class="code"><pre><span class="line">        $encoded &#x3D; $str;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1688</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1689</span></pre></td><td class="code"><pre><span class="line">      case &#39;quoted-printable&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1690</span></pre></td><td class="code"><pre><span class="line">        $encoded &#x3D; $this-&gt;EncodeQP($str);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1691</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1692</span></pre></td><td class="code"><pre><span class="line">      default:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1693</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;SetError($this-&gt;Lang(&#39;encoding&#39;) . $encoding);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1694</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1695</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1696</span></pre></td><td class="code"><pre><span class="line">    return $encoded;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1697</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1698</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1699</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1700</span></pre></td><td class="code"><pre><span class="line">   * Encode a header string to best (shortest) of Q, B, quoted or none.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1701</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1702</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1703</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1704</span></pre></td><td class="code"><pre><span class="line">  public function EncodeHeader($str, $position &#x3D; &#39;text&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1705</span></pre></td><td class="code"><pre><span class="line">    $x &#x3D; 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1706</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1707</span></pre></td><td class="code"><pre><span class="line">    switch (strtolower($position)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1708</span></pre></td><td class="code"><pre><span class="line">      case &#39;phrase&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1709</span></pre></td><td class="code"><pre><span class="line">        if (!preg_match(&#39;&#x2F;[\200-\377]&#x2F;&#39;, $str)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1710</span></pre></td><td class="code"><pre><span class="line">          &#x2F;&#x2F; Can&#39;t use addslashes as we don&#39;t know what value has magic_quotes_sybase</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1711</span></pre></td><td class="code"><pre><span class="line">          $encoded &#x3D; addcslashes($str, &quot;\0..\37\177\\\&quot;&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1712</span></pre></td><td class="code"><pre><span class="line">          if (($str &#x3D;&#x3D; $encoded) &amp;&amp; !preg_match(&#39;&#x2F;[^A-Za-z0-9!#$%&amp;\&#39;*+\&#x2F;&#x3D;?^_&#96;&#123;|&#125;~ -]&#x2F;&#39;, $str)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1713</span></pre></td><td class="code"><pre><span class="line">            return ($encoded);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1714</span></pre></td><td class="code"><pre><span class="line">          &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1715</span></pre></td><td class="code"><pre><span class="line">            return (&quot;\&quot;$encoded\&quot;&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1716</span></pre></td><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1717</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1718</span></pre></td><td class="code"><pre><span class="line">        $x &#x3D; preg_match_all(&#39;&#x2F;[^\040\041\043-\133\135-\176]&#x2F;&#39;, $str, $matches);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1719</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1720</span></pre></td><td class="code"><pre><span class="line">      case &#39;comment&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1721</span></pre></td><td class="code"><pre><span class="line">        $x &#x3D; preg_match_all(&#39;&#x2F;[()&quot;]&#x2F;&#39;, $str, $matches);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1722</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; Fall-through</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1723</span></pre></td><td class="code"><pre><span class="line">      case &#39;text&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1724</span></pre></td><td class="code"><pre><span class="line">      default:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1725</span></pre></td><td class="code"><pre><span class="line">        $x +&#x3D; preg_match_all(&#39;&#x2F;[\000-\010\013\014\016-\037\177-\377]&#x2F;&#39;, $str, $matches);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1726</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1727</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1728</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1729</span></pre></td><td class="code"><pre><span class="line">    if ($x &#x3D;&#x3D; 0) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1730</span></pre></td><td class="code"><pre><span class="line">      return ($str);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1731</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1732</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1733</span></pre></td><td class="code"><pre><span class="line">    $maxlen &#x3D; 75 - 7 - strlen($this-&gt;CharSet);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1734</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Try to select the encoding which should produce the shortest output</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1735</span></pre></td><td class="code"><pre><span class="line">    if (strlen($str)&#x2F;3 &lt; $x) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1736</span></pre></td><td class="code"><pre><span class="line">      $encoding &#x3D; &#39;B&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1737</span></pre></td><td class="code"><pre><span class="line">      if (function_exists(&#39;mb_strlen&#39;) &amp;&amp; $this-&gt;HasMultiBytes($str)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1738</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; Use a custom function which correctly encodes and wraps long</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1739</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; multibyte strings without breaking lines within a character</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1740</span></pre></td><td class="code"><pre><span class="line">        $encoded &#x3D; $this-&gt;Base64EncodeWrapMB($str);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1741</span></pre></td><td class="code"><pre><span class="line">      &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1742</span></pre></td><td class="code"><pre><span class="line">        $encoded &#x3D; base64_encode($str);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1743</span></pre></td><td class="code"><pre><span class="line">        $maxlen -&#x3D; $maxlen % 4;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1744</span></pre></td><td class="code"><pre><span class="line">        $encoded &#x3D; trim(chunk_split($encoded, $maxlen, &quot;\n&quot;));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1745</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1746</span></pre></td><td class="code"><pre><span class="line">    &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1747</span></pre></td><td class="code"><pre><span class="line">      $encoding &#x3D; &#39;Q&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1748</span></pre></td><td class="code"><pre><span class="line">      $encoded &#x3D; $this-&gt;EncodeQ($str, $position);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1749</span></pre></td><td class="code"><pre><span class="line">      $encoded &#x3D; $this-&gt;WrapText($encoded, $maxlen, true);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1750</span></pre></td><td class="code"><pre><span class="line">      $encoded &#x3D; str_replace(&#39;&#x3D;&#39;.$this-&gt;LE, &quot;\n&quot;, trim($encoded));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1751</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1752</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1753</span></pre></td><td class="code"><pre><span class="line">    $encoded &#x3D; preg_replace(&#39;&#x2F;^(.*)$&#x2F;m&#39;, &quot; &#x3D;?&quot;.$this-&gt;CharSet.&quot;?$encoding?\\1?&#x3D;&quot;, $encoded);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1754</span></pre></td><td class="code"><pre><span class="line">    $encoded &#x3D; trim(str_replace(&quot;\n&quot;, $this-&gt;LE, $encoded));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1755</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1756</span></pre></td><td class="code"><pre><span class="line">    return $encoded;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1757</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1758</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1759</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1760</span></pre></td><td class="code"><pre><span class="line">   * Checks if a string contains multibyte characters.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1761</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1762</span></pre></td><td class="code"><pre><span class="line">   * @param string $str multi-byte text to wrap encode</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1763</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1764</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1765</span></pre></td><td class="code"><pre><span class="line">  public function HasMultiBytes($str) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1766</span></pre></td><td class="code"><pre><span class="line">    if (function_exists(&#39;mb_strlen&#39;)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1767</span></pre></td><td class="code"><pre><span class="line">      return (strlen($str) &gt; mb_strlen($str, $this-&gt;CharSet));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1768</span></pre></td><td class="code"><pre><span class="line">    &#125; else &#123; &#x2F;&#x2F; Assume no multibytes (we can&#39;t handle without mbstring functions anyway)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1769</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1770</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1771</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1772</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1773</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1774</span></pre></td><td class="code"><pre><span class="line">   * Correctly encodes and wraps long multibyte strings for mail headers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1775</span></pre></td><td class="code"><pre><span class="line">   * without breaking lines within a character.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1776</span></pre></td><td class="code"><pre><span class="line">   * Adapted from a function by paravoid at http:&#x2F;&#x2F;uk.php.net&#x2F;manual&#x2F;en&#x2F;function.mb-encode-mimeheader.php</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1777</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1778</span></pre></td><td class="code"><pre><span class="line">   * @param string $str multi-byte text to wrap encode</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1779</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1780</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1781</span></pre></td><td class="code"><pre><span class="line">  public function Base64EncodeWrapMB($str) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1782</span></pre></td><td class="code"><pre><span class="line">    $start &#x3D; &quot;&#x3D;?&quot;.$this-&gt;CharSet.&quot;?B?&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1783</span></pre></td><td class="code"><pre><span class="line">    $end &#x3D; &quot;?&#x3D;&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1784</span></pre></td><td class="code"><pre><span class="line">    $encoded &#x3D; &quot;&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1785</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1786</span></pre></td><td class="code"><pre><span class="line">    $mb_length &#x3D; mb_strlen($str, $this-&gt;CharSet);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1787</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Each line must have length &lt;&#x3D; 75, including $start and $end</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1788</span></pre></td><td class="code"><pre><span class="line">    $length &#x3D; 75 - strlen($start) - strlen($end);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1789</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Average multi-byte ratio</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1790</span></pre></td><td class="code"><pre><span class="line">    $ratio &#x3D; $mb_length &#x2F; strlen($str);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1791</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Base64 has a 4:3 ratio</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1792</span></pre></td><td class="code"><pre><span class="line">    $offset &#x3D; $avgLength &#x3D; floor($length * $ratio * .75);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1793</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1794</span></pre></td><td class="code"><pre><span class="line">    for ($i &#x3D; 0; $i &lt; $mb_length; $i +&#x3D; $offset) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1795</span></pre></td><td class="code"><pre><span class="line">      $lookBack &#x3D; 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1796</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1797</span></pre></td><td class="code"><pre><span class="line">      do &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1798</span></pre></td><td class="code"><pre><span class="line">        $offset &#x3D; $avgLength - $lookBack;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1799</span></pre></td><td class="code"><pre><span class="line">        $chunk &#x3D; mb_substr($str, $i, $offset, $this-&gt;CharSet);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1800</span></pre></td><td class="code"><pre><span class="line">        $chunk &#x3D; base64_encode($chunk);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1801</span></pre></td><td class="code"><pre><span class="line">        $lookBack++;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1802</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1803</span></pre></td><td class="code"><pre><span class="line">      while (strlen($chunk) &gt; $length);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1804</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1805</span></pre></td><td class="code"><pre><span class="line">      $encoded .&#x3D; $chunk . $this-&gt;LE;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1806</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1807</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1808</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Chomp the last linefeed</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1809</span></pre></td><td class="code"><pre><span class="line">    $encoded &#x3D; substr($encoded, 0, -strlen($this-&gt;LE));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1810</span></pre></td><td class="code"><pre><span class="line">    return $encoded;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1811</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1812</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1813</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1814</span></pre></td><td class="code"><pre><span class="line">  * Encode string to quoted-printable.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1815</span></pre></td><td class="code"><pre><span class="line">  * Only uses standard PHP, slow, but will always work</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1816</span></pre></td><td class="code"><pre><span class="line">  * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1817</span></pre></td><td class="code"><pre><span class="line">  * @param string $string the text to encode</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1818</span></pre></td><td class="code"><pre><span class="line">  * @param integer $line_max Number of chars allowed on a line before wrapping</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1819</span></pre></td><td class="code"><pre><span class="line">  * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1820</span></pre></td><td class="code"><pre><span class="line">  *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1821</span></pre></td><td class="code"><pre><span class="line">  public function EncodeQPphp( $input &#x3D; &#39;&#39;, $line_max &#x3D; 76, $space_conv &#x3D; false) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1822</span></pre></td><td class="code"><pre><span class="line">    $hex &#x3D; array(&#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;, &#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, &#39;F&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1823</span></pre></td><td class="code"><pre><span class="line">    $lines &#x3D; preg_split(&#39;&#x2F;(?:\r\n|\r|\n)&#x2F;&#39;, $input);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1824</span></pre></td><td class="code"><pre><span class="line">    $eol &#x3D; &quot;\r\n&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1825</span></pre></td><td class="code"><pre><span class="line">    $escape &#x3D; &#39;&#x3D;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1826</span></pre></td><td class="code"><pre><span class="line">    $output &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1827</span></pre></td><td class="code"><pre><span class="line">    while( list(, $line) &#x3D; each($lines) ) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1828</span></pre></td><td class="code"><pre><span class="line">      $linlen &#x3D; strlen($line);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1829</span></pre></td><td class="code"><pre><span class="line">      $newline &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1830</span></pre></td><td class="code"><pre><span class="line">      for($i &#x3D; 0; $i &lt; $linlen; $i++) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1831</span></pre></td><td class="code"><pre><span class="line">        $c &#x3D; substr( $line, $i, 1 );</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1832</span></pre></td><td class="code"><pre><span class="line">        $dec &#x3D; ord( $c );</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1833</span></pre></td><td class="code"><pre><span class="line">        if ( ( $i &#x3D;&#x3D; 0 ) &amp;&amp; ( $dec &#x3D;&#x3D; 46 ) ) &#123; &#x2F;&#x2F; convert first point in the line into &#x3D;2E</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1834</span></pre></td><td class="code"><pre><span class="line">          $c &#x3D; &#39;&#x3D;2E&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1835</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1836</span></pre></td><td class="code"><pre><span class="line">        if ( $dec &#x3D;&#x3D; 32 ) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1837</span></pre></td><td class="code"><pre><span class="line">          if ( $i &#x3D;&#x3D; ( $linlen - 1 ) ) &#123; &#x2F;&#x2F; convert space at eol only</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1838</span></pre></td><td class="code"><pre><span class="line">            $c &#x3D; &#39;&#x3D;20&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1839</span></pre></td><td class="code"><pre><span class="line">          &#125; else if ( $space_conv ) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1840</span></pre></td><td class="code"><pre><span class="line">            $c &#x3D; &#39;&#x3D;20&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1841</span></pre></td><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1842</span></pre></td><td class="code"><pre><span class="line">        &#125; elseif ( ($dec &#x3D;&#x3D; 61) || ($dec &lt; 32 ) || ($dec &gt; 126) ) &#123; &#x2F;&#x2F; always encode &quot;\t&quot;, which is *not* required</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1843</span></pre></td><td class="code"><pre><span class="line">          $h2 &#x3D; floor($dec&#x2F;16);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1844</span></pre></td><td class="code"><pre><span class="line">          $h1 &#x3D; floor($dec%16);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1845</span></pre></td><td class="code"><pre><span class="line">          $c &#x3D; $escape.$hex[$h2].$hex[$h1];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1846</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1847</span></pre></td><td class="code"><pre><span class="line">        if ( (strlen($newline) + strlen($c)) &gt;&#x3D; $line_max ) &#123; &#x2F;&#x2F; CRLF is not counted</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1848</span></pre></td><td class="code"><pre><span class="line">          $output .&#x3D; $newline.$escape.$eol; &#x2F;&#x2F;  soft line break; &quot; &#x3D;\r\n&quot; is okay</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1849</span></pre></td><td class="code"><pre><span class="line">          $newline &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1850</span></pre></td><td class="code"><pre><span class="line">          &#x2F;&#x2F; check if newline first character will be point or not</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1851</span></pre></td><td class="code"><pre><span class="line">          if ( $dec &#x3D;&#x3D; 46 ) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1852</span></pre></td><td class="code"><pre><span class="line">            $c &#x3D; &#39;&#x3D;2E&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1853</span></pre></td><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1854</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1855</span></pre></td><td class="code"><pre><span class="line">        $newline .&#x3D; $c;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1856</span></pre></td><td class="code"><pre><span class="line">      &#125; &#x2F;&#x2F; end of for</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1857</span></pre></td><td class="code"><pre><span class="line">      $output .&#x3D; $newline.$eol;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1858</span></pre></td><td class="code"><pre><span class="line">    &#125; &#x2F;&#x2F; end of while</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1859</span></pre></td><td class="code"><pre><span class="line">    return $output;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1860</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1861</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1862</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1863</span></pre></td><td class="code"><pre><span class="line">  * Encode string to RFC2045 (6.7) quoted-printable format</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1864</span></pre></td><td class="code"><pre><span class="line">  * Uses a PHP5 stream filter to do the encoding about 64x faster than the old version</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1865</span></pre></td><td class="code"><pre><span class="line">  * Also results in same content as you started with after decoding</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1866</span></pre></td><td class="code"><pre><span class="line">  * @see EncodeQPphp()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1867</span></pre></td><td class="code"><pre><span class="line">  * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1868</span></pre></td><td class="code"><pre><span class="line">  * @param string $string the text to encode</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1869</span></pre></td><td class="code"><pre><span class="line">  * @param integer $line_max Number of chars allowed on a line before wrapping</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1870</span></pre></td><td class="code"><pre><span class="line">  * @param boolean $space_conv Dummy param for compatibility with existing EncodeQP function</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1871</span></pre></td><td class="code"><pre><span class="line">  * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1872</span></pre></td><td class="code"><pre><span class="line">  * @author Marcus Bointon</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1873</span></pre></td><td class="code"><pre><span class="line">  *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1874</span></pre></td><td class="code"><pre><span class="line">  public function EncodeQP($string, $line_max &#x3D; 76, $space_conv &#x3D; false) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1875</span></pre></td><td class="code"><pre><span class="line">    if (function_exists(&#39;quoted_printable_encode&#39;)) &#123; &#x2F;&#x2F;Use native function if it&#39;s available (&gt;&#x3D; PHP5.3)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1876</span></pre></td><td class="code"><pre><span class="line">      return quoted_printable_encode($string);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1877</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1878</span></pre></td><td class="code"><pre><span class="line">    $filters &#x3D; stream_get_filters();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1879</span></pre></td><td class="code"><pre><span class="line">    if (!in_array(&#39;convert.*&#39;, $filters)) &#123; &#x2F;&#x2F;Got convert stream filter?</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1880</span></pre></td><td class="code"><pre><span class="line">      return $this-&gt;EncodeQPphp($string, $line_max, $space_conv); &#x2F;&#x2F;Fall back to old implementation</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1881</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1882</span></pre></td><td class="code"><pre><span class="line">    $fp &#x3D; fopen(&#39;php:&#x2F;&#x2F;temp&#x2F;&#39;, &#39;r+&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1883</span></pre></td><td class="code"><pre><span class="line">    $string &#x3D; preg_replace(&#39;&#x2F;\r\n?&#x2F;&#39;, $this-&gt;LE, $string); &#x2F;&#x2F;Normalise line breaks</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1884</span></pre></td><td class="code"><pre><span class="line">    $params &#x3D; array(&#39;line-length&#39; &#x3D;&gt; $line_max, &#39;line-break-chars&#39; &#x3D;&gt; $this-&gt;LE);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1885</span></pre></td><td class="code"><pre><span class="line">    $s &#x3D; stream_filter_append($fp, &#39;convert.quoted-printable-encode&#39;, STREAM_FILTER_READ, $params);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1886</span></pre></td><td class="code"><pre><span class="line">    fputs($fp, $string);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1887</span></pre></td><td class="code"><pre><span class="line">    rewind($fp);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1888</span></pre></td><td class="code"><pre><span class="line">    $out &#x3D; stream_get_contents($fp);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1889</span></pre></td><td class="code"><pre><span class="line">    stream_filter_remove($s);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1890</span></pre></td><td class="code"><pre><span class="line">    $out &#x3D; preg_replace(&#39;&#x2F;^\.&#x2F;m&#39;, &#39;&#x3D;2E&#39;, $out); &#x2F;&#x2F;Encode . if it is first char on a line, workaround for bug in Exchange</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1891</span></pre></td><td class="code"><pre><span class="line">    fclose($fp);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1892</span></pre></td><td class="code"><pre><span class="line">    return $out;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1893</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1894</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1895</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1896</span></pre></td><td class="code"><pre><span class="line">   * Encode string to q encoding.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1897</span></pre></td><td class="code"><pre><span class="line">   * @link http:&#x2F;&#x2F;tools.ietf.org&#x2F;html&#x2F;rfc2047</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1898</span></pre></td><td class="code"><pre><span class="line">   * @param string $str the text to encode</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1899</span></pre></td><td class="code"><pre><span class="line">   * @param string $position Where the text is going to be used, see the RFC for what that means</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1900</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1901</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1902</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1903</span></pre></td><td class="code"><pre><span class="line">  public function EncodeQ($str, $position &#x3D; &#39;text&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1904</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; There should not be any EOL in the string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1905</span></pre></td><td class="code"><pre><span class="line">    $encoded &#x3D; preg_replace(&#39;&#x2F;[\r\n]*&#x2F;&#39;, &#39;&#39;, $str);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1906</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1907</span></pre></td><td class="code"><pre><span class="line">    switch (strtolower($position)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1908</span></pre></td><td class="code"><pre><span class="line">      case &#39;phrase&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1909</span></pre></td><td class="code"><pre><span class="line">        $encoded &#x3D; preg_replace(&quot;&#x2F;([^A-Za-z0-9!*+\&#x2F; -])&#x2F;e&quot;, &quot;&#39;&#x3D;&#39;.sprintf(&#39;%02X&#39;, ord(&#39;\\1&#39;))&quot;, $encoded);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1910</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1911</span></pre></td><td class="code"><pre><span class="line">      case &#39;comment&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1912</span></pre></td><td class="code"><pre><span class="line">        $encoded &#x3D; preg_replace(&quot;&#x2F;([\(\)\&quot;])&#x2F;e&quot;, &quot;&#39;&#x3D;&#39;.sprintf(&#39;%02X&#39;, ord(&#39;\\1&#39;))&quot;, $encoded);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1913</span></pre></td><td class="code"><pre><span class="line">      case &#39;text&#39;:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1914</span></pre></td><td class="code"><pre><span class="line">      default:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1915</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; Replace every high ascii, control &#x3D;, ? and _ characters</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1916</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F;TODO using &#x2F;e (equivalent to eval()) is probably not a good idea</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1917</span></pre></td><td class="code"><pre><span class="line">        $encoded &#x3D; preg_replace(&#39;&#x2F;([\000-\011\013\014\016-\037\075\077\137\177-\377])&#x2F;e&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1918</span></pre></td><td class="code"><pre><span class="line">                                &quot;&#39;&#x3D;&#39;.sprintf(&#39;%02X&#39;, ord(stripslashes(&#39;\\1&#39;)))&quot;, $encoded);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1919</span></pre></td><td class="code"><pre><span class="line">        break;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1920</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1921</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1922</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Replace every spaces to _ (more readable than &#x3D;20)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1923</span></pre></td><td class="code"><pre><span class="line">    $encoded &#x3D; str_replace(&#39; &#39;, &#39;_&#39;, $encoded);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1924</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1925</span></pre></td><td class="code"><pre><span class="line">    return $encoded;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1926</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1927</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1928</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1929</span></pre></td><td class="code"><pre><span class="line">   * Adds a string or binary attachment (non-filesystem) to the list.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1930</span></pre></td><td class="code"><pre><span class="line">   * This method can be used to attach ascii or binary data,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1931</span></pre></td><td class="code"><pre><span class="line">   * such as a BLOB record from a database.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1932</span></pre></td><td class="code"><pre><span class="line">   * @param string $string String attachment data.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1933</span></pre></td><td class="code"><pre><span class="line">   * @param string $filename Name of the attachment.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1934</span></pre></td><td class="code"><pre><span class="line">   * @param string $encoding File encoding (see $Encoding).</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1935</span></pre></td><td class="code"><pre><span class="line">   * @param string $type File extension (MIME) type.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1936</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1937</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1938</span></pre></td><td class="code"><pre><span class="line">  public function AddStringAttachment($string, $filename, $encoding &#x3D; &#39;base64&#39;, $type &#x3D; &#39;application&#x2F;octet-stream&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1939</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Append to $attachment array</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1940</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;attachment[] &#x3D; array(</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1941</span></pre></td><td class="code"><pre><span class="line">      0 &#x3D;&gt; $string,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1942</span></pre></td><td class="code"><pre><span class="line">      1 &#x3D;&gt; $filename,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1943</span></pre></td><td class="code"><pre><span class="line">      2 &#x3D;&gt; basename($filename),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1944</span></pre></td><td class="code"><pre><span class="line">      3 &#x3D;&gt; $encoding,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1945</span></pre></td><td class="code"><pre><span class="line">      4 &#x3D;&gt; $type,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1946</span></pre></td><td class="code"><pre><span class="line">      5 &#x3D;&gt; true,  &#x2F;&#x2F; isStringAttachment</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1947</span></pre></td><td class="code"><pre><span class="line">      6 &#x3D;&gt; &#39;attachment&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1948</span></pre></td><td class="code"><pre><span class="line">      7 &#x3D;&gt; 0</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1949</span></pre></td><td class="code"><pre><span class="line">    );</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1950</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1951</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1952</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1953</span></pre></td><td class="code"><pre><span class="line">   * Adds an embedded attachment.  This can include images, sounds, and</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1954</span></pre></td><td class="code"><pre><span class="line">   * just about any other document.  Make sure to set the $type to an</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1955</span></pre></td><td class="code"><pre><span class="line">   * image type.  For JPEG images use &quot;image&#x2F;jpeg&quot; and for GIF images</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1956</span></pre></td><td class="code"><pre><span class="line">   * use &quot;image&#x2F;gif&quot;.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1957</span></pre></td><td class="code"><pre><span class="line">   * @param string $path Path to the attachment.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1958</span></pre></td><td class="code"><pre><span class="line">   * @param string $cid Content ID of the attachment.  Use this to identify</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1959</span></pre></td><td class="code"><pre><span class="line">   *        the Id for accessing the image in an HTML form.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1960</span></pre></td><td class="code"><pre><span class="line">   * @param string $name Overrides the attachment name.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1961</span></pre></td><td class="code"><pre><span class="line">   * @param string $encoding File encoding (see $Encoding).</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1962</span></pre></td><td class="code"><pre><span class="line">   * @param string $type File extension (MIME) type.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1963</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1964</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1965</span></pre></td><td class="code"><pre><span class="line">  public function AddEmbeddedImage($path, $cid, $name &#x3D; &#39;&#39;, $encoding &#x3D; &#39;base64&#39;, $type &#x3D; &#39;application&#x2F;octet-stream&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1966</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1967</span></pre></td><td class="code"><pre><span class="line">    if ( !@is_file($path) ) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1968</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;SetError($this-&gt;Lang(&#39;file_access&#39;) . $path);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1969</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1970</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1971</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1972</span></pre></td><td class="code"><pre><span class="line">    $filename &#x3D; basename($path);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1973</span></pre></td><td class="code"><pre><span class="line">    if ( $name &#x3D;&#x3D; &#39;&#39; ) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1974</span></pre></td><td class="code"><pre><span class="line">      $name &#x3D; $filename;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1975</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1976</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1977</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Append to $attachment array</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1978</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;attachment[] &#x3D; array(</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1979</span></pre></td><td class="code"><pre><span class="line">      0 &#x3D;&gt; $path,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1980</span></pre></td><td class="code"><pre><span class="line">      1 &#x3D;&gt; $filename,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1981</span></pre></td><td class="code"><pre><span class="line">      2 &#x3D;&gt; $name,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1982</span></pre></td><td class="code"><pre><span class="line">      3 &#x3D;&gt; $encoding,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1983</span></pre></td><td class="code"><pre><span class="line">      4 &#x3D;&gt; $type,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1984</span></pre></td><td class="code"><pre><span class="line">      5 &#x3D;&gt; false,  &#x2F;&#x2F; isStringAttachment</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1985</span></pre></td><td class="code"><pre><span class="line">      6 &#x3D;&gt; &#39;inline&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1986</span></pre></td><td class="code"><pre><span class="line">      7 &#x3D;&gt; $cid</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1987</span></pre></td><td class="code"><pre><span class="line">    );</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1988</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1989</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1990</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1991</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1992</span></pre></td><td class="code"><pre><span class="line">  public function AddStringEmbeddedImage($string, $cid, $filename &#x3D; &#39;&#39;, $encoding &#x3D; &#39;base64&#39;, $type &#x3D; &#39;application&#x2F;octet-stream&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1993</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Append to $attachment array</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1994</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;attachment[] &#x3D; array(</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1995</span></pre></td><td class="code"><pre><span class="line">      0 &#x3D;&gt; $string,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1996</span></pre></td><td class="code"><pre><span class="line">      1 &#x3D;&gt; $filename,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1997</span></pre></td><td class="code"><pre><span class="line">      2 &#x3D;&gt; basename($filename),</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1998</span></pre></td><td class="code"><pre><span class="line">      3 &#x3D;&gt; $encoding,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">1999</span></pre></td><td class="code"><pre><span class="line">      4 &#x3D;&gt; $type,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2000</span></pre></td><td class="code"><pre><span class="line">      5 &#x3D;&gt; true,  &#x2F;&#x2F; isStringAttachment</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2001</span></pre></td><td class="code"><pre><span class="line">      6 &#x3D;&gt; &#39;inline&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2002</span></pre></td><td class="code"><pre><span class="line">      7 &#x3D;&gt; $cid</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2003</span></pre></td><td class="code"><pre><span class="line">    );</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2004</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2005</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2006</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2007</span></pre></td><td class="code"><pre><span class="line">   * Returns true if an inline attachment is present.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2008</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2009</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2010</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2011</span></pre></td><td class="code"><pre><span class="line">  public function InlineImageExists() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2012</span></pre></td><td class="code"><pre><span class="line">    foreach($this-&gt;attachment as $attachment) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2013</span></pre></td><td class="code"><pre><span class="line">      if ($attachment[6] &#x3D;&#x3D; &#39;inline&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2014</span></pre></td><td class="code"><pre><span class="line">        return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2015</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2016</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2017</span></pre></td><td class="code"><pre><span class="line">    return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2018</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2019</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2020</span></pre></td><td class="code"><pre><span class="line">  public function AttachmentExists() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2021</span></pre></td><td class="code"><pre><span class="line">    foreach($this-&gt;attachment as $attachment) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2022</span></pre></td><td class="code"><pre><span class="line">      if ($attachment[6] &#x3D;&#x3D; &#39;attachment&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2023</span></pre></td><td class="code"><pre><span class="line">        return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2024</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2025</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2026</span></pre></td><td class="code"><pre><span class="line">    return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2027</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2028</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2029</span></pre></td><td class="code"><pre><span class="line">  public function AlternativeExists() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2030</span></pre></td><td class="code"><pre><span class="line">    return strlen($this-&gt;AltBody)&gt;0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2031</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2032</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2033</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2034</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F; CLASS METHODS, MESSAGE RESET</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2035</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2036</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2037</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2038</span></pre></td><td class="code"><pre><span class="line">   * Clears all recipients assigned in the TO array.  Returns void.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2039</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2040</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2041</span></pre></td><td class="code"><pre><span class="line">  public function ClearAddresses() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2042</span></pre></td><td class="code"><pre><span class="line">    foreach($this-&gt;to as $to) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2043</span></pre></td><td class="code"><pre><span class="line">      unset($this-&gt;all_recipients[strtolower($to[0])]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2044</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2045</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;to &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2046</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2047</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2048</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2049</span></pre></td><td class="code"><pre><span class="line">   * Clears all recipients assigned in the CC array.  Returns void.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2050</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2051</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2052</span></pre></td><td class="code"><pre><span class="line">  public function ClearCCs() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2053</span></pre></td><td class="code"><pre><span class="line">    foreach($this-&gt;cc as $cc) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2054</span></pre></td><td class="code"><pre><span class="line">      unset($this-&gt;all_recipients[strtolower($cc[0])]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2055</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2056</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;cc &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2057</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2058</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2059</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2060</span></pre></td><td class="code"><pre><span class="line">   * Clears all recipients assigned in the BCC array.  Returns void.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2061</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2062</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2063</span></pre></td><td class="code"><pre><span class="line">  public function ClearBCCs() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2064</span></pre></td><td class="code"><pre><span class="line">    foreach($this-&gt;bcc as $bcc) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2065</span></pre></td><td class="code"><pre><span class="line">      unset($this-&gt;all_recipients[strtolower($bcc[0])]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2066</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2067</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;bcc &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2068</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2069</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2070</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2071</span></pre></td><td class="code"><pre><span class="line">   * Clears all recipients assigned in the ReplyTo array.  Returns void.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2072</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2073</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2074</span></pre></td><td class="code"><pre><span class="line">  public function ClearReplyTos() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2075</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;ReplyTo &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2076</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2077</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2078</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2079</span></pre></td><td class="code"><pre><span class="line">   * Clears all recipients assigned in the TO, CC and BCC</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2080</span></pre></td><td class="code"><pre><span class="line">   * array.  Returns void.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2081</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2082</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2083</span></pre></td><td class="code"><pre><span class="line">  public function ClearAllRecipients() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2084</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;to &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2085</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;cc &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2086</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;bcc &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2087</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;all_recipients &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2088</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2089</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2090</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2091</span></pre></td><td class="code"><pre><span class="line">   * Clears all previously set filesystem, string, and binary</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2092</span></pre></td><td class="code"><pre><span class="line">   * attachments.  Returns void.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2093</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2094</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2095</span></pre></td><td class="code"><pre><span class="line">  public function ClearAttachments() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2096</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;attachment &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2097</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2098</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2099</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2100</span></pre></td><td class="code"><pre><span class="line">   * Clears all custom headers.  Returns void.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2101</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2102</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2103</span></pre></td><td class="code"><pre><span class="line">  public function ClearCustomHeaders() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2104</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;CustomHeader &#x3D; array();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2105</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2106</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2107</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2108</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F; CLASS METHODS, MISCELLANEOUS</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2109</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2110</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2111</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2112</span></pre></td><td class="code"><pre><span class="line">   * Adds the error message to the error container.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2113</span></pre></td><td class="code"><pre><span class="line">   * @access protected</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2114</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2115</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2116</span></pre></td><td class="code"><pre><span class="line">  protected function SetError($msg) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2117</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;error_count++;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2118</span></pre></td><td class="code"><pre><span class="line">    if ($this-&gt;Mailer &#x3D;&#x3D; &#39;smtp&#39; and !is_null($this-&gt;smtp)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2119</span></pre></td><td class="code"><pre><span class="line">      $lasterror &#x3D; $this-&gt;smtp-&gt;getError();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2120</span></pre></td><td class="code"><pre><span class="line">      if (!empty($lasterror) and array_key_exists(&#39;smtp_msg&#39;, $lasterror)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2121</span></pre></td><td class="code"><pre><span class="line">        $msg .&#x3D; &#39;&lt;p&gt;&#39; . $this-&gt;Lang(&#39;smtp_error&#39;) . $lasterror[&#39;smtp_msg&#39;] . &quot;&lt;&#x2F;p&gt;\n&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2122</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2123</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2124</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;ErrorInfo &#x3D; $msg;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2125</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2126</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2127</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2128</span></pre></td><td class="code"><pre><span class="line">   * Returns the proper RFC 822 formatted date.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2129</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2130</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2131</span></pre></td><td class="code"><pre><span class="line">   * @static</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2132</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2133</span></pre></td><td class="code"><pre><span class="line">  public static function RFCDate() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2134</span></pre></td><td class="code"><pre><span class="line">    $tz &#x3D; date(&#39;Z&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2135</span></pre></td><td class="code"><pre><span class="line">    $tzs &#x3D; ($tz &lt; 0) ? &#39;-&#39; : &#39;+&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2136</span></pre></td><td class="code"><pre><span class="line">    $tz &#x3D; abs($tz);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2137</span></pre></td><td class="code"><pre><span class="line">    $tz &#x3D; (int)($tz&#x2F;3600)*100 + ($tz%3600)&#x2F;60;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2138</span></pre></td><td class="code"><pre><span class="line">    $result &#x3D; sprintf(&quot;%s %s%04d&quot;, date(&#39;D, j M Y H:i:s&#39;), $tzs, $tz);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2139</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2140</span></pre></td><td class="code"><pre><span class="line">    return $result;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2141</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2142</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2143</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2144</span></pre></td><td class="code"><pre><span class="line">   * Returns the server hostname or &#39;localhost.localdomain&#39; if unknown.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2145</span></pre></td><td class="code"><pre><span class="line">   * @access protected</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2146</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2147</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2148</span></pre></td><td class="code"><pre><span class="line">  protected function ServerHostname() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2149</span></pre></td><td class="code"><pre><span class="line">    if (!empty($this-&gt;Hostname)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2150</span></pre></td><td class="code"><pre><span class="line">      $result &#x3D; $this-&gt;Hostname;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2151</span></pre></td><td class="code"><pre><span class="line">    &#125; elseif (isset($_SERVER[&#39;SERVER_NAME&#39;])) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2152</span></pre></td><td class="code"><pre><span class="line">      $result &#x3D; $_SERVER[&#39;SERVER_NAME&#39;];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2153</span></pre></td><td class="code"><pre><span class="line">    &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2154</span></pre></td><td class="code"><pre><span class="line">      $result &#x3D; &#39;localhost.localdomain&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2155</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2156</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2157</span></pre></td><td class="code"><pre><span class="line">    return $result;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2158</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2159</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2160</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2161</span></pre></td><td class="code"><pre><span class="line">   * Returns a message in the appropriate language.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2162</span></pre></td><td class="code"><pre><span class="line">   * @access protected</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2163</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2164</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2165</span></pre></td><td class="code"><pre><span class="line">  protected function Lang($key) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2166</span></pre></td><td class="code"><pre><span class="line">    if(count($this-&gt;language) &lt; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2167</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;SetLanguage(&#39;en&#39;); &#x2F;&#x2F; set the default language</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2168</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2169</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2170</span></pre></td><td class="code"><pre><span class="line">    if(isset($this-&gt;language[$key])) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2171</span></pre></td><td class="code"><pre><span class="line">      return $this-&gt;language[$key];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2172</span></pre></td><td class="code"><pre><span class="line">    &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2173</span></pre></td><td class="code"><pre><span class="line">      return &#39;Language string failed to load: &#39; . $key;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2174</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2175</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2176</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2177</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2178</span></pre></td><td class="code"><pre><span class="line">   * Returns true if an error occurred.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2179</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2180</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2181</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2182</span></pre></td><td class="code"><pre><span class="line">  public function IsError() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2183</span></pre></td><td class="code"><pre><span class="line">    return ($this-&gt;error_count &gt; 0);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2184</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2185</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2186</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2187</span></pre></td><td class="code"><pre><span class="line">   * Changes every end of line from CR or LF to CRLF.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2188</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2189</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2190</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2191</span></pre></td><td class="code"><pre><span class="line">  public function FixEOL($str) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2192</span></pre></td><td class="code"><pre><span class="line">    $str &#x3D; str_replace(&quot;\r\n&quot;, &quot;\n&quot;, $str);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2193</span></pre></td><td class="code"><pre><span class="line">    $str &#x3D; str_replace(&quot;\r&quot;, &quot;\n&quot;, $str);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2194</span></pre></td><td class="code"><pre><span class="line">    $str &#x3D; str_replace(&quot;\n&quot;, $this-&gt;LE, $str);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2195</span></pre></td><td class="code"><pre><span class="line">    return $str;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2196</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2197</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2198</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2199</span></pre></td><td class="code"><pre><span class="line">   * Adds a custom header.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2200</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2201</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2202</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2203</span></pre></td><td class="code"><pre><span class="line">  public function AddCustomHeader($custom_header) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2204</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;CustomHeader[] &#x3D; explode(&#39;:&#39;, $custom_header, 2);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2205</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2206</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2207</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2208</span></pre></td><td class="code"><pre><span class="line">   * Evaluates the message and returns modifications for inline images and backgrounds</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2209</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2210</span></pre></td><td class="code"><pre><span class="line">   * @return $message</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2211</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2212</span></pre></td><td class="code"><pre><span class="line">  public function MsgHTML($message, $basedir &#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2213</span></pre></td><td class="code"><pre><span class="line">    preg_match_all(&quot;&#x2F;(src|background)&#x3D;[\&quot;&#39;](.*)[\&quot;&#39;]&#x2F;Ui&quot;, $message, $images);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2214</span></pre></td><td class="code"><pre><span class="line">    if(isset($images[2])) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2215</span></pre></td><td class="code"><pre><span class="line">      foreach($images[2] as $i &#x3D;&gt; $url) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2216</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; do not change urls for absolute images (thanks to corvuscorax)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2217</span></pre></td><td class="code"><pre><span class="line">        if (!preg_match(&#39;#^[A-z]+:&#x2F;&#x2F;#&#39;, $url)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2218</span></pre></td><td class="code"><pre><span class="line">          $filename &#x3D; basename($url);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2219</span></pre></td><td class="code"><pre><span class="line">          $directory &#x3D; dirname($url);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2220</span></pre></td><td class="code"><pre><span class="line">          ($directory &#x3D;&#x3D; &#39;.&#39;) ? $directory&#x3D;&#39;&#39;: &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2221</span></pre></td><td class="code"><pre><span class="line">          $cid &#x3D; &#39;cid:&#39; . md5($filename);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2222</span></pre></td><td class="code"><pre><span class="line">          $ext &#x3D; pathinfo($filename, PATHINFO_EXTENSION);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2223</span></pre></td><td class="code"><pre><span class="line">          $mimeType  &#x3D; self::_mime_types($ext);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2224</span></pre></td><td class="code"><pre><span class="line">          if ( strlen($basedir) &gt; 1 &amp;&amp; substr($basedir, -1) !&#x3D; &#39;&#x2F;&#39;) &#123; $basedir .&#x3D; &#39;&#x2F;&#39;; &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2225</span></pre></td><td class="code"><pre><span class="line">          if ( strlen($directory) &gt; 1 &amp;&amp; substr($directory, -1) !&#x3D; &#39;&#x2F;&#39;) &#123; $directory .&#x3D; &#39;&#x2F;&#39;; &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2226</span></pre></td><td class="code"><pre><span class="line">          if ( $this-&gt;AddEmbeddedImage($basedir.$directory.$filename, md5($filename), $filename, &#39;base64&#39;, $mimeType) ) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2227</span></pre></td><td class="code"><pre><span class="line">            $message &#x3D; preg_replace(&quot;&#x2F;&quot;.$images[1][$i].&quot;&#x3D;[\&quot;&#39;]&quot;.preg_quote($url, &#39;&#x2F;&#39;).&quot;[\&quot;&#39;]&#x2F;Ui&quot;, $images[1][$i].&quot;&#x3D;\&quot;&quot;.$cid.&quot;\&quot;&quot;, $message);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2228</span></pre></td><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2229</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2230</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2231</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2232</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;IsHTML(true);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2233</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;Body &#x3D; $message;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2234</span></pre></td><td class="code"><pre><span class="line">    if (empty($this-&gt;AltBody)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2235</span></pre></td><td class="code"><pre><span class="line">        $textMsg &#x3D; trim(strip_tags(preg_replace(&#39;&#x2F;&lt;(head|title|style|script)[^&gt;]*&gt;.*?&lt;\&#x2F;\\1&gt;&#x2F;s&#39;, &#39;&#39;, $message)));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2236</span></pre></td><td class="code"><pre><span class="line">        if (!empty($textMsg)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2237</span></pre></td><td class="code"><pre><span class="line">            $this-&gt;AltBody &#x3D; html_entity_decode($textMsg, ENT_QUOTES, $this-&gt;CharSet);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2238</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2239</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2240</span></pre></td><td class="code"><pre><span class="line">    if (empty($this-&gt;AltBody)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2241</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;AltBody &#x3D; &#39;To view this email message, open it in a program that understands HTML!&#39; . &quot;\n\n&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2242</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2243</span></pre></td><td class="code"><pre><span class="line">    return $message;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2244</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2245</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2246</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2247</span></pre></td><td class="code"><pre><span class="line">   * Gets the MIME type of the embedded or inline image</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2248</span></pre></td><td class="code"><pre><span class="line">   * @param string File extension</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2249</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2250</span></pre></td><td class="code"><pre><span class="line">   * @return string MIME type of ext</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2251</span></pre></td><td class="code"><pre><span class="line">   * @static</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2252</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2253</span></pre></td><td class="code"><pre><span class="line">  public static function _mime_types($ext &#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2254</span></pre></td><td class="code"><pre><span class="line">    $mimes &#x3D; array(</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2255</span></pre></td><td class="code"><pre><span class="line">      &#39;hqx&#39;   &#x3D;&gt;  &#39;application&#x2F;mac-binhex40&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2256</span></pre></td><td class="code"><pre><span class="line">      &#39;cpt&#39;   &#x3D;&gt;  &#39;application&#x2F;mac-compactpro&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2257</span></pre></td><td class="code"><pre><span class="line">      &#39;doc&#39;   &#x3D;&gt;  &#39;application&#x2F;msword&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2258</span></pre></td><td class="code"><pre><span class="line">      &#39;bin&#39;   &#x3D;&gt;  &#39;application&#x2F;macbinary&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2259</span></pre></td><td class="code"><pre><span class="line">      &#39;dms&#39;   &#x3D;&gt;  &#39;application&#x2F;octet-stream&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2260</span></pre></td><td class="code"><pre><span class="line">      &#39;lha&#39;   &#x3D;&gt;  &#39;application&#x2F;octet-stream&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2261</span></pre></td><td class="code"><pre><span class="line">      &#39;lzh&#39;   &#x3D;&gt;  &#39;application&#x2F;octet-stream&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2262</span></pre></td><td class="code"><pre><span class="line">      &#39;exe&#39;   &#x3D;&gt;  &#39;application&#x2F;octet-stream&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2263</span></pre></td><td class="code"><pre><span class="line">      &#39;class&#39; &#x3D;&gt;  &#39;application&#x2F;octet-stream&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2264</span></pre></td><td class="code"><pre><span class="line">      &#39;psd&#39;   &#x3D;&gt;  &#39;application&#x2F;octet-stream&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2265</span></pre></td><td class="code"><pre><span class="line">      &#39;so&#39;    &#x3D;&gt;  &#39;application&#x2F;octet-stream&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2266</span></pre></td><td class="code"><pre><span class="line">      &#39;sea&#39;   &#x3D;&gt;  &#39;application&#x2F;octet-stream&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2267</span></pre></td><td class="code"><pre><span class="line">      &#39;dll&#39;   &#x3D;&gt;  &#39;application&#x2F;octet-stream&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2268</span></pre></td><td class="code"><pre><span class="line">      &#39;oda&#39;   &#x3D;&gt;  &#39;application&#x2F;oda&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2269</span></pre></td><td class="code"><pre><span class="line">      &#39;pdf&#39;   &#x3D;&gt;  &#39;application&#x2F;pdf&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2270</span></pre></td><td class="code"><pre><span class="line">      &#39;ai&#39;    &#x3D;&gt;  &#39;application&#x2F;postscript&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2271</span></pre></td><td class="code"><pre><span class="line">      &#39;eps&#39;   &#x3D;&gt;  &#39;application&#x2F;postscript&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2272</span></pre></td><td class="code"><pre><span class="line">      &#39;ps&#39;    &#x3D;&gt;  &#39;application&#x2F;postscript&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2273</span></pre></td><td class="code"><pre><span class="line">      &#39;smi&#39;   &#x3D;&gt;  &#39;application&#x2F;smil&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2274</span></pre></td><td class="code"><pre><span class="line">      &#39;smil&#39;  &#x3D;&gt;  &#39;application&#x2F;smil&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2275</span></pre></td><td class="code"><pre><span class="line">      &#39;mif&#39;   &#x3D;&gt;  &#39;application&#x2F;vnd.mif&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2276</span></pre></td><td class="code"><pre><span class="line">      &#39;xls&#39;   &#x3D;&gt;  &#39;application&#x2F;vnd.ms-excel&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2277</span></pre></td><td class="code"><pre><span class="line">      &#39;ppt&#39;   &#x3D;&gt;  &#39;application&#x2F;vnd.ms-powerpoint&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2278</span></pre></td><td class="code"><pre><span class="line">      &#39;wbxml&#39; &#x3D;&gt;  &#39;application&#x2F;vnd.wap.wbxml&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2279</span></pre></td><td class="code"><pre><span class="line">      &#39;wmlc&#39;  &#x3D;&gt;  &#39;application&#x2F;vnd.wap.wmlc&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2280</span></pre></td><td class="code"><pre><span class="line">      &#39;dcr&#39;   &#x3D;&gt;  &#39;application&#x2F;x-director&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2281</span></pre></td><td class="code"><pre><span class="line">      &#39;dir&#39;   &#x3D;&gt;  &#39;application&#x2F;x-director&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2282</span></pre></td><td class="code"><pre><span class="line">      &#39;dxr&#39;   &#x3D;&gt;  &#39;application&#x2F;x-director&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2283</span></pre></td><td class="code"><pre><span class="line">      &#39;dvi&#39;   &#x3D;&gt;  &#39;application&#x2F;x-dvi&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2284</span></pre></td><td class="code"><pre><span class="line">      &#39;gtar&#39;  &#x3D;&gt;  &#39;application&#x2F;x-gtar&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2285</span></pre></td><td class="code"><pre><span class="line">      &#39;php&#39;   &#x3D;&gt;  &#39;application&#x2F;x-httpd-php&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2286</span></pre></td><td class="code"><pre><span class="line">      &#39;php4&#39;  &#x3D;&gt;  &#39;application&#x2F;x-httpd-php&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2287</span></pre></td><td class="code"><pre><span class="line">      &#39;php3&#39;  &#x3D;&gt;  &#39;application&#x2F;x-httpd-php&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2288</span></pre></td><td class="code"><pre><span class="line">      &#39;phtml&#39; &#x3D;&gt;  &#39;application&#x2F;x-httpd-php&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2289</span></pre></td><td class="code"><pre><span class="line">      &#39;phps&#39;  &#x3D;&gt;  &#39;application&#x2F;x-httpd-php-source&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2290</span></pre></td><td class="code"><pre><span class="line">      &#39;js&#39;    &#x3D;&gt;  &#39;application&#x2F;x-javascript&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2291</span></pre></td><td class="code"><pre><span class="line">      &#39;swf&#39;   &#x3D;&gt;  &#39;application&#x2F;x-shockwave-flash&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2292</span></pre></td><td class="code"><pre><span class="line">      &#39;sit&#39;   &#x3D;&gt;  &#39;application&#x2F;x-stuffit&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2293</span></pre></td><td class="code"><pre><span class="line">      &#39;tar&#39;   &#x3D;&gt;  &#39;application&#x2F;x-tar&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2294</span></pre></td><td class="code"><pre><span class="line">      &#39;tgz&#39;   &#x3D;&gt;  &#39;application&#x2F;x-tar&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2295</span></pre></td><td class="code"><pre><span class="line">      &#39;xhtml&#39; &#x3D;&gt;  &#39;application&#x2F;xhtml+xml&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2296</span></pre></td><td class="code"><pre><span class="line">      &#39;xht&#39;   &#x3D;&gt;  &#39;application&#x2F;xhtml+xml&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2297</span></pre></td><td class="code"><pre><span class="line">      &#39;zip&#39;   &#x3D;&gt;  &#39;application&#x2F;zip&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2298</span></pre></td><td class="code"><pre><span class="line">      &#39;mid&#39;   &#x3D;&gt;  &#39;audio&#x2F;midi&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2299</span></pre></td><td class="code"><pre><span class="line">      &#39;midi&#39;  &#x3D;&gt;  &#39;audio&#x2F;midi&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2300</span></pre></td><td class="code"><pre><span class="line">      &#39;mpga&#39;  &#x3D;&gt;  &#39;audio&#x2F;mpeg&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2301</span></pre></td><td class="code"><pre><span class="line">      &#39;mp2&#39;   &#x3D;&gt;  &#39;audio&#x2F;mpeg&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2302</span></pre></td><td class="code"><pre><span class="line">      &#39;mp3&#39;   &#x3D;&gt;  &#39;audio&#x2F;mpeg&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2303</span></pre></td><td class="code"><pre><span class="line">      &#39;aif&#39;   &#x3D;&gt;  &#39;audio&#x2F;x-aiff&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2304</span></pre></td><td class="code"><pre><span class="line">      &#39;aiff&#39;  &#x3D;&gt;  &#39;audio&#x2F;x-aiff&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2305</span></pre></td><td class="code"><pre><span class="line">      &#39;aifc&#39;  &#x3D;&gt;  &#39;audio&#x2F;x-aiff&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2306</span></pre></td><td class="code"><pre><span class="line">      &#39;ram&#39;   &#x3D;&gt;  &#39;audio&#x2F;x-pn-realaudio&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2307</span></pre></td><td class="code"><pre><span class="line">      &#39;rm&#39;    &#x3D;&gt;  &#39;audio&#x2F;x-pn-realaudio&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2308</span></pre></td><td class="code"><pre><span class="line">      &#39;rpm&#39;   &#x3D;&gt;  &#39;audio&#x2F;x-pn-realaudio-plugin&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2309</span></pre></td><td class="code"><pre><span class="line">      &#39;ra&#39;    &#x3D;&gt;  &#39;audio&#x2F;x-realaudio&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2310</span></pre></td><td class="code"><pre><span class="line">      &#39;rv&#39;    &#x3D;&gt;  &#39;video&#x2F;vnd.rn-realvideo&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2311</span></pre></td><td class="code"><pre><span class="line">      &#39;wav&#39;   &#x3D;&gt;  &#39;audio&#x2F;x-wav&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2312</span></pre></td><td class="code"><pre><span class="line">      &#39;bmp&#39;   &#x3D;&gt;  &#39;image&#x2F;bmp&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2313</span></pre></td><td class="code"><pre><span class="line">      &#39;gif&#39;   &#x3D;&gt;  &#39;image&#x2F;gif&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2314</span></pre></td><td class="code"><pre><span class="line">      &#39;jpeg&#39;  &#x3D;&gt;  &#39;image&#x2F;jpeg&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2315</span></pre></td><td class="code"><pre><span class="line">      &#39;jpg&#39;   &#x3D;&gt;  &#39;image&#x2F;jpeg&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2316</span></pre></td><td class="code"><pre><span class="line">      &#39;jpe&#39;   &#x3D;&gt;  &#39;image&#x2F;jpeg&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2317</span></pre></td><td class="code"><pre><span class="line">      &#39;png&#39;   &#x3D;&gt;  &#39;image&#x2F;png&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2318</span></pre></td><td class="code"><pre><span class="line">      &#39;tiff&#39;  &#x3D;&gt;  &#39;image&#x2F;tiff&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2319</span></pre></td><td class="code"><pre><span class="line">      &#39;tif&#39;   &#x3D;&gt;  &#39;image&#x2F;tiff&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2320</span></pre></td><td class="code"><pre><span class="line">      &#39;css&#39;   &#x3D;&gt;  &#39;text&#x2F;css&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2321</span></pre></td><td class="code"><pre><span class="line">      &#39;html&#39;  &#x3D;&gt;  &#39;text&#x2F;html&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2322</span></pre></td><td class="code"><pre><span class="line">      &#39;htm&#39;   &#x3D;&gt;  &#39;text&#x2F;html&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2323</span></pre></td><td class="code"><pre><span class="line">      &#39;shtml&#39; &#x3D;&gt;  &#39;text&#x2F;html&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2324</span></pre></td><td class="code"><pre><span class="line">      &#39;txt&#39;   &#x3D;&gt;  &#39;text&#x2F;plain&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2325</span></pre></td><td class="code"><pre><span class="line">      &#39;text&#39;  &#x3D;&gt;  &#39;text&#x2F;plain&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2326</span></pre></td><td class="code"><pre><span class="line">      &#39;log&#39;   &#x3D;&gt;  &#39;text&#x2F;plain&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2327</span></pre></td><td class="code"><pre><span class="line">      &#39;rtx&#39;   &#x3D;&gt;  &#39;text&#x2F;richtext&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2328</span></pre></td><td class="code"><pre><span class="line">      &#39;rtf&#39;   &#x3D;&gt;  &#39;text&#x2F;rtf&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2329</span></pre></td><td class="code"><pre><span class="line">      &#39;xml&#39;   &#x3D;&gt;  &#39;text&#x2F;xml&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2330</span></pre></td><td class="code"><pre><span class="line">      &#39;xsl&#39;   &#x3D;&gt;  &#39;text&#x2F;xml&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2331</span></pre></td><td class="code"><pre><span class="line">      &#39;mpeg&#39;  &#x3D;&gt;  &#39;video&#x2F;mpeg&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2332</span></pre></td><td class="code"><pre><span class="line">      &#39;mpg&#39;   &#x3D;&gt;  &#39;video&#x2F;mpeg&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2333</span></pre></td><td class="code"><pre><span class="line">      &#39;mpe&#39;   &#x3D;&gt;  &#39;video&#x2F;mpeg&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2334</span></pre></td><td class="code"><pre><span class="line">      &#39;qt&#39;    &#x3D;&gt;  &#39;video&#x2F;quicktime&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2335</span></pre></td><td class="code"><pre><span class="line">      &#39;mov&#39;   &#x3D;&gt;  &#39;video&#x2F;quicktime&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2336</span></pre></td><td class="code"><pre><span class="line">      &#39;avi&#39;   &#x3D;&gt;  &#39;video&#x2F;x-msvideo&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2337</span></pre></td><td class="code"><pre><span class="line">      &#39;movie&#39; &#x3D;&gt;  &#39;video&#x2F;x-sgi-movie&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2338</span></pre></td><td class="code"><pre><span class="line">      &#39;doc&#39;   &#x3D;&gt;  &#39;application&#x2F;msword&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2339</span></pre></td><td class="code"><pre><span class="line">      &#39;word&#39;  &#x3D;&gt;  &#39;application&#x2F;msword&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2340</span></pre></td><td class="code"><pre><span class="line">      &#39;xl&#39;    &#x3D;&gt;  &#39;application&#x2F;excel&#39;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2341</span></pre></td><td class="code"><pre><span class="line">      &#39;eml&#39;   &#x3D;&gt;  &#39;message&#x2F;rfc822&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2342</span></pre></td><td class="code"><pre><span class="line">    );</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2343</span></pre></td><td class="code"><pre><span class="line">    return (!isset($mimes[strtolower($ext)])) ? &#39;application&#x2F;octet-stream&#39; : $mimes[strtolower($ext)];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2344</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2345</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2346</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2347</span></pre></td><td class="code"><pre><span class="line">  * Set (or reset) Class Objects (variables)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2348</span></pre></td><td class="code"><pre><span class="line">  *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2349</span></pre></td><td class="code"><pre><span class="line">  * Usage Example:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2350</span></pre></td><td class="code"><pre><span class="line">  * $page-&gt;set(&#39;X-Priority&#39;, &#39;3&#39;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2351</span></pre></td><td class="code"><pre><span class="line">  *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2352</span></pre></td><td class="code"><pre><span class="line">  * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2353</span></pre></td><td class="code"><pre><span class="line">  * @param string $name Parameter Name</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2354</span></pre></td><td class="code"><pre><span class="line">  * @param mixed $value Parameter Value</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2355</span></pre></td><td class="code"><pre><span class="line">  * NOTE: will not work with arrays, there are no arrays to set&#x2F;reset</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2356</span></pre></td><td class="code"><pre><span class="line">  * @todo Should this not be using __set() magic function?</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2357</span></pre></td><td class="code"><pre><span class="line">  *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2358</span></pre></td><td class="code"><pre><span class="line">  public function set($name, $value &#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2359</span></pre></td><td class="code"><pre><span class="line">    try &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2360</span></pre></td><td class="code"><pre><span class="line">      if (isset($this-&gt;$name) ) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2361</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;$name &#x3D; $value;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2362</span></pre></td><td class="code"><pre><span class="line">      &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2363</span></pre></td><td class="code"><pre><span class="line">        throw new phpmailerException($this-&gt;Lang(&#39;variable_set&#39;) . $name, self::STOP_CRITICAL);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2364</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2365</span></pre></td><td class="code"><pre><span class="line">    &#125; catch (Exception $e) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2366</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;SetError($e-&gt;getMessage());</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2367</span></pre></td><td class="code"><pre><span class="line">      if ($e-&gt;getCode() &#x3D;&#x3D; self::STOP_CRITICAL) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2368</span></pre></td><td class="code"><pre><span class="line">        return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2369</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2370</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2371</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2372</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2373</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2374</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2375</span></pre></td><td class="code"><pre><span class="line">   * Strips newlines to prevent header injection.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2376</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2377</span></pre></td><td class="code"><pre><span class="line">   * @param string $str String</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2378</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2379</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2380</span></pre></td><td class="code"><pre><span class="line">  public function SecureHeader($str) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2381</span></pre></td><td class="code"><pre><span class="line">    $str &#x3D; str_replace(&quot;\r&quot;, &#39;&#39;, $str);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2382</span></pre></td><td class="code"><pre><span class="line">    $str &#x3D; str_replace(&quot;\n&quot;, &#39;&#39;, $str);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2383</span></pre></td><td class="code"><pre><span class="line">    return trim($str);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2384</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2385</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2386</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2387</span></pre></td><td class="code"><pre><span class="line">   * Set the private key file and password to sign the message.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2388</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2389</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2390</span></pre></td><td class="code"><pre><span class="line">   * @param string $key_filename Parameter File Name</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2391</span></pre></td><td class="code"><pre><span class="line">   * @param string $key_pass Password for private key</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2392</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2393</span></pre></td><td class="code"><pre><span class="line">  public function Sign($cert_filename, $key_filename, $key_pass) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2394</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;sign_cert_file &#x3D; $cert_filename;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2395</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;sign_key_file &#x3D; $key_filename;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2396</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;sign_key_pass &#x3D; $key_pass;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2397</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2398</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2399</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2400</span></pre></td><td class="code"><pre><span class="line">   * Set the private key file and password to sign the message.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2401</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2402</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2403</span></pre></td><td class="code"><pre><span class="line">   * @param string $key_filename Parameter File Name</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2404</span></pre></td><td class="code"><pre><span class="line">   * @param string $key_pass Password for private key</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2405</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2406</span></pre></td><td class="code"><pre><span class="line">  public function DKIM_QP($txt) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2407</span></pre></td><td class="code"><pre><span class="line">    $tmp &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2408</span></pre></td><td class="code"><pre><span class="line">    $line &#x3D; &#39;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2409</span></pre></td><td class="code"><pre><span class="line">    for ($i &#x3D; 0; $i &lt; strlen($txt); $i++) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2410</span></pre></td><td class="code"><pre><span class="line">      $ord &#x3D; ord($txt[$i]);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2411</span></pre></td><td class="code"><pre><span class="line">      if ( ((0x21 &lt;&#x3D; $ord) &amp;&amp; ($ord &lt;&#x3D; 0x3A)) || $ord &#x3D;&#x3D; 0x3C || ((0x3E &lt;&#x3D; $ord) &amp;&amp; ($ord &lt;&#x3D; 0x7E)) ) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2412</span></pre></td><td class="code"><pre><span class="line">        $line .&#x3D; $txt[$i];</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2413</span></pre></td><td class="code"><pre><span class="line">      &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2414</span></pre></td><td class="code"><pre><span class="line">        $line .&#x3D; &quot;&#x3D;&quot;.sprintf(&quot;%02X&quot;, $ord);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2415</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2416</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2417</span></pre></td><td class="code"><pre><span class="line">    return $line;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2418</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2419</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2420</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2421</span></pre></td><td class="code"><pre><span class="line">   * Generate DKIM signature</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2422</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2423</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2424</span></pre></td><td class="code"><pre><span class="line">   * @param string $s Header</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2425</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2426</span></pre></td><td class="code"><pre><span class="line">  public function DKIM_Sign($s) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2427</span></pre></td><td class="code"><pre><span class="line">    $privKeyStr &#x3D; file_get_contents($this-&gt;DKIM_private);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2428</span></pre></td><td class="code"><pre><span class="line">    if ($this-&gt;DKIM_passphrase !&#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2429</span></pre></td><td class="code"><pre><span class="line">      $privKey &#x3D; openssl_pkey_get_private($privKeyStr, $this-&gt;DKIM_passphrase);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2430</span></pre></td><td class="code"><pre><span class="line">    &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2431</span></pre></td><td class="code"><pre><span class="line">      $privKey &#x3D; $privKeyStr;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2432</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2433</span></pre></td><td class="code"><pre><span class="line">    if (openssl_sign($s, $signature, $privKey)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2434</span></pre></td><td class="code"><pre><span class="line">      return base64_encode($signature);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2435</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2436</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2437</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2438</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2439</span></pre></td><td class="code"><pre><span class="line">   * Generate DKIM Canonicalization Header</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2440</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2441</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2442</span></pre></td><td class="code"><pre><span class="line">   * @param string $s Header</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2443</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2444</span></pre></td><td class="code"><pre><span class="line">  public function DKIM_HeaderC($s) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2445</span></pre></td><td class="code"><pre><span class="line">    $s &#x3D; preg_replace(&quot;&#x2F;\r\n\s+&#x2F;&quot;, &quot; &quot;, $s);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2446</span></pre></td><td class="code"><pre><span class="line">    $lines &#x3D; explode(&quot;\r\n&quot;, $s);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2447</span></pre></td><td class="code"><pre><span class="line">    foreach ($lines as $key &#x3D;&gt; $line) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2448</span></pre></td><td class="code"><pre><span class="line">      list($heading, $value) &#x3D; explode(&quot;:&quot;, $line, 2);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2449</span></pre></td><td class="code"><pre><span class="line">      $heading &#x3D; strtolower($heading);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2450</span></pre></td><td class="code"><pre><span class="line">      $value &#x3D; preg_replace(&quot;&#x2F;\s+&#x2F;&quot;, &quot; &quot;, $value) ; &#x2F;&#x2F; Compress useless spaces</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2451</span></pre></td><td class="code"><pre><span class="line">      $lines[$key] &#x3D; $heading.&quot;:&quot;.trim($value) ; &#x2F;&#x2F; Don&#39;t forget to remove WSP around the value</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2452</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2453</span></pre></td><td class="code"><pre><span class="line">    $s &#x3D; implode(&quot;\r\n&quot;, $lines);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2454</span></pre></td><td class="code"><pre><span class="line">    return $s;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2455</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2456</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2457</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2458</span></pre></td><td class="code"><pre><span class="line">   * Generate DKIM Canonicalization Body</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2459</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2460</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2461</span></pre></td><td class="code"><pre><span class="line">   * @param string $body Message Body</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2462</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2463</span></pre></td><td class="code"><pre><span class="line">  public function DKIM_BodyC($body) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2464</span></pre></td><td class="code"><pre><span class="line">    if ($body &#x3D;&#x3D; &#39;&#39;) return &quot;\r\n&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2465</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; stabilize line endings</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2466</span></pre></td><td class="code"><pre><span class="line">    $body &#x3D; str_replace(&quot;\r\n&quot;, &quot;\n&quot;, $body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2467</span></pre></td><td class="code"><pre><span class="line">    $body &#x3D; str_replace(&quot;\n&quot;, &quot;\r\n&quot;, $body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2468</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; END stabilize line endings</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2469</span></pre></td><td class="code"><pre><span class="line">    while (substr($body, strlen($body) - 4, 4) &#x3D;&#x3D; &quot;\r\n\r\n&quot;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2470</span></pre></td><td class="code"><pre><span class="line">      $body &#x3D; substr($body, 0, strlen($body) - 2);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2471</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2472</span></pre></td><td class="code"><pre><span class="line">    return $body;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2473</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2474</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2475</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2476</span></pre></td><td class="code"><pre><span class="line">   * Create the DKIM header, body, as new header</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2477</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2478</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2479</span></pre></td><td class="code"><pre><span class="line">   * @param string $headers_line Header lines</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2480</span></pre></td><td class="code"><pre><span class="line">   * @param string $subject Subject</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2481</span></pre></td><td class="code"><pre><span class="line">   * @param string $body Body</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2482</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2483</span></pre></td><td class="code"><pre><span class="line">  public function DKIM_Add($headers_line, $subject, $body) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2484</span></pre></td><td class="code"><pre><span class="line">    $DKIMsignatureType    &#x3D; &#39;rsa-sha1&#39;; &#x2F;&#x2F; Signature &amp; hash algorithms</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2485</span></pre></td><td class="code"><pre><span class="line">    $DKIMcanonicalization &#x3D; &#39;relaxed&#x2F;simple&#39;; &#x2F;&#x2F; Canonicalization of header&#x2F;body</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2486</span></pre></td><td class="code"><pre><span class="line">    $DKIMquery            &#x3D; &#39;dns&#x2F;txt&#39;; &#x2F;&#x2F; Query method</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2487</span></pre></td><td class="code"><pre><span class="line">    $DKIMtime             &#x3D; time() ; &#x2F;&#x2F; Signature Timestamp &#x3D; seconds since 00:00:00 - Jan 1, 1970 (UTC time zone)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2488</span></pre></td><td class="code"><pre><span class="line">    $subject_header       &#x3D; &quot;Subject: $subject&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2489</span></pre></td><td class="code"><pre><span class="line">    $headers              &#x3D; explode($this-&gt;LE, $headers_line);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2490</span></pre></td><td class="code"><pre><span class="line">    foreach($headers as $header) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2491</span></pre></td><td class="code"><pre><span class="line">      if (strpos($header, &#39;From:&#39;) &#x3D;&#x3D;&#x3D; 0) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2492</span></pre></td><td class="code"><pre><span class="line">        $from_header &#x3D; $header;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2493</span></pre></td><td class="code"><pre><span class="line">      &#125; elseif (strpos($header, &#39;To:&#39;) &#x3D;&#x3D;&#x3D; 0) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2494</span></pre></td><td class="code"><pre><span class="line">        $to_header &#x3D; $header;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2495</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2496</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2497</span></pre></td><td class="code"><pre><span class="line">    $from     &#x3D; str_replace(&#39;|&#39;, &#39;&#x3D;7C&#39;, $this-&gt;DKIM_QP($from_header));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2498</span></pre></td><td class="code"><pre><span class="line">    $to       &#x3D; str_replace(&#39;|&#39;, &#39;&#x3D;7C&#39;, $this-&gt;DKIM_QP($to_header));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2499</span></pre></td><td class="code"><pre><span class="line">    $subject  &#x3D; str_replace(&#39;|&#39;, &#39;&#x3D;7C&#39;, $this-&gt;DKIM_QP($subject_header)) ; &#x2F;&#x2F; Copied header fields (dkim-quoted-printable</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2500</span></pre></td><td class="code"><pre><span class="line">    $body     &#x3D; $this-&gt;DKIM_BodyC($body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2501</span></pre></td><td class="code"><pre><span class="line">    $DKIMlen  &#x3D; strlen($body) ; &#x2F;&#x2F; Length of body</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2502</span></pre></td><td class="code"><pre><span class="line">    $DKIMb64  &#x3D; base64_encode(pack(&quot;H*&quot;, sha1($body))) ; &#x2F;&#x2F; Base64 of packed binary SHA-1 hash of body</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2503</span></pre></td><td class="code"><pre><span class="line">    $ident    &#x3D; ($this-&gt;DKIM_identity &#x3D;&#x3D; &#39;&#39;)? &#39;&#39; : &quot; i&#x3D;&quot; . $this-&gt;DKIM_identity . &quot;;&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2504</span></pre></td><td class="code"><pre><span class="line">    $dkimhdrs &#x3D; &quot;DKIM-Signature: v&#x3D;1; a&#x3D;&quot; . $DKIMsignatureType . &quot;; q&#x3D;&quot; . $DKIMquery . &quot;; l&#x3D;&quot; . $DKIMlen . &quot;; s&#x3D;&quot; . $this-&gt;DKIM_selector . &quot;;\r\n&quot;.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2505</span></pre></td><td class="code"><pre><span class="line">                &quot;\tt&#x3D;&quot; . $DKIMtime . &quot;; c&#x3D;&quot; . $DKIMcanonicalization . &quot;;\r\n&quot;.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2506</span></pre></td><td class="code"><pre><span class="line">                &quot;\th&#x3D;From:To:Subject;\r\n&quot;.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2507</span></pre></td><td class="code"><pre><span class="line">                &quot;\td&#x3D;&quot; . $this-&gt;DKIM_domain . &quot;;&quot; . $ident . &quot;\r\n&quot;.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2508</span></pre></td><td class="code"><pre><span class="line">                &quot;\tz&#x3D;$from\r\n&quot;.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2509</span></pre></td><td class="code"><pre><span class="line">                &quot;\t|$to\r\n&quot;.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2510</span></pre></td><td class="code"><pre><span class="line">                &quot;\t|$subject;\r\n&quot;.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2511</span></pre></td><td class="code"><pre><span class="line">                &quot;\tbh&#x3D;&quot; . $DKIMb64 . &quot;;\r\n&quot;.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2512</span></pre></td><td class="code"><pre><span class="line">                &quot;\tb&#x3D;&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2513</span></pre></td><td class="code"><pre><span class="line">    $toSign   &#x3D; $this-&gt;DKIM_HeaderC($from_header . &quot;\r\n&quot; . $to_header . &quot;\r\n&quot; . $subject_header . &quot;\r\n&quot; . $dkimhdrs);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2514</span></pre></td><td class="code"><pre><span class="line">    $signed   &#x3D; $this-&gt;DKIM_Sign($toSign);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2515</span></pre></td><td class="code"><pre><span class="line">    return &quot;X-PHPMAILER-DKIM: phpmailer.worxware.com\r\n&quot;.$dkimhdrs.$signed.&quot;\r\n&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2516</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2517</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2518</span></pre></td><td class="code"><pre><span class="line">  protected function doCallback($isSent, $to, $cc, $bcc, $subject, $body) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2519</span></pre></td><td class="code"><pre><span class="line">    if (!empty($this-&gt;action_function) &amp;&amp; function_exists($this-&gt;action_function)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2520</span></pre></td><td class="code"><pre><span class="line">      $params &#x3D; array($isSent, $to, $cc, $bcc, $subject, $body);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2521</span></pre></td><td class="code"><pre><span class="line">      call_user_func_array($this-&gt;action_function, $params);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2522</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2523</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2524</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2525</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2526</span></pre></td><td class="code"><pre><span class="line">class phpmailerException extends Exception &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2527</span></pre></td><td class="code"><pre><span class="line">  public function errorMessage() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2528</span></pre></td><td class="code"><pre><span class="line">    $errorMsg &#x3D; &#39;&lt;strong&gt;&#39; . $this-&gt;getMessage() . &quot;&lt;&#x2F;strong&gt;&lt;br &#x2F;&gt;\n&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2529</span></pre></td><td class="code"><pre><span class="line">    return $errorMsg;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2530</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2531</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h1 id="SMTP文件Smtp-class-php"><a href="#SMTP文件Smtp-class-php" class="headerlink" title="SMTP文件Smtp.class.php"></a>SMTP文件Smtp.class.php</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&#x2F;*~ class.smtp.php</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">.---------------------------------------------------------------------------.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">|  Software: PHPMailer - PHP email class                                    |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">|   Version: 5.2.1                                                          |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">|      Site: https:&#x2F;&#x2F;code.google.com&#x2F;a&#x2F;apache-extras.org&#x2F;p&#x2F;phpmailer&#x2F;       |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">| ------------------------------------------------------------------------- |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">|     Admin: Jim Jagielski (project admininistrator)                        |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">|   Authors: Andy Prevost (codeworxtech) codeworxtech@users.sourceforge.net |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">|          : Marcus Bointon (coolbru) coolbru@users.sourceforge.net         |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">|          : Jim Jagielski (jimjag) jimjag@gmail.com                        |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">|   Founder: Brent R. Matzelle (original founder)                           |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">| Copyright (c) 2010-2012, Jim Jagielski. All Rights Reserved.              |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line">| Copyright (c) 2004-2009, Andy Prevost. All Rights Reserved.               |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">| Copyright (c) 2001-2003, Brent R. Matzelle                                |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">| ------------------------------------------------------------------------- |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line">|   License: Distributed under the Lesser General Public License (LGPL)     |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">|            http:&#x2F;&#x2F;www.gnu.org&#x2F;copyleft&#x2F;lesser.html                        |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">| This program is distributed in the hope that it will be useful - WITHOUT  |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">| ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or     |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">| FITNESS FOR A PARTICULAR PURPOSE.                                         |</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line">&#39;---------------------------------------------------------------------------&#39;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">*&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">&#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line"> * PHPMailer - PHP SMTP email transport class</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"> * NOTE: Designed for use with PHP version 5 and up</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line"> * @package PHPMailer</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line"> * @author Andy Prevost</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line"> * @author Marcus Bointon</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line"> * @copyright 2004 - 2008 Andy Prevost</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line"> * @author Jim Jagielski</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line"> * @copyright 2010 - 2012 Jim Jagielski</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line"> * @license http:&#x2F;&#x2F;www.gnu.org&#x2F;copyleft&#x2F;lesser.html Distributed under the Lesser General Public License (LGPL)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line"> * @version $Id: class.smtp.php 450 2010-06-23 16:46:33Z coolbru $</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line"> *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line">namespace Org\Util;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">&#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line"> * SMTP is rfc 821 compliant and implements all the rfc 821 SMTP</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line"> * commands except TURN which will always return a not implemented</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line"> * error. SMTP also provides some utility methods for sending mail</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line"> * to an SMTP server.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line"> * original author: Chris Ryan</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line"> *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line">class SMTP &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line">   *  SMTP server port</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line">   *  @var int</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line">  public $SMTP_PORT &#x3D; 25;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line">   *  SMTP reply line ending</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line">   *  @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line">  public $CRLF &#x3D; &quot;\r\n&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line">   *  Sets whether debugging is turned on</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line">   *  @var bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line">  public $do_debug;       &#x2F;&#x2F; the level of debug to perform</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line">   *  Sets VERP use on&#x2F;off (default is off)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line">   *  @var bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line">  public $do_verp &#x3D; false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line">   * Sets the SMTP PHPMailer Version number</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line">   * @var string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">74</span></pre></td><td class="code"><pre><span class="line">  public $Version         &#x3D; &#39;5.2.1&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">75</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">76</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">77</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F; PROPERTIES, PRIVATE AND PROTECTED</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">78</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">79</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">80</span></pre></td><td class="code"><pre><span class="line">  private $smtp_conn; &#x2F;&#x2F; the socket to the server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">81</span></pre></td><td class="code"><pre><span class="line">  private $error;     &#x2F;&#x2F; error if any on the last call</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">82</span></pre></td><td class="code"><pre><span class="line">  private $helo_rply; &#x2F;&#x2F; the reply the server sent to us for HELO</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">83</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">84</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">85</span></pre></td><td class="code"><pre><span class="line">   * Initialize the class so that the data is in a known state.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">86</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">87</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">88</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">89</span></pre></td><td class="code"><pre><span class="line">  public function __construct() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">90</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;smtp_conn &#x3D; 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">91</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;error &#x3D; null;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">92</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;helo_rply &#x3D; null;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">93</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">94</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;do_debug &#x3D; 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">95</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">96</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">97</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">98</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F; CONNECTION FUNCTIONS</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">99</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">100</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">101</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">102</span></pre></td><td class="code"><pre><span class="line">   * Connect to the server specified on the port specified.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">103</span></pre></td><td class="code"><pre><span class="line">   * If the port is not specified use the default SMTP_PORT.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">104</span></pre></td><td class="code"><pre><span class="line">   * If tval is specified then a connection will try and be</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">105</span></pre></td><td class="code"><pre><span class="line">   * established with the server for that number of seconds.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">106</span></pre></td><td class="code"><pre><span class="line">   * If tval is not specified the default is 30 seconds to</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">107</span></pre></td><td class="code"><pre><span class="line">   * try on the connection.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">108</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">109</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE SUCCESS: 220</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">110</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE FAILURE: 421</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">111</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">112</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">113</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">114</span></pre></td><td class="code"><pre><span class="line">  public function Connect($host, $port &#x3D; 0, $tval &#x3D; 30) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">115</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; set the error val to null so there is no confusion</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">116</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;error &#x3D; null;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">117</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">118</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; make sure we are __not__ connected</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">119</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;connected()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">120</span></pre></td><td class="code"><pre><span class="line">      &#x2F;&#x2F; already connected, generate error</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">121</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D; array(&quot;error&quot; &#x3D;&gt; &quot;Already connected to a server&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">122</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">123</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">124</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">125</span></pre></td><td class="code"><pre><span class="line">    if(empty($port)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">126</span></pre></td><td class="code"><pre><span class="line">      $port &#x3D; $this-&gt;SMTP_PORT;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">127</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">128</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">129</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; connect to the smtp server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">130</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;smtp_conn &#x3D; @pfsockopen($host,    &#x2F;&#x2F; the host of the server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">131</span></pre></td><td class="code"><pre><span class="line">                                 $port,    &#x2F;&#x2F; the port to use</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">132</span></pre></td><td class="code"><pre><span class="line">                                 $errno,   &#x2F;&#x2F; error number if any</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">133</span></pre></td><td class="code"><pre><span class="line">                                 $errstr,  &#x2F;&#x2F; error message if any</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">134</span></pre></td><td class="code"><pre><span class="line">                                 $tval);   &#x2F;&#x2F; give up after ? secs</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">135</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; verify we connected properly</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">136</span></pre></td><td class="code"><pre><span class="line">    if(empty($this-&gt;smtp_conn)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">137</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D; array(&quot;error&quot; &#x3D;&gt; &quot;Failed to connect to server&quot;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">138</span></pre></td><td class="code"><pre><span class="line">                           &quot;errno&quot; &#x3D;&gt; $errno,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">139</span></pre></td><td class="code"><pre><span class="line">                           &quot;errstr&quot; &#x3D;&gt; $errstr);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">140</span></pre></td><td class="code"><pre><span class="line">      if($this-&gt;do_debug &gt;&#x3D; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">141</span></pre></td><td class="code"><pre><span class="line">        echo &quot;SMTP -&gt; ERROR: &quot; . $this-&gt;error[&quot;error&quot;] . &quot;: $errstr ($errno)&quot; . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">142</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">143</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">144</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">145</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">146</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; SMTP server can take longer to respond, give longer timeout for first read</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">147</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Windows does not have support for this timeout function</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">148</span></pre></td><td class="code"><pre><span class="line">    if(substr(PHP_OS, 0, 3) !&#x3D; &quot;WIN&quot;)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">149</span></pre></td><td class="code"><pre><span class="line">     socket_set_timeout($this-&gt;smtp_conn, $tval, 0);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">150</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">151</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; get any announcement</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">152</span></pre></td><td class="code"><pre><span class="line">    $announce &#x3D; $this-&gt;get_lines();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">153</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">154</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;do_debug &gt;&#x3D; 2) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">155</span></pre></td><td class="code"><pre><span class="line">      echo &quot;SMTP -&gt; FROM SERVER:&quot; . $announce . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">156</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">157</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">158</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">159</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">160</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">161</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">162</span></pre></td><td class="code"><pre><span class="line">   * Initiate a TLS communication with the server.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">163</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">164</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE 220 Ready to start TLS</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">165</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE 501 Syntax error (no parameters allowed)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">166</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE 454 TLS not available due to temporary reason</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">167</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">168</span></pre></td><td class="code"><pre><span class="line">   * @return bool success</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">169</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">170</span></pre></td><td class="code"><pre><span class="line">  public function StartTLS() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">171</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;error &#x3D; null; # to avoid confusion</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">172</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">173</span></pre></td><td class="code"><pre><span class="line">    if(!$this-&gt;connected()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">174</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D; array(&quot;error&quot; &#x3D;&gt; &quot;Called StartTLS() without being connected&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">175</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">176</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">177</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">178</span></pre></td><td class="code"><pre><span class="line">    fputs($this-&gt;smtp_conn,&quot;STARTTLS&quot; . $this-&gt;CRLF);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">179</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">180</span></pre></td><td class="code"><pre><span class="line">    $rply &#x3D; $this-&gt;get_lines();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">181</span></pre></td><td class="code"><pre><span class="line">    $code &#x3D; substr($rply,0,3);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">182</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">183</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;do_debug &gt;&#x3D; 2) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">184</span></pre></td><td class="code"><pre><span class="line">      echo &quot;SMTP -&gt; FROM SERVER:&quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">185</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">186</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">187</span></pre></td><td class="code"><pre><span class="line">    if($code !&#x3D; 220) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">188</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">189</span></pre></td><td class="code"><pre><span class="line">         array(&quot;error&quot;     &#x3D;&gt; &quot;STARTTLS not accepted from server&quot;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">190</span></pre></td><td class="code"><pre><span class="line">               &quot;smtp_code&quot; &#x3D;&gt; $code,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">191</span></pre></td><td class="code"><pre><span class="line">               &quot;smtp_msg&quot;  &#x3D;&gt; substr($rply,4));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">192</span></pre></td><td class="code"><pre><span class="line">      if($this-&gt;do_debug &gt;&#x3D; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">193</span></pre></td><td class="code"><pre><span class="line">        echo &quot;SMTP -&gt; ERROR: &quot; . $this-&gt;error[&quot;error&quot;] . &quot;: &quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">194</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">195</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">196</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">197</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">198</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Begin encrypted connection</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">199</span></pre></td><td class="code"><pre><span class="line">    if(!stream_socket_enable_crypto($this-&gt;smtp_conn, true, STREAM_CRYPTO_METHOD_TLS_CLIENT)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">200</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">201</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">202</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">203</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">204</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">205</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">206</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">207</span></pre></td><td class="code"><pre><span class="line">   * Performs SMTP authentication.  Must be run after running the</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">208</span></pre></td><td class="code"><pre><span class="line">   * Hello() method.  Returns true if successfully authenticated.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">209</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">210</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">211</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">212</span></pre></td><td class="code"><pre><span class="line">  public function Authenticate($username, $password) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">213</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Start authentication</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">214</span></pre></td><td class="code"><pre><span class="line">    fputs($this-&gt;smtp_conn,&quot;AUTH LOGIN&quot; . $this-&gt;CRLF);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">215</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">216</span></pre></td><td class="code"><pre><span class="line">    $rply &#x3D; $this-&gt;get_lines();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">217</span></pre></td><td class="code"><pre><span class="line">    $code &#x3D; substr($rply,0,3);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">218</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">219</span></pre></td><td class="code"><pre><span class="line">    if($code !&#x3D; 334) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">220</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">221</span></pre></td><td class="code"><pre><span class="line">        array(&quot;error&quot; &#x3D;&gt; &quot;AUTH not accepted from server&quot;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">222</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_code&quot; &#x3D;&gt; $code,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">223</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_msg&quot; &#x3D;&gt; substr($rply,4));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">224</span></pre></td><td class="code"><pre><span class="line">      if($this-&gt;do_debug &gt;&#x3D; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">225</span></pre></td><td class="code"><pre><span class="line">        echo &quot;SMTP -&gt; ERROR: &quot; . $this-&gt;error[&quot;error&quot;] . &quot;: &quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">226</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">227</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">228</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">229</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">230</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Send encoded username</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">231</span></pre></td><td class="code"><pre><span class="line">    fputs($this-&gt;smtp_conn, base64_encode($username) . $this-&gt;CRLF);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">232</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">233</span></pre></td><td class="code"><pre><span class="line">    $rply &#x3D; $this-&gt;get_lines();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">234</span></pre></td><td class="code"><pre><span class="line">    $code &#x3D; substr($rply,0,3);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">235</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">236</span></pre></td><td class="code"><pre><span class="line">    if($code !&#x3D; 334) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">237</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">238</span></pre></td><td class="code"><pre><span class="line">        array(&quot;error&quot; &#x3D;&gt; &quot;Username not accepted from server&quot;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">239</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_code&quot; &#x3D;&gt; $code,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">240</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_msg&quot; &#x3D;&gt; substr($rply,4));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">241</span></pre></td><td class="code"><pre><span class="line">      if($this-&gt;do_debug &gt;&#x3D; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">242</span></pre></td><td class="code"><pre><span class="line">        echo &quot;SMTP -&gt; ERROR: &quot; . $this-&gt;error[&quot;error&quot;] . &quot;: &quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">243</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">244</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">245</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">246</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">247</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Send encoded password</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">248</span></pre></td><td class="code"><pre><span class="line">    fputs($this-&gt;smtp_conn, base64_encode($password) . $this-&gt;CRLF);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">249</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">250</span></pre></td><td class="code"><pre><span class="line">    $rply &#x3D; $this-&gt;get_lines();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">251</span></pre></td><td class="code"><pre><span class="line">    $code &#x3D; substr($rply,0,3);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">252</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">253</span></pre></td><td class="code"><pre><span class="line">    if($code !&#x3D; 235) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">254</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">255</span></pre></td><td class="code"><pre><span class="line">        array(&quot;error&quot; &#x3D;&gt; &quot;Password not accepted from server&quot;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">256</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_code&quot; &#x3D;&gt; $code,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">257</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_msg&quot; &#x3D;&gt; substr($rply,4));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">258</span></pre></td><td class="code"><pre><span class="line">      if($this-&gt;do_debug &gt;&#x3D; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">259</span></pre></td><td class="code"><pre><span class="line">        echo &quot;SMTP -&gt; ERROR: &quot; . $this-&gt;error[&quot;error&quot;] . &quot;: &quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">260</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">261</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">262</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">263</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">264</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">265</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">266</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">267</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">268</span></pre></td><td class="code"><pre><span class="line">   * Returns true if connected to a server otherwise false</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">269</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">270</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">271</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">272</span></pre></td><td class="code"><pre><span class="line">  public function Connected() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">273</span></pre></td><td class="code"><pre><span class="line">    if(!empty($this-&gt;smtp_conn)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">274</span></pre></td><td class="code"><pre><span class="line">      $sock_status &#x3D; socket_get_status($this-&gt;smtp_conn);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">275</span></pre></td><td class="code"><pre><span class="line">      if($sock_status[&quot;eof&quot;]) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">276</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; the socket is valid but we are not connected</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">277</span></pre></td><td class="code"><pre><span class="line">        if($this-&gt;do_debug &gt;&#x3D; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">278</span></pre></td><td class="code"><pre><span class="line">            echo &quot;SMTP -&gt; NOTICE:&quot; . $this-&gt;CRLF . &quot;EOF caught while checking if connected&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">279</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">280</span></pre></td><td class="code"><pre><span class="line">        $this-&gt;Close();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">281</span></pre></td><td class="code"><pre><span class="line">        return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">282</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">283</span></pre></td><td class="code"><pre><span class="line">      return true; &#x2F;&#x2F; everything looks good</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">284</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">285</span></pre></td><td class="code"><pre><span class="line">    return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">286</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">287</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">288</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">289</span></pre></td><td class="code"><pre><span class="line">   * Closes the socket and cleans up the state of the class.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">290</span></pre></td><td class="code"><pre><span class="line">   * It is not considered good to use this function without</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">291</span></pre></td><td class="code"><pre><span class="line">   * first trying to use QUIT.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">292</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">293</span></pre></td><td class="code"><pre><span class="line">   * @return void</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">294</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">295</span></pre></td><td class="code"><pre><span class="line">  public function Close() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">296</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;error &#x3D; null; &#x2F;&#x2F; so there is no confusion</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">297</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;helo_rply &#x3D; null;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">298</span></pre></td><td class="code"><pre><span class="line">    if(!empty($this-&gt;smtp_conn)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">299</span></pre></td><td class="code"><pre><span class="line">      &#x2F;&#x2F; close the connection and cleanup</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">300</span></pre></td><td class="code"><pre><span class="line">      fclose($this-&gt;smtp_conn);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">301</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;smtp_conn &#x3D; 0;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">302</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">303</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">304</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">305</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">306</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F; SMTP COMMANDS</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">307</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">308</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">309</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">310</span></pre></td><td class="code"><pre><span class="line">   * Issues a data command and sends the msg_data to the server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">311</span></pre></td><td class="code"><pre><span class="line">   * finializing the mail transaction. $msg_data is the message</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">312</span></pre></td><td class="code"><pre><span class="line">   * that is to be send with the headers. Each header needs to be</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">313</span></pre></td><td class="code"><pre><span class="line">   * on a single line followed by a &lt;CRLF&gt; with the message headers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">314</span></pre></td><td class="code"><pre><span class="line">   * and the message body being seperated by and additional &lt;CRLF&gt;.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">315</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">316</span></pre></td><td class="code"><pre><span class="line">   * Implements rfc 821: DATA &lt;CRLF&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">317</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">318</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE INTERMEDIATE: 354</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">319</span></pre></td><td class="code"><pre><span class="line">   *     [data]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">320</span></pre></td><td class="code"><pre><span class="line">   *     &lt;CRLF&gt;.&lt;CRLF&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">321</span></pre></td><td class="code"><pre><span class="line">   *     SMTP CODE SUCCESS: 250</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">322</span></pre></td><td class="code"><pre><span class="line">   *     SMTP CODE FAILURE: 552,554,451,452</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">323</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE FAILURE: 451,554</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">324</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE ERROR  : 500,501,503,421</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">325</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">326</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">327</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">328</span></pre></td><td class="code"><pre><span class="line">  public function Data($msg_data) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">329</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;error &#x3D; null; &#x2F;&#x2F; so no confusion is caused</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">330</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">331</span></pre></td><td class="code"><pre><span class="line">    if(!$this-&gt;connected()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">332</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D; array(</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">333</span></pre></td><td class="code"><pre><span class="line">              &quot;error&quot; &#x3D;&gt; &quot;Called Data() without being connected&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">334</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">335</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">336</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">337</span></pre></td><td class="code"><pre><span class="line">    fputs($this-&gt;smtp_conn,&quot;DATA&quot; . $this-&gt;CRLF);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">338</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">339</span></pre></td><td class="code"><pre><span class="line">    $rply &#x3D; $this-&gt;get_lines();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">340</span></pre></td><td class="code"><pre><span class="line">    $code &#x3D; substr($rply,0,3);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">341</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">342</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;do_debug &gt;&#x3D; 2) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">343</span></pre></td><td class="code"><pre><span class="line">      echo &quot;SMTP -&gt; FROM SERVER:&quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">344</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">345</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">346</span></pre></td><td class="code"><pre><span class="line">    if($code !&#x3D; 354) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">347</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">348</span></pre></td><td class="code"><pre><span class="line">        array(&quot;error&quot; &#x3D;&gt; &quot;DATA command not accepted from server&quot;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">349</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_code&quot; &#x3D;&gt; $code,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">350</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_msg&quot; &#x3D;&gt; substr($rply,4));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">351</span></pre></td><td class="code"><pre><span class="line">      if($this-&gt;do_debug &gt;&#x3D; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">352</span></pre></td><td class="code"><pre><span class="line">        echo &quot;SMTP -&gt; ERROR: &quot; . $this-&gt;error[&quot;error&quot;] . &quot;: &quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">353</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">354</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">355</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">356</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">357</span></pre></td><td class="code"><pre><span class="line">    &#x2F;* the server is ready to accept data!</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">358</span></pre></td><td class="code"><pre><span class="line">     * according to rfc 821 we should not send more than 1000</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">359</span></pre></td><td class="code"><pre><span class="line">     * including the CRLF</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">360</span></pre></td><td class="code"><pre><span class="line">     * characters on a single line so we will break the data up</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">361</span></pre></td><td class="code"><pre><span class="line">     * into lines by \r and&#x2F;or \n then if needed we will break</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">362</span></pre></td><td class="code"><pre><span class="line">     * each of those into smaller lines to fit within the limit.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">363</span></pre></td><td class="code"><pre><span class="line">     * in addition we will be looking for lines that start with</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">364</span></pre></td><td class="code"><pre><span class="line">     * a period &#39;.&#39; and append and additional period &#39;.&#39; to that</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">365</span></pre></td><td class="code"><pre><span class="line">     * line. NOTE: this does not count towards limit.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">366</span></pre></td><td class="code"><pre><span class="line">     *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">367</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">368</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; normalize the line breaks so we know the explode works</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">369</span></pre></td><td class="code"><pre><span class="line">    $msg_data &#x3D; str_replace(&quot;\r\n&quot;,&quot;\n&quot;,$msg_data);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">370</span></pre></td><td class="code"><pre><span class="line">    $msg_data &#x3D; str_replace(&quot;\r&quot;,&quot;\n&quot;,$msg_data);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">371</span></pre></td><td class="code"><pre><span class="line">    $lines &#x3D; explode(&quot;\n&quot;,$msg_data);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">372</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">373</span></pre></td><td class="code"><pre><span class="line">    &#x2F;* we need to find a good way to determine is headers are</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">374</span></pre></td><td class="code"><pre><span class="line">     * in the msg_data or if it is a straight msg body</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">375</span></pre></td><td class="code"><pre><span class="line">     * currently I am assuming rfc 822 definitions of msg headers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">376</span></pre></td><td class="code"><pre><span class="line">     * and if the first field of the first line (&#39;:&#39; sperated)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">377</span></pre></td><td class="code"><pre><span class="line">     * does not contain a space then it _should_ be a header</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">378</span></pre></td><td class="code"><pre><span class="line">     * and we can process all lines before a blank &quot;&quot; line as</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">379</span></pre></td><td class="code"><pre><span class="line">     * headers.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">380</span></pre></td><td class="code"><pre><span class="line">     *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">381</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">382</span></pre></td><td class="code"><pre><span class="line">    $field &#x3D; substr($lines[0],0,strpos($lines[0],&quot;:&quot;));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">383</span></pre></td><td class="code"><pre><span class="line">    $in_headers &#x3D; false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">384</span></pre></td><td class="code"><pre><span class="line">    if(!empty($field) &amp;&amp; !strstr($field,&quot; &quot;)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">385</span></pre></td><td class="code"><pre><span class="line">      $in_headers &#x3D; true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">386</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">387</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">388</span></pre></td><td class="code"><pre><span class="line">    $max_line_length &#x3D; 998; &#x2F;&#x2F; used below; set here for ease in change</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">389</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">390</span></pre></td><td class="code"><pre><span class="line">    while(list(,$line) &#x3D; @each($lines)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">391</span></pre></td><td class="code"><pre><span class="line">      $lines_out &#x3D; null;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">392</span></pre></td><td class="code"><pre><span class="line">      if($line &#x3D;&#x3D; &quot;&quot; &amp;&amp; $in_headers) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">393</span></pre></td><td class="code"><pre><span class="line">        $in_headers &#x3D; false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">394</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">395</span></pre></td><td class="code"><pre><span class="line">      &#x2F;&#x2F; ok we need to break this line up into several smaller lines</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">396</span></pre></td><td class="code"><pre><span class="line">      while(strlen($line) &gt; $max_line_length) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">397</span></pre></td><td class="code"><pre><span class="line">        $pos &#x3D; strrpos(substr($line,0,$max_line_length),&quot; &quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">398</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">399</span></pre></td><td class="code"><pre><span class="line">        &#x2F;&#x2F; Patch to fix DOS attack</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">400</span></pre></td><td class="code"><pre><span class="line">        if(!$pos) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">401</span></pre></td><td class="code"><pre><span class="line">          $pos &#x3D; $max_line_length - 1;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">402</span></pre></td><td class="code"><pre><span class="line">          $lines_out[] &#x3D; substr($line,0,$pos);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">403</span></pre></td><td class="code"><pre><span class="line">          $line &#x3D; substr($line,$pos);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">404</span></pre></td><td class="code"><pre><span class="line">        &#125; else &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">405</span></pre></td><td class="code"><pre><span class="line">          $lines_out[] &#x3D; substr($line,0,$pos);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">406</span></pre></td><td class="code"><pre><span class="line">          $line &#x3D; substr($line,$pos + 1);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">407</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">408</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">409</span></pre></td><td class="code"><pre><span class="line">        &#x2F;* if processing headers add a LWSP-char to the front of new line</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">410</span></pre></td><td class="code"><pre><span class="line">         * rfc 822 on long msg headers</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">411</span></pre></td><td class="code"><pre><span class="line">         *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">412</span></pre></td><td class="code"><pre><span class="line">        if($in_headers) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">413</span></pre></td><td class="code"><pre><span class="line">          $line &#x3D; &quot;\t&quot; . $line;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">414</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">415</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">416</span></pre></td><td class="code"><pre><span class="line">      $lines_out[] &#x3D; $line;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">417</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">418</span></pre></td><td class="code"><pre><span class="line">      &#x2F;&#x2F; send the lines to the server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">419</span></pre></td><td class="code"><pre><span class="line">      while(list(,$line_out) &#x3D; @each($lines_out)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">420</span></pre></td><td class="code"><pre><span class="line">        if(strlen($line_out) &gt; 0)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">421</span></pre></td><td class="code"><pre><span class="line">        &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">422</span></pre></td><td class="code"><pre><span class="line">          if(substr($line_out, 0, 1) &#x3D;&#x3D; &quot;.&quot;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">423</span></pre></td><td class="code"><pre><span class="line">            $line_out &#x3D; &quot;.&quot; . $line_out;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">424</span></pre></td><td class="code"><pre><span class="line">          &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">425</span></pre></td><td class="code"><pre><span class="line">        &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">426</span></pre></td><td class="code"><pre><span class="line">        fputs($this-&gt;smtp_conn,$line_out . $this-&gt;CRLF);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">427</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">428</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">429</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">430</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; message data has been sent</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">431</span></pre></td><td class="code"><pre><span class="line">    fputs($this-&gt;smtp_conn, $this-&gt;CRLF . &quot;.&quot; . $this-&gt;CRLF);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">432</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">433</span></pre></td><td class="code"><pre><span class="line">    $rply &#x3D; $this-&gt;get_lines();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">434</span></pre></td><td class="code"><pre><span class="line">    $code &#x3D; substr($rply,0,3);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">435</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">436</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;do_debug &gt;&#x3D; 2) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">437</span></pre></td><td class="code"><pre><span class="line">      echo &quot;SMTP -&gt; FROM SERVER:&quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">438</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">439</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">440</span></pre></td><td class="code"><pre><span class="line">    if($code !&#x3D; 250) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">441</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">442</span></pre></td><td class="code"><pre><span class="line">        array(&quot;error&quot; &#x3D;&gt; &quot;DATA not accepted from server&quot;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">443</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_code&quot; &#x3D;&gt; $code,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">444</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_msg&quot; &#x3D;&gt; substr($rply,4));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">445</span></pre></td><td class="code"><pre><span class="line">      if($this-&gt;do_debug &gt;&#x3D; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">446</span></pre></td><td class="code"><pre><span class="line">        echo &quot;SMTP -&gt; ERROR: &quot; . $this-&gt;error[&quot;error&quot;] . &quot;: &quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">447</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">448</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">449</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">450</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">451</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">452</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">453</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">454</span></pre></td><td class="code"><pre><span class="line">   * Sends the HELO command to the smtp server.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">455</span></pre></td><td class="code"><pre><span class="line">   * This makes sure that we and the server are in</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">456</span></pre></td><td class="code"><pre><span class="line">   * the same known state.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">457</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">458</span></pre></td><td class="code"><pre><span class="line">   * Implements from rfc 821: HELO &lt;SP&gt; &lt;domain&gt; &lt;CRLF&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">459</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">460</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE SUCCESS: 250</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">461</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE ERROR  : 500, 501, 504, 421</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">462</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">463</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">464</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">465</span></pre></td><td class="code"><pre><span class="line">  public function Hello($host &#x3D; &#39;&#39;) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">466</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;error &#x3D; null; &#x2F;&#x2F; so no confusion is caused</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">467</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">468</span></pre></td><td class="code"><pre><span class="line">    if(!$this-&gt;connected()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">469</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D; array(</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">470</span></pre></td><td class="code"><pre><span class="line">            &quot;error&quot; &#x3D;&gt; &quot;Called Hello() without being connected&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">471</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">472</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">473</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">474</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; if hostname for HELO was not specified send default</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">475</span></pre></td><td class="code"><pre><span class="line">    if(empty($host)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">476</span></pre></td><td class="code"><pre><span class="line">      &#x2F;&#x2F; determine appropriate default to send to server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">477</span></pre></td><td class="code"><pre><span class="line">      $host &#x3D; &quot;localhost&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">478</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">479</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">480</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; Send extended hello first (RFC 2821)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">481</span></pre></td><td class="code"><pre><span class="line">    if(!$this-&gt;SendHello(&quot;EHLO&quot;, $host)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">482</span></pre></td><td class="code"><pre><span class="line">      if(!$this-&gt;SendHello(&quot;HELO&quot;, $host)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">483</span></pre></td><td class="code"><pre><span class="line">        return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">484</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">485</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">486</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">487</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">488</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">489</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">490</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">491</span></pre></td><td class="code"><pre><span class="line">   * Sends a HELO&#x2F;EHLO command.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">492</span></pre></td><td class="code"><pre><span class="line">   * @access private</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">493</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">494</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">495</span></pre></td><td class="code"><pre><span class="line">  private function SendHello($hello, $host) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">496</span></pre></td><td class="code"><pre><span class="line">    fputs($this-&gt;smtp_conn, $hello . &quot; &quot; . $host . $this-&gt;CRLF);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">497</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">498</span></pre></td><td class="code"><pre><span class="line">    $rply &#x3D; $this-&gt;get_lines();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">499</span></pre></td><td class="code"><pre><span class="line">    $code &#x3D; substr($rply,0,3);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">500</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">501</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;do_debug &gt;&#x3D; 2) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">502</span></pre></td><td class="code"><pre><span class="line">      echo &quot;SMTP -&gt; FROM SERVER: &quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">503</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">504</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">505</span></pre></td><td class="code"><pre><span class="line">    if($code !&#x3D; 250) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">506</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">507</span></pre></td><td class="code"><pre><span class="line">        array(&quot;error&quot; &#x3D;&gt; $hello . &quot; not accepted from server&quot;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">508</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_code&quot; &#x3D;&gt; $code,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">509</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_msg&quot; &#x3D;&gt; substr($rply,4));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">510</span></pre></td><td class="code"><pre><span class="line">      if($this-&gt;do_debug &gt;&#x3D; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">511</span></pre></td><td class="code"><pre><span class="line">        echo &quot;SMTP -&gt; ERROR: &quot; . $this-&gt;error[&quot;error&quot;] . &quot;: &quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">512</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">513</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">514</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">515</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">516</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;helo_rply &#x3D; $rply;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">517</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">518</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">519</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">520</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">521</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">522</span></pre></td><td class="code"><pre><span class="line">   * Starts a mail transaction from the email address specified in</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">523</span></pre></td><td class="code"><pre><span class="line">   * $from. Returns true if successful or false otherwise. If True</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">524</span></pre></td><td class="code"><pre><span class="line">   * the mail transaction is started and then one or more Recipient</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">525</span></pre></td><td class="code"><pre><span class="line">   * commands may be called followed by a Data command.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">526</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">527</span></pre></td><td class="code"><pre><span class="line">   * Implements rfc 821: MAIL &lt;SP&gt; FROM:&lt;reverse-path&gt; &lt;CRLF&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">528</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">529</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE SUCCESS: 250</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">530</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE SUCCESS: 552,451,452</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">531</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE SUCCESS: 500,501,421</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">532</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">533</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">534</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">535</span></pre></td><td class="code"><pre><span class="line">  public function Mail($from) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">536</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;error &#x3D; null; &#x2F;&#x2F; so no confusion is caused</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">537</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">538</span></pre></td><td class="code"><pre><span class="line">    if(!$this-&gt;connected()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">539</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D; array(</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">540</span></pre></td><td class="code"><pre><span class="line">              &quot;error&quot; &#x3D;&gt; &quot;Called Mail() without being connected&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">541</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">542</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">543</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">544</span></pre></td><td class="code"><pre><span class="line">    $useVerp &#x3D; ($this-&gt;do_verp ? &quot;XVERP&quot; : &quot;&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">545</span></pre></td><td class="code"><pre><span class="line">    fputs($this-&gt;smtp_conn,&quot;MAIL FROM:&lt;&quot; . $from . &quot;&gt;&quot; . $useVerp . $this-&gt;CRLF);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">546</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">547</span></pre></td><td class="code"><pre><span class="line">    $rply &#x3D; $this-&gt;get_lines();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">548</span></pre></td><td class="code"><pre><span class="line">    $code &#x3D; substr($rply,0,3);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">549</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">550</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;do_debug &gt;&#x3D; 2) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">551</span></pre></td><td class="code"><pre><span class="line">      echo &quot;SMTP -&gt; FROM SERVER:&quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">552</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">553</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">554</span></pre></td><td class="code"><pre><span class="line">    if($code !&#x3D; 250) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">555</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">556</span></pre></td><td class="code"><pre><span class="line">        array(&quot;error&quot; &#x3D;&gt; &quot;MAIL not accepted from server&quot;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">557</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_code&quot; &#x3D;&gt; $code,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">558</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_msg&quot; &#x3D;&gt; substr($rply,4));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">559</span></pre></td><td class="code"><pre><span class="line">      if($this-&gt;do_debug &gt;&#x3D; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">560</span></pre></td><td class="code"><pre><span class="line">        echo &quot;SMTP -&gt; ERROR: &quot; . $this-&gt;error[&quot;error&quot;] . &quot;: &quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">561</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">562</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">563</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">564</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">565</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">566</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">567</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">568</span></pre></td><td class="code"><pre><span class="line">   * Sends the quit command to the server and then closes the socket</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">569</span></pre></td><td class="code"><pre><span class="line">   * if there is no error or the $close_on_error argument is true.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">570</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">571</span></pre></td><td class="code"><pre><span class="line">   * Implements from rfc 821: QUIT &lt;CRLF&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">572</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">573</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE SUCCESS: 221</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">574</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE ERROR  : 500</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">575</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">576</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">577</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">578</span></pre></td><td class="code"><pre><span class="line">  public function Quit($close_on_error &#x3D; true) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">579</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;error &#x3D; null; &#x2F;&#x2F; so there is no confusion</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">580</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">581</span></pre></td><td class="code"><pre><span class="line">    if(!$this-&gt;connected()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">582</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D; array(</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">583</span></pre></td><td class="code"><pre><span class="line">              &quot;error&quot; &#x3D;&gt; &quot;Called Quit() without being connected&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">584</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">585</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">586</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">587</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; send the quit command to the server</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">588</span></pre></td><td class="code"><pre><span class="line">    fputs($this-&gt;smtp_conn,&quot;quit&quot; . $this-&gt;CRLF);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">589</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">590</span></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; get any good-bye messages</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">591</span></pre></td><td class="code"><pre><span class="line">    $byemsg &#x3D; $this-&gt;get_lines();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">592</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">593</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;do_debug &gt;&#x3D; 2) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">594</span></pre></td><td class="code"><pre><span class="line">      echo &quot;SMTP -&gt; FROM SERVER:&quot; . $byemsg . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">595</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">596</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">597</span></pre></td><td class="code"><pre><span class="line">    $rval &#x3D; true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">598</span></pre></td><td class="code"><pre><span class="line">    $e &#x3D; null;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">599</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">600</span></pre></td><td class="code"><pre><span class="line">    $code &#x3D; substr($byemsg,0,3);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">601</span></pre></td><td class="code"><pre><span class="line">    if($code !&#x3D; 221) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">602</span></pre></td><td class="code"><pre><span class="line">      &#x2F;&#x2F; use e as a tmp var cause Close will overwrite $this-&gt;error</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">603</span></pre></td><td class="code"><pre><span class="line">      $e &#x3D; array(&quot;error&quot; &#x3D;&gt; &quot;SMTP server rejected quit command&quot;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">604</span></pre></td><td class="code"><pre><span class="line">                 &quot;smtp_code&quot; &#x3D;&gt; $code,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">605</span></pre></td><td class="code"><pre><span class="line">                 &quot;smtp_rply&quot; &#x3D;&gt; substr($byemsg,4));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">606</span></pre></td><td class="code"><pre><span class="line">      $rval &#x3D; false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">607</span></pre></td><td class="code"><pre><span class="line">      if($this-&gt;do_debug &gt;&#x3D; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">608</span></pre></td><td class="code"><pre><span class="line">        echo &quot;SMTP -&gt; ERROR: &quot; . $e[&quot;error&quot;] . &quot;: &quot; . $byemsg . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">609</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">610</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">611</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">612</span></pre></td><td class="code"><pre><span class="line">    if(empty($e) || $close_on_error) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">613</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;Close();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">614</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">615</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">616</span></pre></td><td class="code"><pre><span class="line">    return $rval;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">617</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">618</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">619</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">620</span></pre></td><td class="code"><pre><span class="line">   * Sends the command RCPT to the SMTP server with the TO: argument of $to.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">621</span></pre></td><td class="code"><pre><span class="line">   * Returns true if the recipient was accepted false if it was rejected.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">622</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">623</span></pre></td><td class="code"><pre><span class="line">   * Implements from rfc 821: RCPT &lt;SP&gt; TO:&lt;forward-path&gt; &lt;CRLF&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">624</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">625</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE SUCCESS: 250,251</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">626</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE FAILURE: 550,551,552,553,450,451,452</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">627</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE ERROR  : 500,501,503,421</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">628</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">629</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">630</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">631</span></pre></td><td class="code"><pre><span class="line">  public function Recipient($to) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">632</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;error &#x3D; null; &#x2F;&#x2F; so no confusion is caused</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">633</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">634</span></pre></td><td class="code"><pre><span class="line">    if(!$this-&gt;connected()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">635</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D; array(</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">636</span></pre></td><td class="code"><pre><span class="line">              &quot;error&quot; &#x3D;&gt; &quot;Called Recipient() without being connected&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">637</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">638</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">639</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">640</span></pre></td><td class="code"><pre><span class="line">    fputs($this-&gt;smtp_conn,&quot;RCPT TO:&lt;&quot; . $to . &quot;&gt;&quot; . $this-&gt;CRLF);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">641</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">642</span></pre></td><td class="code"><pre><span class="line">    $rply &#x3D; $this-&gt;get_lines();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">643</span></pre></td><td class="code"><pre><span class="line">    $code &#x3D; substr($rply,0,3);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">644</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">645</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;do_debug &gt;&#x3D; 2) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">646</span></pre></td><td class="code"><pre><span class="line">      echo &quot;SMTP -&gt; FROM SERVER:&quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">647</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">648</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">649</span></pre></td><td class="code"><pre><span class="line">    if($code !&#x3D; 250 &amp;&amp; $code !&#x3D; 251) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">650</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">651</span></pre></td><td class="code"><pre><span class="line">        array(&quot;error&quot; &#x3D;&gt; &quot;RCPT not accepted from server&quot;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">652</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_code&quot; &#x3D;&gt; $code,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">653</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_msg&quot; &#x3D;&gt; substr($rply,4));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">654</span></pre></td><td class="code"><pre><span class="line">      if($this-&gt;do_debug &gt;&#x3D; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">655</span></pre></td><td class="code"><pre><span class="line">        echo &quot;SMTP -&gt; ERROR: &quot; . $this-&gt;error[&quot;error&quot;] . &quot;: &quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">656</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">657</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">658</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">659</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">660</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">661</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">662</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">663</span></pre></td><td class="code"><pre><span class="line">   * Sends the RSET command to abort and transaction that is</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">664</span></pre></td><td class="code"><pre><span class="line">   * currently in progress. Returns true if successful false</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">665</span></pre></td><td class="code"><pre><span class="line">   * otherwise.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">666</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">667</span></pre></td><td class="code"><pre><span class="line">   * Implements rfc 821: RSET &lt;CRLF&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">668</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">669</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE SUCCESS: 250</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">670</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE ERROR  : 500,501,504,421</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">671</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">672</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">673</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">674</span></pre></td><td class="code"><pre><span class="line">  public function Reset() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">675</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;error &#x3D; null; &#x2F;&#x2F; so no confusion is caused</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">676</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">677</span></pre></td><td class="code"><pre><span class="line">    if(!$this-&gt;connected()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">678</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D; array(</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">679</span></pre></td><td class="code"><pre><span class="line">              &quot;error&quot; &#x3D;&gt; &quot;Called Reset() without being connected&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">680</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">681</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">682</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">683</span></pre></td><td class="code"><pre><span class="line">    fputs($this-&gt;smtp_conn,&quot;RSET&quot; . $this-&gt;CRLF);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">684</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">685</span></pre></td><td class="code"><pre><span class="line">    $rply &#x3D; $this-&gt;get_lines();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">686</span></pre></td><td class="code"><pre><span class="line">    $code &#x3D; substr($rply,0,3);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">687</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">688</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;do_debug &gt;&#x3D; 2) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">689</span></pre></td><td class="code"><pre><span class="line">      echo &quot;SMTP -&gt; FROM SERVER:&quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">690</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">691</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">692</span></pre></td><td class="code"><pre><span class="line">    if($code !&#x3D; 250) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">693</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">694</span></pre></td><td class="code"><pre><span class="line">        array(&quot;error&quot; &#x3D;&gt; &quot;RSET failed&quot;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">695</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_code&quot; &#x3D;&gt; $code,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">696</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_msg&quot; &#x3D;&gt; substr($rply,4));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">697</span></pre></td><td class="code"><pre><span class="line">      if($this-&gt;do_debug &gt;&#x3D; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">698</span></pre></td><td class="code"><pre><span class="line">        echo &quot;SMTP -&gt; ERROR: &quot; . $this-&gt;error[&quot;error&quot;] . &quot;: &quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">699</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">700</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">701</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">702</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">703</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">704</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">705</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">706</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">707</span></pre></td><td class="code"><pre><span class="line">   * Starts a mail transaction from the email address specified in</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">708</span></pre></td><td class="code"><pre><span class="line">   * $from. Returns true if successful or false otherwise. If True</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">709</span></pre></td><td class="code"><pre><span class="line">   * the mail transaction is started and then one or more Recipient</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">710</span></pre></td><td class="code"><pre><span class="line">   * commands may be called followed by a Data command. This command</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">711</span></pre></td><td class="code"><pre><span class="line">   * will send the message to the users terminal if they are logged</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">712</span></pre></td><td class="code"><pre><span class="line">   * in and send them an email.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">713</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">714</span></pre></td><td class="code"><pre><span class="line">   * Implements rfc 821: SAML &lt;SP&gt; FROM:&lt;reverse-path&gt; &lt;CRLF&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">715</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">716</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE SUCCESS: 250</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">717</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE SUCCESS: 552,451,452</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">718</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE SUCCESS: 500,501,502,421</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">719</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">720</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">721</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">722</span></pre></td><td class="code"><pre><span class="line">  public function SendAndMail($from) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">723</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;error &#x3D; null; &#x2F;&#x2F; so no confusion is caused</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">724</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">725</span></pre></td><td class="code"><pre><span class="line">    if(!$this-&gt;connected()) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">726</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D; array(</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">727</span></pre></td><td class="code"><pre><span class="line">          &quot;error&quot; &#x3D;&gt; &quot;Called SendAndMail() without being connected&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">728</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">729</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">730</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">731</span></pre></td><td class="code"><pre><span class="line">    fputs($this-&gt;smtp_conn,&quot;SAML FROM:&quot; . $from . $this-&gt;CRLF);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">732</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">733</span></pre></td><td class="code"><pre><span class="line">    $rply &#x3D; $this-&gt;get_lines();</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">734</span></pre></td><td class="code"><pre><span class="line">    $code &#x3D; substr($rply,0,3);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">735</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">736</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;do_debug &gt;&#x3D; 2) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">737</span></pre></td><td class="code"><pre><span class="line">      echo &quot;SMTP -&gt; FROM SERVER:&quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">738</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">739</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">740</span></pre></td><td class="code"><pre><span class="line">    if($code !&#x3D; 250) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">741</span></pre></td><td class="code"><pre><span class="line">      $this-&gt;error &#x3D;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">742</span></pre></td><td class="code"><pre><span class="line">        array(&quot;error&quot; &#x3D;&gt; &quot;SAML not accepted from server&quot;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">743</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_code&quot; &#x3D;&gt; $code,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">744</span></pre></td><td class="code"><pre><span class="line">              &quot;smtp_msg&quot; &#x3D;&gt; substr($rply,4));</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">745</span></pre></td><td class="code"><pre><span class="line">      if($this-&gt;do_debug &gt;&#x3D; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">746</span></pre></td><td class="code"><pre><span class="line">        echo &quot;SMTP -&gt; ERROR: &quot; . $this-&gt;error[&quot;error&quot;] . &quot;: &quot; . $rply . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">747</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">748</span></pre></td><td class="code"><pre><span class="line">      return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">749</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">750</span></pre></td><td class="code"><pre><span class="line">    return true;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">751</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">752</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">753</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">754</span></pre></td><td class="code"><pre><span class="line">   * This is an optional command for SMTP that this class does not</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">755</span></pre></td><td class="code"><pre><span class="line">   * support. This method is here to make the RFC821 Definition</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">756</span></pre></td><td class="code"><pre><span class="line">   * complete for this class and __may__ be implimented in the future</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">757</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">758</span></pre></td><td class="code"><pre><span class="line">   * Implements from rfc 821: TURN &lt;CRLF&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">759</span></pre></td><td class="code"><pre><span class="line">   *</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">760</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE SUCCESS: 250</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">761</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE FAILURE: 502</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">762</span></pre></td><td class="code"><pre><span class="line">   * SMTP CODE ERROR  : 500, 503</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">763</span></pre></td><td class="code"><pre><span class="line">   * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">764</span></pre></td><td class="code"><pre><span class="line">   * @return bool</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">765</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">766</span></pre></td><td class="code"><pre><span class="line">  public function Turn() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">767</span></pre></td><td class="code"><pre><span class="line">    $this-&gt;error &#x3D; array(&quot;error&quot; &#x3D;&gt; &quot;This method, TURN, of the SMTP &quot;.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">768</span></pre></td><td class="code"><pre><span class="line">                                    &quot;is not implemented&quot;);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">769</span></pre></td><td class="code"><pre><span class="line">    if($this-&gt;do_debug &gt;&#x3D; 1) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">770</span></pre></td><td class="code"><pre><span class="line">      echo &quot;SMTP -&gt; NOTICE: &quot; . $this-&gt;error[&quot;error&quot;] . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">771</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">772</span></pre></td><td class="code"><pre><span class="line">    return false;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">773</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">774</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">775</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">776</span></pre></td><td class="code"><pre><span class="line">  * Get the current error</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">777</span></pre></td><td class="code"><pre><span class="line">  * @access public</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">778</span></pre></td><td class="code"><pre><span class="line">  * @return array</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">779</span></pre></td><td class="code"><pre><span class="line">  *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">780</span></pre></td><td class="code"><pre><span class="line">  public function getError() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">781</span></pre></td><td class="code"><pre><span class="line">    return $this-&gt;error;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">782</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">783</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">784</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">785</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F; INTERNAL FUNCTIONS</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">786</span></pre></td><td class="code"><pre><span class="line">  &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">787</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">788</span></pre></td><td class="code"><pre><span class="line">  &#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">789</span></pre></td><td class="code"><pre><span class="line">   * Read in as many lines as possible</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">790</span></pre></td><td class="code"><pre><span class="line">   * either before eof or socket timeout occurs on the operation.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">791</span></pre></td><td class="code"><pre><span class="line">   * With SMTP we can tell if we have more lines to read if the</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">792</span></pre></td><td class="code"><pre><span class="line">   * 4th character is &#39;-&#39; symbol. If it is a space then we don&#39;t</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">793</span></pre></td><td class="code"><pre><span class="line">   * need to read anything else.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">794</span></pre></td><td class="code"><pre><span class="line">   * @access private</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">795</span></pre></td><td class="code"><pre><span class="line">   * @return string</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">796</span></pre></td><td class="code"><pre><span class="line">   *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">797</span></pre></td><td class="code"><pre><span class="line">  private function get_lines() &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">798</span></pre></td><td class="code"><pre><span class="line">    $data &#x3D; &quot;&quot;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">799</span></pre></td><td class="code"><pre><span class="line">    while(!feof($this-&gt;smtp_conn)) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">800</span></pre></td><td class="code"><pre><span class="line">      $str &#x3D; @fgets($this-&gt;smtp_conn,515);</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">801</span></pre></td><td class="code"><pre><span class="line">      if($this-&gt;do_debug &gt;&#x3D; 4) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">802</span></pre></td><td class="code"><pre><span class="line">        echo &quot;SMTP -&gt; get_lines(): \$data was \&quot;$data\&quot;&quot; . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">803</span></pre></td><td class="code"><pre><span class="line">        echo &quot;SMTP -&gt; get_lines(): \$str is \&quot;$str\&quot;&quot; . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">804</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">805</span></pre></td><td class="code"><pre><span class="line">      $data .&#x3D; $str;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">806</span></pre></td><td class="code"><pre><span class="line">      if($this-&gt;do_debug &gt;&#x3D; 4) &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">807</span></pre></td><td class="code"><pre><span class="line">        echo &quot;SMTP -&gt; get_lines(): \$data is \&quot;$data\&quot;&quot; . $this-&gt;CRLF . &#39;&lt;br &#x2F;&gt;&#39;;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">808</span></pre></td><td class="code"><pre><span class="line">      &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">809</span></pre></td><td class="code"><pre><span class="line">      &#x2F;&#x2F; if 4th character is a space, we are done reading, break the loop</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">810</span></pre></td><td class="code"><pre><span class="line">      if(substr($str,3,1) &#x3D;&#x3D; &quot; &quot;) &#123; break; &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">811</span></pre></td><td class="code"><pre><span class="line">    &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">812</span></pre></td><td class="code"><pre><span class="line">    return $data;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">813</span></pre></td><td class="code"><pre><span class="line">  &#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">814</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">815</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<h1 id="异常类Exception-class-php"><a href="#异常类Exception-class-php" class="headerlink" title="异常类Exception.class.php"></a>异常类Exception.class.php</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; +----------------------------------------------------------------------</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; | ThinkPHP [ WE CAN DO IT JUST THINK IT ]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; +----------------------------------------------------------------------</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; | Copyright (c) 2006-2014 http:&#x2F;&#x2F;thinkphp.cn All rights reserved.</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; +----------------------------------------------------------------------</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; | Licensed ( http:&#x2F;&#x2F;www.apache.org&#x2F;licenses&#x2F;LICENSE-2.0 )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; +----------------------------------------------------------------------</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; | Author: liu21st &lt;liu21st@gmail.com&gt;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; +----------------------------------------------------------------------</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">namespace Think;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">&#x2F;**</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"> * ThinkPHP系统异常基类</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"> *&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">class Exception extends \Exception &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined" target="_blank" rel="noopener">pengweifu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="/https:/www.pengwf.com/2015/12/04/web/PHP-Send-Mail-With-PHPMailer/">https://www.pengwf.com/2015/12/04/web/PHP-Send-Mail-With-PHPMailer/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.pengwf.com">麦子的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/mail/">mail    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button"><i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/images/wechat.jpg"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/images/alipay.jpg"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2015/12/04/web/ASP-Send-Mail-With-Jmail/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/images/douban-loading.gif'"><div class="label">上一篇</div><div class="prev_info"><span>ASP使用Jmail组件发送邮件</span></div></a></div><div class="next-post pull_right"><a href="/2015/10/14/web/PHP-PHPUNIT-Demo/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/images/douban-loading.gif'"><div class="label">下一篇</div><div class="next_info"><span>Windows下PHPunit安装及入门演示</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2015/12/04/web/ASP-Send-Mail-With-Jmail/" title="ASP使用Jmail组件发送邮件"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">ASP使用Jmail组件发送邮件</div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = false == true ? true : false;
var verify = true == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'dUfXKFLNrQndfsSRfCN5n7dd-MdYXbMMI',
  appKey:'oD9huTxD7TPc21j7ywOwGBi6',
  placeholder:'Please leave your footprints',
  avatar:'monsterid',
  guest_info:guest_info,
  pageSize:'10',
  lang:'en',
  recordIP: true
});</script></div></div></div><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2011 - 2019 By pengweifu</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.15/dist/snackbar.min.js"></script><script id="ribbon_piao" mobile="false" src="/js/third-party/piao.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="/js/third-party/canvas-nest.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true; // make power mode colorful
POWERMODE.shake = true; // turn off shake
document.body.addEventListener('input', POWERMODE);
</script><script src="/js/tw_cn.js"></script><script>translateInitilization()
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="/js/third-party/click_heart.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":1},"log":false});</script></body></html>